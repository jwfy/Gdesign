[E 150414 10:07:27 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 32, in category
        res = movie_ctrl.list(page_num=page_num, page_size=page_size)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 52, in list
        .skip((page_num-1)*page_size).sort([("id", DESCENDING)])
    NameError: global name 'pymongo' is not defined
[E 150414 10:07:27 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1) 76556.17ms
[E 150414 12:55:33 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0', 'If-None-Match': '"da39a3ee5e6b4b0d3255bfef95601890afd80709"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 35, in category
        for r in res:
    TypeError: 'NoneType' object is not iterable
[E 150414 12:55:33 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1) 46378.88ms
[E 150414 12:56:35 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 35, in category
        for r in res:
    TypeError: 'NoneType' object is not iterable
[E 150414 12:56:35 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1) 58573.68ms
[E 150414 12:56:46 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 35, in category
        for r in res:
    TypeError: 'NoneType' object is not iterable
[E 150414 12:56:46 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1) 2950.87ms
[E 150414 17:25:14 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0', 'If-None-Match': '"da39a3ee5e6b4b0d3255bfef95601890afd80709"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 32, in category
        res = movie_ctrl.list(page_num=page_num, page_size=page_size, category=name)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 59, in list
        r["comment_num"] = comment_ctrl.get(_id=id, get_num=True)
      File "/home/jwfy/syb/github/Gdesign/module/comment_ctrl.py", line 43, in get
        comment_t = Comment.table()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuDBObject.py", line 986, in table
        return cls.scheme(table_as=table_as, nocache=nocache)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuDBObject.py", line 975, in scheme
        scheme = SpuTableScheme(cls, table_as)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuDBObject.py", line 890, in __init__
        obj = db_cls(None, None, False)
      File "/home/jwfy/syb/github/Gdesign/model/comment_model.py", line 20, in __init__
        SpuDBObject.__inti__(self, User._table_, spudb, spucache, debug=debug)
    AttributeError: type object 'SpuDBObject' has no attribute '__inti__'
[E 150414 17:25:14 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1) 12.92ms
[E 150414 17:25:59 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 32, in category
        res = movie_ctrl.list(page_num=page_num, page_size=page_size, category=name)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 59, in list
        r["comment_num"] = comment_ctrl.get(_id=id, get_num=True)
      File "/home/jwfy/syb/github/Gdesign/module/comment_ctrl.py", line 43, in get
        comment_t = Comment.table()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuDBObject.py", line 986, in table
        return cls.scheme(table_as=table_as, nocache=nocache)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuDBObject.py", line 975, in scheme
        scheme = SpuTableScheme(cls, table_as)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuDBObject.py", line 890, in __init__
        obj = db_cls(None, None, False)
      File "/home/jwfy/syb/github/Gdesign/model/comment_model.py", line 20, in __init__
        SpuDBObject.__init__(self, User._table_, spudb, spucache, debug=debug)
    NameError: global name 'User' is not defined
[E 150414 17:25:59 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1) 13.55ms
[E 150414 17:26:46 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:26:46 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:26:46 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:26:46 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:26:46 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:26:46 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:26:46 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:26:46 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:26:46 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:26:46 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:30:11 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:30:11 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:35:47 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:35:47 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:35:47 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:35:47 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:35:47 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:35:47 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:35:47 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:35:47 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:35:47 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:35:47 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:37:23 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:37:33 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:37:56 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:38:54 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:38:55 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:38:56 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:38:56 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:38:56 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:38:57 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:38:57 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:39:13 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:39:13 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0', 'If-None-Match': '"169b7da61fadc026c097355058fea0e6cb5e4e8d"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 32, in category
        res = movie_ctrl.list(page_num=page_num, page_size=page_size, category=name)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 61, in list
        down_num = len(r.get("donw_link"))
    TypeError: object of type 'NoneType' has no len()
[E 150414 17:39:13 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1) 10.50ms
[E 150414 17:40:02 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:40:02 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 32, in category
        res = movie_ctrl.list(page_num=page_num, page_size=page_size, category=name)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 63, in list
        t = r.get("down_link")
    TypeError: object of type 'NoneType' has no len()
[E 150414 17:40:02 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1) 656.32ms
[E 150414 17:40:20 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:41:41 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 32, in category
        res = movie_ctrl.list(page_num=page_num, page_size=page_size, category=name)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 64, in list
        down_num = len(r.get("donw_link"))
    TypeError: object of type 'NoneType' has no len()
[E 150414 17:41:41 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1) 81459.49ms
[E 150414 17:42:10 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:43:18 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 32, in category
        res = movie_ctrl.list(page_num=page_num, page_size=page_size, category=name)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 64, in list
        down_num = len(r.get("donw_link","[]"))
    TypeError: object of type 'NoneType' has no len()
[E 150414 17:43:18 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7 (127.0.0.1) 68300.84ms
[E 150414 17:43:20 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:44:13 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:44:20 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:44:58 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:45:08 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 17:45:08 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:06:48 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:06:48 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:07:09 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:07:09 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:07:27 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:07:27 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:10:57 dm.py:start:60] Uncaught exception GET /movie/movie/search?q=1234 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/search?q=1234', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 57, in search
        res = movie_ctrl.list(page_num=page_num, page_size=pahe_size,
    NameError: global name 'pahe_size' is not defined
[E 150414 18:10:57 dm.py:start:60] 500 GET /movie/movie/search?q=1234 (127.0.0.1) 4.57ms
[E 150414 18:11:27 movie.py:search:53] 非法查询操作
[E 150414 18:11:52 movie.py:search:53] 非法查询操作
[E 150414 18:12:00 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:12:00 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:12:00 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:12:00 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:12:00 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:12:00 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:12:00 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:12:00 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:12:00 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:12:00 comment_ctrl.py:get:50] 未找到对应评论
[E 150414 18:13:53 movie.py:search:53] 非法查询操作
[E 150414 18:43:26 movie.py:search:53] 非法查询操作
[E 150414 19:08:03 dm.py:start:60] Uncaught exception GET /movie/movie/search?token=1234 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/search?token=1234', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'If-None-Match': '"19fb6198029b3cc8c9e7c8a14ae7311a3c8cac0d"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 59, in search
        if not q:
      File "api/movie.py", line 59, in search
        if not q:
      File "/usr/lib/python2.7/bdb.py", line 49, in trace_dispatch
        return self.dispatch_line(frame)
      File "/usr/lib/python2.7/bdb.py", line 68, in dispatch_line
        if self.quitting: raise BdbQuit
    BdbQuit
[E 150414 19:08:03 dm.py:start:60] 500 GET /movie/movie/search?token=1234 (127.0.0.1) 8280.38ms
[E 150414 19:11:36 movie.py:search:52] 非法查询操作
[E 150414 19:13:18 dm.py:start:60] Uncaught exception GET /movie/movie/category?name=%E5%96%9C%E5%89%A7&page_num=3 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/category?name=%E5%96%9C%E5%89%A7&page_num=3', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 32, in category
        res = movie_ctrl.list(page_num=page_num, page_size=page_size, category=name)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 53, in list
        .skip((page_num-1)*page_size).sort([("id", DESCENDING)])
    TypeError: unsupported operand type(s) for -: 'unicode' and 'int'
[E 150414 19:13:18 dm.py:start:60] 500 GET /movie/movie/category?name=%E5%96%9C%E5%89%A7&page_num=3 (127.0.0.1) 4.22ms
[E 150414 20:04:17 dm.py:start:60] Uncaught exception GET /movie/movie/subject?id=1292052 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/subject?id=1292052', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 135, in subject
        movie =  movie_ctrl.get(id)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 76, in get
        if not res.count():
    AttributeError: 'NoneType' object has no attribute 'count'
[E 150414 20:04:17 dm.py:start:60] 500 GET /movie/movie/subject?id=1292052 (127.0.0.1) 7.50ms
[E 150414 20:06:42 dm.py:start:60] Uncaught exception GET /movie/movie/subject?id=1292052 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/subject?id=1292052', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 135, in subject
        movie =  movie_ctrl.get(id)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 76, in get
        if not res.count():
    AttributeError: 'NoneType' object has no attribute 'count'
[E 150414 20:06:42 dm.py:start:60] 500 GET /movie/movie/subject?id=1292052 (127.0.0.1) 4.48ms
[E 150414 20:06:44 dm.py:start:60] Uncaught exception GET /movie/movie/subject?id=1292052 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/subject?id=1292052', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 135, in subject
        movie =  movie_ctrl.get(id)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 76, in get
        if not res.count():
    AttributeError: 'NoneType' object has no attribute 'count'
[E 150414 20:06:44 dm.py:start:60] 500 GET /movie/movie/subject?id=1292052 (127.0.0.1) 3.94ms
[E 150414 20:07:21 dm.py:start:60] Uncaught exception GET /movie/movie/subject?id=1292052 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/subject?id=1292052', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 135, in subject
        movie =  movie_ctrl.get(id)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 76, in get
        if not res.count():
    AttributeError: 'NoneType' object has no attribute 'count'
[E 150414 20:07:21 dm.py:start:60] 500 GET /movie/movie/subject?id=1292052 (127.0.0.1) 6.03ms
[E 150414 20:08:48 dm.py:start:60] Uncaught exception GET /movie/movie/subject?id=1292052 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/subject?id=1292052', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 135, in subject
        movie =  movie_ctrl.get(id)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 78, in get
        if not res.count():
    AttributeError: 'NoneType' object has no attribute 'count'
[E 150414 20:08:48 dm.py:start:60] 500 GET /movie/movie/subject?id=1292052 (127.0.0.1) 58164.85ms
[E 150414 20:09:53 dm.py:start:60] Uncaught exception GET /movie/movie/subject?id=1292052 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/subject?id=1292052', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 135, in subject
        movie =  movie_ctrl.get(id)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 78, in get
        if not res:
    AttributeError: 'dict' object has no attribute 'count'
[E 150414 20:09:53 dm.py:start:60] 500 GET /movie/movie/subject?id=1292052 (127.0.0.1) 63242.24ms
[E 150414 20:09:59 dm.py:start:60] Uncaught exception GET /movie/movie/subject?id=1292052 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/subject?id=1292052', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 147, in subject
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: ObjectId('552754f1e206a514e2257a2e') is not JSON serializable
[E 150414 20:09:59 dm.py:start:60] 500 GET /movie/movie/subject?id=1292052 (127.0.0.1) 4061.45ms
[E 150414 20:12:26 dm.py:start:60] Uncaught exception GET /movie/movie/subject?id=1292052 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/subject?id=1292052', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 145, in subject
        if api_type == "json" and token == API_TOKEN:
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: ObjectId('552754f1e206a514e2257a2e') is not JSON serializable
[E 150414 20:12:26 dm.py:start:60] 500 GET /movie/movie/subject?id=1292052 (127.0.0.1) 134673.47ms
[E 150414 20:22:37 movie.py:subject:142] 没有电影信息1292052
[E 150414 20:23:17 movie.py:subject:142] 没有电影信息1292052
[E 150414 20:23:23 movie.py:subject:142] 没有电影信息1292052
[E 150414 20:25:08 movie.py:subject:142] 没有电影信息1292053
[E 150414 20:36:18 dm.py:start:60] Uncaught exception GET /movie/movie/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041883628c1a6547eabd0b4fb0bd9110f68; jwfy_dm_website_session=19732a3b3d6056c49988e5247439670a', 'If-None-Match': '"b5a623f2c5c5d8706efa4ff97d76e792cfed74c4"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 49, in list
        length=len(res), movie=res)
      File "api/base.py", line 44, in _return_ans
        ans["status"] = status
    TypeError: list indices must be integers, not str
[E 150414 20:36:18 dm.py:start:60] 500 GET /movie/movie/list (127.0.0.1) 22.81ms
[E 150415 09:26:36 dm.py:start:60] Uncaught exception GET /movie/movie/list?page_num=2&api_type=json&token=dm_movie (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/list?page_num=2&api_type=json&token=dm_movie', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=555959f95dd66f9654d9d1cef7e525a4', 'If-None-Match': '"3dd76917e8565dee458f0437b78d868278326e84"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 44, in list
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: ObjectId('552758bce206a514e2257ac9') is not JSON serializable
[E 150415 09:26:36 dm.py:start:60] 500 GET /movie/movie/list?page_num=2&api_type=json&token=dm_movie (127.0.0.1) 65.37ms
[E 150415 09:30:51 movie.py:subject:144] 没有电影信息5527568fe206a514e2257a80
[E 150415 09:33:06 movie.py:subject:144] 没有电影信息5527568fe206a514e2257a80
[E 150415 09:36:31 movie.py:subject:147] 没有电影信息5527568fe206a514e2257a80
[E 150415 09:37:14 dm.py:start:60] Uncaught exception GET /movie/movie/subject?id=5527568fe206a514e2257a80 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/subject?id=5527568fe206a514e2257a80', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=555959f95dd66f9654d9d1cef7e525a4', 'If-None-Match': '"47bdc17c05c620cc25e2e835e2ebde2fd5469c0c"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 153, in subject
        length=1, contains=res)
    NameError: global name 'res' is not defined
[E 150415 09:37:14 dm.py:start:60] 500 GET /movie/movie/subject?id=5527568fe206a514e2257a80 (127.0.0.1) 38678.38ms
[E 150415 19:21:50 dm.py:start:60] Uncaught exception POST /movie/movie/update_status (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/movie/movie/update_status', version='HTTP/1.1', remote_ip='127.0.0.1', body='_ids=552759c6e206a514e2257afe&_ids=55275549e206a514e2257a3b&status=offline', headers={'Origin': 'chrome-extension://fhbjgbiflinjbdggehcddcbncdddomop', 'Content-Length': '74', 'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': '*/*', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'jwfy_dm_website_session=27082a1ebf09c8ef17226d865e3e6bc5', 'Cache-Control': 'no-cache', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7', 'Content-Type': 'application/x-www-form-urlencoded', 'Postman-Token': 'b716991f-d0cb-949c-cd53-fae2f6e13834'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 166, in update_status
        ans = {}
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 96, in update_status
        _id = ObjectId(_id)
      File "build/bdist.linux-x86_64/egg/bson/objectid.py", line 90, in __init__
        self.__validate(oid)
      File "build/bdist.linux-x86_64/egg/bson/objectid.py", line 194, in __validate
        raise InvalidId("%s is not a valid ObjectId" % oid)
    InvalidId: [ is not a valid ObjectId
[E 150415 19:21:50 dm.py:start:60] 500 POST /movie/movie/update_status (127.0.0.1) 19154.29ms
[E 150415 19:22:10 dm.py:start:60] Uncaught exception POST /movie/movie/update_status (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/movie/movie/update_status', version='HTTP/1.1', remote_ip='127.0.0.1', body='_ids=552759c6e206a514e2257afe&_ids=55275549e206a514e2257a3b&status=offline', headers={'Origin': 'chrome-extension://fhbjgbiflinjbdggehcddcbncdddomop', 'Content-Length': '74', 'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': '*/*', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'jwfy_dm_website_session=27082a1ebf09c8ef17226d865e3e6bc5', 'Cache-Control': 'no-cache', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7', 'Content-Type': 'application/x-www-form-urlencoded', 'Postman-Token': '21c86c14-88ff-bfc1-5553-8eea247423cd'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 166, in update_status
        ans = {}
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 96, in update_status
        _id = ObjectId(_id)
      File "build/bdist.linux-x86_64/egg/bson/objectid.py", line 90, in __init__
        self.__validate(oid)
      File "build/bdist.linux-x86_64/egg/bson/objectid.py", line 194, in __validate
        raise InvalidId("%s is not a valid ObjectId" % oid)
    InvalidId: [ is not a valid ObjectId
[E 150415 19:22:10 dm.py:start:60] 500 POST /movie/movie/update_status (127.0.0.1) 9709.93ms
[E 150415 19:23:00 dm.py:start:60] Uncaught exception POST /movie/movie/update_status (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/movie/movie/update_status', version='HTTP/1.1', remote_ip='127.0.0.1', body='_ids=552759c6e206a514e2257afe&_ids=55275549e206a514e2257a3b&status=offline', headers={'Origin': 'chrome-extension://fhbjgbiflinjbdggehcddcbncdddomop', 'Content-Length': '74', 'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': '*/*', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'jwfy_dm_website_session=27082a1ebf09c8ef17226d865e3e6bc5', 'Cache-Control': 'no-cache', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7', 'Content-Type': 'application/x-www-form-urlencoded', 'Postman-Token': '55fb6d9e-72d7-4307-76ac-bddc1572f322'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 166, in update_status
        r,desc = movie_ctrl.update_status(_ids=eval(_ids), status=status)
      File "/home/jwfy/syb/github/Gdesign/module/movie_ctrl.py", line 96, in update_status
        _id = ObjectId(_id)
      File "build/bdist.linux-x86_64/egg/bson/objectid.py", line 90, in __init__
        self.__validate(oid)
      File "build/bdist.linux-x86_64/egg/bson/objectid.py", line 194, in __validate
        raise InvalidId("%s is not a valid ObjectId" % oid)
    InvalidId: [ is not a valid ObjectId
[E 150415 19:23:00 dm.py:start:60] 500 POST /movie/movie/update_status (127.0.0.1) 39605.25ms
[E 150415 19:27:19 movie.py:subject:145] 没有电影信息55275549e206a514e2257a3b
[E 150415 19:27:21 movie.py:subject:145] 没有电影信息55275549e206a514e2257a3b
[E 150416 12:44:26 dm.py:start:61] Uncaught exception GET /user/user/login (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/user/user/login', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=a26c5580180d42b9992daaa5c319fc7a', 'If-None-Match': '"bceb1e602106a5175980625d04faacbfc755bb21"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/user.py", line 24, in login
        self._set_user_name("jwfy")
    AttributeError: user instance has no attribute '_set_user_name'
[E 150416 12:44:26 dm.py:start:61] 500 GET /user/user/login (127.0.0.1) 3.87ms
[E 150420 18:37:07 dm.py:start:61] Uncaught exception GET /user/user/login (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/user/user/login', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/user.py", line 25, in login
        return self._html_render('base.html')
    TypeError: _html_render() takes at least 3 arguments (2 given)
[E 150420 18:37:07 dm.py:start:61] 500 GET /user/user/login (127.0.0.1) 4.74ms
[E 150420 18:37:32 dm.py:start:61] Uncaught exception GET /user/user/login (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/user/user/login', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 46, in request_process
        self._save_session()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 459, in _save_session
        self.session.save()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 380, in save
        self._redis.set(self.session_key, self._get_session(no_load=must_create))
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 189, in _get_session_key
        self._session_key = self._get_new_session_key()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 181, in _get_new_session_key
        if not self.exists(session_key):
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 385, in exists
        return self._redis.exists(session_key)
      File "build/bdist.linux-x86_64/egg/redis/client.py", line 561, in exists
        return self.execute_command('EXISTS', name)
      File "build/bdist.linux-x86_64/egg/redis/client.py", line 375, in execute_command
        connection.send_command(*args)
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 302, in send_command
        self.send_packed_command(self.pack_command(*args))
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 284, in send_packed_command
        self.connect()
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 235, in connect
        self.on_connect()
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 267, in on_connect
        if nativestr(self.read_response()) != 'OK':
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 312, in read_response
        raise response
    ResponseError: invalid DB index
[E 150420 18:37:32 dm.py:start:61] 500 GET /user/user/login (127.0.0.1) 18.10ms
[E 150420 18:37:54 dm.py:start:61] Uncaught exception GET /user/user/login (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/user/user/login', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 46, in request_process
        self._save_session()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 459, in _save_session
        self.session.save()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 380, in save
        self._redis.set(self.session_key, self._get_session(no_load=must_create))
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 189, in _get_session_key
        self._session_key = self._get_new_session_key()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 181, in _get_new_session_key
        if not self.exists(session_key):
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 385, in exists
        return self._redis.exists(session_key)
      File "build/bdist.linux-x86_64/egg/redis/client.py", line 561, in exists
        return self.execute_command('EXISTS', name)
      File "build/bdist.linux-x86_64/egg/redis/client.py", line 375, in execute_command
        connection.send_command(*args)
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 302, in send_command
        self.send_packed_command(self.pack_command(*args))
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 284, in send_packed_command
        self.connect()
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 235, in connect
        self.on_connect()
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 267, in on_connect
        if nativestr(self.read_response()) != 'OK':
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 312, in read_response
        raise response
    ResponseError: invalid DB index
[E 150420 18:37:54 dm.py:start:61] 500 GET /user/user/login (127.0.0.1) 10.49ms
[E 150420 18:39:21 dm.py:start:61] Uncaught exception GET /user/user/login (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/user/user/login', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 46, in request_process
        self._save_session()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 459, in _save_session
        self.session.save()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 380, in save
        self._redis.set(self.session_key, self._get_session(no_load=must_create))
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 189, in _get_session_key
        self._session_key = self._get_new_session_key()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 181, in _get_new_session_key
        if not self.exists(session_key):
      File "build/bdist.linux-x86_64/egg/sputnik/SpuSession.py", line 385, in exists
        return self._redis.exists(session_key)
      File "build/bdist.linux-x86_64/egg/redis/client.py", line 561, in exists
        return self.execute_command('EXISTS', name)
      File "build/bdist.linux-x86_64/egg/redis/client.py", line 375, in execute_command
        connection.send_command(*args)
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 302, in send_command
        self.send_packed_command(self.pack_command(*args))
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 284, in send_packed_command
        self.connect()
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 235, in connect
        self.on_connect()
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 267, in on_connect
        if nativestr(self.read_response()) != 'OK':
      File "build/bdist.linux-x86_64/egg/redis/connection.py", line 312, in read_response
        raise response
    ResponseError: invalid DB index
[E 150420 18:39:21 dm.py:start:61] 500 GET /user/user/login (127.0.0.1) 8303.81ms
[E 150420 18:40:54 dm.py:start:61] Uncaught exception GET /user/user/login (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/user/user/login', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 545, in render_string
        t = RequestHandler._templates[template_path].load(template_name)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 298, in load
        self.templates[name] = self._create_template(name)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 328, in _create_template
        f = open(path, "r")
    IOError: [Errno 2] No such file or directory: '/home/jwfy/syb/github/Gdesign/templates/base.html'
[E 150420 18:40:54 dm.py:start:61] 500 GET /user/user/login (127.0.0.1) 5751.31ms
[E 150421 09:12:08 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 56, in f
        user_name = self._get_user_name()
    AttributeError: comment instance has no attribute '_get_user_name'
[E 150421 09:12:08 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 28.08ms
[E 150421 09:13:12 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 545, in render_string
        t = RequestHandler._templates[template_path].load(template_name)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 298, in load
        self.templates[name] = self._create_template(name)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 329, in _create_template
        template = Template(f.read(), name=name, loader=self)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 207, in __init__
        self.file = _File(_parse(reader, self))
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 752, in _parse
        block_body = _parse(reader, template, operator)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 752, in _parse
        block_body = _parse(reader, template, operator)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 635, in _parse
        in_block)
    ParseError: Missing {% end %} block for block
[E 150421 09:13:12 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 24.48ms
[E 150421 16:48:35 <stdin>:<module>:1] [SqlGenError]Node Stack Len: 0 Stack: []
[E 150421 16:50:03 comment_ctrl.py:list:83] [SqlGenError]Node Stack Len: 0 Stack: []
[E 150421 16:50:03 comment.py:list:77] 
[E 150421 16:50:41 comment_ctrl.py:list:83] [SqlGenError]Node Stack Len: 0 Stack: []
[E 150421 16:50:49 comment.py:list:69] 
[E 150421 17:37:28 comment.py:list:85] global name 'v' is not defined
[E 150421 17:37:28 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0', 'If-None-Match': '"832dc04c472d2b4f7e8faed3eb5a6c4861587129"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 86, in list
        ans = self._return_ans("error", e, "comment_list")
      File "api/base.py", line 47, in _return_ans
        ans["message"] = message[1]
    IndexError: tuple index out of range
[E 150421 17:37:28 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 12.77ms
[E 150421 17:44:56 comment.py:list:90] global name 'v' is not defined
[E 150421 17:44:56 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 91, in list
        ans = self._return_ans("error", e, "comment_list")
      File "api/base.py", line 46, in _return_ans
        ans["message"] = message[1]
    IndexError: tuple index out of range
[E 150421 17:44:56 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 12.07ms
[E 150421 17:45:15 comment.py:list:90] global name 'v' is not defined
[E 150421 17:46:43 comment.py:list:90] global name 'k' is not defined
[E 150421 17:46:59 comment.py:list:90] global name 'desc_list' is not defined
[E 150421 17:48:21 comment.py:list:91] global name 'query_list' is not defined
[E 150421 17:57:23 comment.py:list:92] _return_ans() takes exactly 4 arguments (5 given)
[E 150421 18:19:43 dm.py:start:61] comment.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe8\xaf\x84\xe8\xae\xba')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<!-- sidebar: style can be found in sidebar.less -->\n<section class="sidebar">\n<!-- /.search form -->\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li>\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n<!-- /.sidebar -->\n</aside>')
     11      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     12      _append('\xe8\xaf\x84\xe8\xae\xba')
     13      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     14      _append('\n')
     15      ans = pyobject.get('result')
     16      _append('\n')
     17      query = ans.get('query')
     18      _append('\n')
     19      _tmp = ans
     20      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     21      else: _tmp = _utf8(str(_tmp))
     22      _tmp = _utf8(xhtml_escape(_tmp))
     23      _append(_tmp)
     24      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe8\xaf\x84\xe8\xae\xba-')
     25      _tmp = ans.get('category','')
     26      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     27      else: _tmp = _utf8(str(_tmp))
     28      _tmp = _utf8(xhtml_escape(_tmp))
     29      _append(_tmp)
     30      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-trash-o"></i></button>\n<button class="btn btn-default btn-sm" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-reply"></i></button>\n<button class="btn btn-default btn-sm" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-share"></i></button>\n</div>\n</div>\n<div class="col-xs-4" style="float: right">\n<div class="has-feedback">\n<input type="text" class="form-control input-sm" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</div>\n</div>\n<table class="table table-hover">\n<thead>\n')
     31      _append('<tr>\n<th></th>\n<th class="nickname">\xe6\x98\xb5\xe7\xa7\xb0</th>\n<th class="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</th>\n<th class="content">\xe5\x86\x85\xe5\xae\xb9</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     32      _append('\n</thead>\n<tbody>\n')
     33      for q in query:
     34          _append('\n')
     35          _append('<tr>\n<td><input type="checkbox" /></td>\n<td class="nickname">')
     36          _tmp = q.get('name', '')
     37          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     38          else: _tmp = _utf8(str(_tmp))
     39          _tmp = _utf8(xhtml_escape(_tmp))
     40          _append(_tmp)
     41          _append('</td>\n<td class="email">')
     42          _tmp = q.get('email', '')
     43          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     44          else: _tmp = _utf8(str(_tmp))
     45          _tmp = _utf8(xhtml_escape(_tmp))
     46          _append(_tmp)
     47          _append('</td>\n<td class="content">')
     48          _tmp = q.get('contain', '')
     49          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     50          else: _tmp = _utf8(str(_tmp))
     51          _tmp = _utf8(xhtml_escape(_tmp))
     52          _append(_tmp)
     53          _append('</td>\n<td class="status">\xe5\x88\xa0\xe9\x99\xa4</td>\n<td class="time">')
     54          _tmp = q.get('time', '')
     55          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     56          else: _tmp = _utf8(str(_tmp))
     57          _tmp = _utf8(xhtml_escape(_tmp))
     58          _append(_tmp)
     59          _append('</td>\n</tr>')
     60          _append('\n')
     61      _append('\n</tbody>\n</table>\n')
     62      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe6\x80\xbb\xe5\x85\xb1')
     63      _tmp = ans.get('total_num', 0)
     64      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     65      else: _tmp = _utf8(str(_tmp))
     66      _tmp = _utf8(xhtml_escape(_tmp))
     67      _append(_tmp)
     68      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
     69      current = ans.get('page_num', 1)
     70      _append('\n')
     71      total = ans.get('page_total', 1)
     72      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n<li class="prev disabled">\n<a href="javascript:;">\xe9\xa6\x96\xe9\xa1\xb5</a>\n</li>\n<li class="active">\n<a href="javascript:;">1</a>\n</li>\n<li>\n<a href="javascript:;">2</a>\n</li>\n<li>\n<a href="javascript:;">3</a>\n</li>\n<li>\n<a href="javascript:;">4</a>\n</li>\n<li>\n<a href="javascript:;">5</a>\n</li>\n<li class="next">\n<a hre="javascript:;">\xe5\xb0\xbe\xe9\xa1\xb5</a>\n</li>\n</ul>\n<ul class="pagination">\n')
     73      if current != 1:
     74          _append('<li><a href="')
     75          _tmp = url%(current-1)
     76          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     77          else: _tmp = _utf8(str(_tmp))
     78          _tmp = _utf8(xhtml_escape(_tmp))
     79          _append(_tmp)
     80          _append('"><span aria-hidden="true">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</span><span class="sr-only">Previous</span></a></li>')
     81      _append('\n')
     82      if current-3 > 1:
     83          _append('<li><a href="')
     84          _tmp = url%(1)
     85          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     86          else: _tmp = _utf8(str(_tmp))
     87          _tmp = _utf8(xhtml_escape(_tmp))
     88          _append(_tmp)
     89          _append('">1</a></li>')
     90      _append('\n')
     91      if current-3 > 2:
     92          _append('<li><span>...</span></li>')
     93      _append('\n')
     94      for i in [i for i in range(current-3,current) if i > 0]:
     95          _append('\n<li><a href="')
     96          _tmp = url%(i)
     97          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     98          else: _tmp = _utf8(str(_tmp))
     99          _tmp = _utf8(xhtml_escape(_tmp))
    100          _append(_tmp)
    101          _append('">')
    102          _tmp = i
    103          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    104          else: _tmp = _utf8(str(_tmp))
    105          _tmp = _utf8(xhtml_escape(_tmp))
    106          _append(_tmp)
    107          _append('</a></li>\n')
    108      _append('\n<li class="active"><span>')
    109      _tmp = current
    110      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    111      else: _tmp = _utf8(str(_tmp))
    112      _tmp = _utf8(xhtml_escape(_tmp))
    113      _append(_tmp)
    114      _append('</span></li>\n')
    115      for i in [i for i in range(current+1,current+4) if i <= total ]:
    116          _append('\n<li><a href="')
    117          _tmp = url%(i)
    118          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    119          else: _tmp = _utf8(str(_tmp))
    120          _tmp = _utf8(xhtml_escape(_tmp))
    121          _append(_tmp)
    122          _append('">')
    123          _tmp = i
    124          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    125          else: _tmp = _utf8(str(_tmp))
    126          _tmp = _utf8(xhtml_escape(_tmp))
    127          _append(_tmp)
    128          _append('</a></li>\n')
    129      _append('\n')
    130      if current+3 < total:
    131          _append(' <li><span>...</span></li>')
    132      _append('\n')
    133      if current < total:
    134          _append(' <li><a href="')
    135          _tmp = url%(current+1)
    136          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    137          else: _tmp = _utf8(str(_tmp))
    138          _tmp = _utf8(xhtml_escape(_tmp))
    139          _append(_tmp)
    140          _append('"><span aria-hidden="true">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</span><span class="sr-only">Next</span></a></li>')
    141      _append('\n</ul>\n</div>\n</div>\n</div>')
    142      _append('\n</div>\n</div>\n</div>\n</div>\n')
    143      _append('\n</section>\n</div>\n')
    144      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    145      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n<script type="text/javascript" src="/static/js/base.js"></script>\n')
    146      _append('\n<script>\n$(function () {\n$(\'input[type="checkbox"]\').iCheck({\ncheckboxClass: \'icheckbox_flat-blue\',\nradioClass: \'iradio_flat-blue\'\n});\n$(".checkbox-toggle").click(function () {\nvar clicks = $(this).data(\'clicks\');\nif (clicks) {\n//Uncheck all checkboxes\n$("input[type=\'checkbox\']", ".table").iCheck("uncheck");\n} else {\n//Check all checkboxes\n$("input[type=\'checkbox\']", ".table").iCheck("check");\n}\n$(this).data("clicks", !clicks);\n});\n});\n</script>\n')
    147      _append('\n</body>\n</html>\n')
    148      return _utf8('').join(_buffer)
[E 150421 18:19:43 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0', 'If-None-Match': '"825975ce441dd545f3104460fc4ecd8fc97f2f61"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template comment.html>", line 117, in _execute
    TypeError: __call__() takes exactly 1 argument (2 given)
[E 150421 18:19:43 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 27.88ms
[E 150421 18:55:14 dm.py:start:61] comment.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe8\xaf\x84\xe8\xae\xba')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<!-- sidebar: style can be found in sidebar.less -->\n<section class="sidebar">\n<!-- /.search form -->\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li>\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n<!-- /.sidebar -->\n</aside>')
     11      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     12      _append('\xe8\xaf\x84\xe8\xae\xba')
     13      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     14      _append('\n')
     15      ans = pyobject.get('result')
     16      _append('\n')
     17      query = ans.get('query')
     18      _append('\n')
     19      status = ans.get('r_status', 0)
     20      _append('\n')
     21      category = ans.get('category', 'movie')
     22      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe8\xaf\x84\xe8\xae\xba-')
     23      _tmp = ans.get('category','')
     24      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     25      else: _tmp = _utf8(str(_tmp))
     26      _tmp = _utf8(xhtml_escape(_tmp))
     27      _append(_tmp)
     28      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-trash-o"></i></button>\n<button class="btn btn-default btn-sm" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-reply"></i></button>\n<button class="btn btn-default btn-sm" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-share"></i></button>\n</div>\n</div>\n<div class="col-xs-4" style="float: right">\n<div class="has-feedback">\n<input type="text" class="form-control input-sm" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</div>\n</div>\n<table class="table table-hover">\n<thead>\n')
     29      _append('<tr>\n<th></th>\n<th class="nickname">\xe6\x98\xb5\xe7\xa7\xb0</th>\n<th class="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</th>\n<th class="content">\xe5\x86\x85\xe5\xae\xb9</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     30      _append('\n</thead>\n<tbody>\n')
     31      for q in query:
     32          _append('\n')
     33          _append('<tr>\n<td><input type="checkbox" /></td>\n<td class="nickname">')
     34          _tmp = q.get('name', '')
     35          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     36          else: _tmp = _utf8(str(_tmp))
     37          _tmp = _utf8(xhtml_escape(_tmp))
     38          _append(_tmp)
     39          _append('</td>\n<td class="email">')
     40          _tmp = q.get('email', '')
     41          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     42          else: _tmp = _utf8(str(_tmp))
     43          _tmp = _utf8(xhtml_escape(_tmp))
     44          _append(_tmp)
     45          _append('</td>\n<td class="content">')
     46          _tmp = q.get('contain', '')
     47          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     48          else: _tmp = _utf8(str(_tmp))
     49          _tmp = _utf8(xhtml_escape(_tmp))
     50          _append(_tmp)
     51          _append('</td>\n<td class="status">\xe5\x88\xa0\xe9\x99\xa4</td>\n<td class="time">')
     52          _tmp = q.get('time', '')
     53          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     54          else: _tmp = _utf8(str(_tmp))
     55          _tmp = _utf8(xhtml_escape(_tmp))
     56          _append(_tmp)
     57          _append('</td>\n</tr>')
     58          _append('\n')
     59      _append('\n</tbody>\n</table>\n')
     60      url = '/comment/comment/list?category=%s&status=%s' %(category, status) + "&page_num=%s"
     61      _append('\n')
     62      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe6\x80\xbb\xe5\x85\xb1')
     63      _tmp = ans.get('total_num', 0)
     64      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     65      else: _tmp = _utf8(str(_tmp))
     66      _tmp = _utf8(xhtml_escape(_tmp))
     67      _append(_tmp)
     68      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
     69      current = ans.get('page_num', 1)
     70      _append('\n')
     71      total = ans.get('page_total', 1)
     72      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<!--\n<ul class="pagination">\n<li class="prev disabled">\n<a href="javascript:;">\xe9\xa6\x96\xe9\xa1\xb5</a>\n</li>\n<li class="active">\n<a href="javascript:;">1</a>\n</li>\n<li>\n<a href="javascript:;">2</a>\n</li>\n<li>\n<a href="javascript:;">3</a>\n</li>\n<li>\n<a href="javascript:;">4</a>\n</li>\n<li>\n<a href="javascript:;">5</a>\n</li>\n<li class="next">\n<a hre="javascript:;">\xe5\xb0\xbe\xe9\xa1\xb5</a>\n</li>\n</ul>\n-->\n<ul class="pagination">\n')
     73      if current != 1:
     74          _append('<li><a href="')
     75          _tmp = url %(current-1)
     76          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     77          else: _tmp = _utf8(str(_tmp))
     78          _tmp = _utf8(xhtml_escape(_tmp))
     79          _append(_tmp)
     80          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
     81      _append('\n')
     82      if current-3 > 1:
     83          _append('<li><a href="')
     84          _tmp = url %(1)
     85          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     86          else: _tmp = _utf8(str(_tmp))
     87          _tmp = _utf8(xhtml_escape(_tmp))
     88          _append(_tmp)
     89          _append('">1</a></li>')
     90      _append('\n')
     91      if current-3 > 2:
     92          _append('<li><span>...</span></li>')
     93      _append('\n')
     94      for i in [i for i in range(current-3,current) if i > 0]:
     95          _append('\n<li><a href="')
     96          _tmp = url %(i)
     97          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     98          else: _tmp = _utf8(str(_tmp))
     99          _tmp = _utf8(xhtml_escape(_tmp))
    100          _append(_tmp)
    101          _append('">')
    102          _tmp = i
    103          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    104          else: _tmp = _utf8(str(_tmp))
    105          _tmp = _utf8(xhtml_escape(_tmp))
    106          _append(_tmp)
    107          _append('</a></li>\n')
    108      _append('\n<li class="active"><span>')
    109      _tmp = current
    110      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    111      else: _tmp = _utf8(str(_tmp))
    112      _tmp = _utf8(xhtml_escape(_tmp))
    113      _append(_tmp)
    114      _append('</span></li>\n')
    115      for i in [i for i in range(current+1,current+4) if i <= total ]:
    116          _append('\n<li><a href="')
    117          _tmp = url %(i)
    118          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    119          else: _tmp = _utf8(str(_tmp))
    120          _tmp = _utf8(xhtml_escape(_tmp))
    121          _append(_tmp)
    122          _append('">')
    123          _tmp = i
    124          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    125          else: _tmp = _utf8(str(_tmp))
    126          _tmp = _utf8(xhtml_escape(_tmp))
    127          _append(_tmp)
    128          _append('</a></li>\n')
    129      _append('\n')
    130      if current+3 < total:
    131          _append(' <li><span>...</span></li>')
    132      _append('\n')
    133      if current < total:
    134          _append(' <li><a href="')
    135          _tmp = url %(current+1)
    136          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    137          else: _tmp = _utf8(str(_tmp))
    138          _tmp = _utf8(xhtml_escape(_tmp))
    139          _append(_tmp)
    140          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    141      _append('\n</ul>\n</div>\n</div>\n</div>')
    142      _append('\n</div>\n</div>\n</div>\n</div>\n')
    143      _append('\n</section>\n</div>\n')
    144      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    145      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n<script type="text/javascript" src="/static/js/base.js"></script>\n')
    146      _append('\n<script>\n$(function () {\n$(\'input[type="checkbox"]\').iCheck({\ncheckboxClass: \'icheckbox_flat-blue\',\nradioClass: \'iradio_flat-blue\'\n});\n$(".checkbox-toggle").click(function () {\nvar clicks = $(this).data(\'clicks\');\nif (clicks) {\n//Uncheck all checkboxes\n$("input[type=\'checkbox\']", ".table").iCheck("uncheck");\n} else {\n//Check all checkboxes\n$("input[type=\'checkbox\']", ".table").iCheck("check");\n}\n$(this).data("clicks", !clicks);\n});\n});\n</script>\n')
    147      _append('\n</body>\n</html>\n')
    148      return _utf8('').join(_buffer)
[E 150421 18:55:14 dm.py:start:61] Uncaught exception GET /comment/comment/list?category=movie&status=0&page_num=3 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list?category=movie&status=0&page_num=3', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list?category=movie&status=0&page_num=1', 'Cache-Control': 'max-age=0', 'If-None-Match': '"c6caa9da2427509eb908008e9da58f56472d9c72"', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template comment.html>", line 34, in _execute
    AttributeError: 'str' object has no attribute 'get'
[E 150421 18:55:14 dm.py:start:61] 500 GET /comment/comment/list?category=movie&status=0&page_num=3 (127.0.0.1) 27.14ms
[E 150421 18:55:52 dm.py:start:61] comment.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe8\xaf\x84\xe8\xae\xba')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<!-- sidebar: style can be found in sidebar.less -->\n<section class="sidebar">\n<!-- /.search form -->\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li>\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n<!-- /.sidebar -->\n</aside>')
     11      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     12      _append('\xe8\xaf\x84\xe8\xae\xba')
     13      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     14      _append('\n')
     15      ans = pyobject.get('result')
     16      _append('\n')
     17      query = ans.get('query')
     18      _append('\n')
     19      status = ans.get('r_status', 0)
     20      _append('\n')
     21      category = ans.get('category', 'movie')
     22      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe8\xaf\x84\xe8\xae\xba-')
     23      _tmp = ans.get('category','')
     24      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     25      else: _tmp = _utf8(str(_tmp))
     26      _tmp = _utf8(xhtml_escape(_tmp))
     27      _append(_tmp)
     28      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-trash-o"></i></button>\n<button class="btn btn-default btn-sm" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-reply"></i></button>\n<button class="btn btn-default btn-sm" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-share"></i></button>\n</div>\n</div>\n<div class="col-xs-4" style="float: right">\n<div class="has-feedback">\n<input type="text" class="form-control input-sm" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</div>\n</div>\n<table class="table table-hover">\n<thead>\n')
     29      _append('<tr>\n<th></th>\n<th class="nickname">\xe6\x98\xb5\xe7\xa7\xb0</th>\n<th class="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</th>\n<th class="content">\xe5\x86\x85\xe5\xae\xb9</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     30      _append('\n</thead>\n<tbody>\n')
     31      for q in query:
     32          _append('\n')
     33          _append('<tr>\n<td><input type="checkbox" /></td>\n<td class="nickname">')
     34          _tmp = q.get('name', '')
     35          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     36          else: _tmp = _utf8(str(_tmp))
     37          _tmp = _utf8(xhtml_escape(_tmp))
     38          _append(_tmp)
     39          _append('</td>\n<td class="email">')
     40          _tmp = q.get('email', '')
     41          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     42          else: _tmp = _utf8(str(_tmp))
     43          _tmp = _utf8(xhtml_escape(_tmp))
     44          _append(_tmp)
     45          _append('</td>\n<td class="content">')
     46          _tmp = q.get('contain', '')
     47          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     48          else: _tmp = _utf8(str(_tmp))
     49          _tmp = _utf8(xhtml_escape(_tmp))
     50          _append(_tmp)
     51          _append('</td>\n<td class="status">\xe5\x88\xa0\xe9\x99\xa4</td>\n<td class="time">')
     52          _tmp = q.get('time', '')
     53          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     54          else: _tmp = _utf8(str(_tmp))
     55          _tmp = _utf8(xhtml_escape(_tmp))
     56          _append(_tmp)
     57          _append('</td>\n</tr>')
     58          _append('\n')
     59      _append('\n</tbody>\n</table>\n')
     60      url = '/comment/comment/list?category=%s&status=%s' %(category, status) + "&page_num=%s"
     61      _append('\n')
     62      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe6\x80\xbb\xe5\x85\xb1')
     63      _tmp = ans.get('total_num', 0)
     64      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     65      else: _tmp = _utf8(str(_tmp))
     66      _tmp = _utf8(xhtml_escape(_tmp))
     67      _append(_tmp)
     68      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
     69      current = ans.get('page_num', 1)
     70      _append('\n')
     71      total = ans.get('page_total', 1)
     72      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<!--\n<ul class="pagination">\n<li class="prev disabled">\n<a href="javascript:;">\xe9\xa6\x96\xe9\xa1\xb5</a>\n</li>\n<li class="active">\n<a href="javascript:;">1</a>\n</li>\n<li>\n<a href="javascript:;">2</a>\n</li>\n<li>\n<a href="javascript:;">3</a>\n</li>\n<li>\n<a href="javascript:;">4</a>\n</li>\n<li>\n<a href="javascript:;">5</a>\n</li>\n<li class="next">\n<a hre="javascript:;">\xe5\xb0\xbe\xe9\xa1\xb5</a>\n</li>\n</ul>\n-->\n<ul class="pagination">\n')
     73      if current != 1:
     74          _append('<li><a href="')
     75          _tmp = url %(current-1)
     76          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     77          else: _tmp = _utf8(str(_tmp))
     78          _tmp = _utf8(xhtml_escape(_tmp))
     79          _append(_tmp)
     80          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
     81      _append('\n')
     82      if current-3 > 1:
     83          _append('<li><a href="')
     84          _tmp = url %(1)
     85          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     86          else: _tmp = _utf8(str(_tmp))
     87          _tmp = _utf8(xhtml_escape(_tmp))
     88          _append(_tmp)
     89          _append('">1</a></li>')
     90      _append('\n')
     91      if current-3 > 2:
     92          _append('<li><span>...</span></li>')
     93      _append('\n')
     94      for i in [i for i in range(current-3,current) if i > 0]:
     95          _append('\n<li><a href="')
     96          _tmp = url %(i)
     97          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     98          else: _tmp = _utf8(str(_tmp))
     99          _tmp = _utf8(xhtml_escape(_tmp))
    100          _append(_tmp)
    101          _append('">')
    102          _tmp = i
    103          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    104          else: _tmp = _utf8(str(_tmp))
    105          _tmp = _utf8(xhtml_escape(_tmp))
    106          _append(_tmp)
    107          _append('</a></li>\n')
    108      _append('\n<li class="active"><span>')
    109      _tmp = current
    110      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    111      else: _tmp = _utf8(str(_tmp))
    112      _tmp = _utf8(xhtml_escape(_tmp))
    113      _append(_tmp)
    114      _append('</span></li>\n')
    115      for i in [i for i in range(current+1,current+4) if i <= total ]:
    116          _append('\n<li><a href="')
    117          _tmp = url %(i)
    118          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    119          else: _tmp = _utf8(str(_tmp))
    120          _tmp = _utf8(xhtml_escape(_tmp))
    121          _append(_tmp)
    122          _append('">')
    123          _tmp = i
    124          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    125          else: _tmp = _utf8(str(_tmp))
    126          _tmp = _utf8(xhtml_escape(_tmp))
    127          _append(_tmp)
    128          _append('</a></li>\n')
    129      _append('\n')
    130      if current+3 < total:
    131          _append(' <li><span>...</span></li>')
    132      _append('\n')
    133      if current < total:
    134          _append(' <li><a href="')
    135          _tmp = url %(current+1)
    136          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    137          else: _tmp = _utf8(str(_tmp))
    138          _tmp = _utf8(xhtml_escape(_tmp))
    139          _append(_tmp)
    140          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    141      _append('\n</ul>\n</div>\n</div>\n</div>')
    142      _append('\n</div>\n</div>\n</div>\n</div>\n')
    143      _append('\n</section>\n</div>\n')
    144      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    145      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n<script type="text/javascript" src="/static/js/base.js"></script>\n')
    146      _append('\n<script>\n$(function () {\n$(\'input[type="checkbox"]\').iCheck({\ncheckboxClass: \'icheckbox_flat-blue\',\nradioClass: \'iradio_flat-blue\'\n});\n$(".checkbox-toggle").click(function () {\nvar clicks = $(this).data(\'clicks\');\nif (clicks) {\n//Uncheck all checkboxes\n$("input[type=\'checkbox\']", ".table").iCheck("uncheck");\n} else {\n//Check all checkboxes\n$("input[type=\'checkbox\']", ".table").iCheck("check");\n}\n$(this).data("clicks", !clicks);\n});\n});\n</script>\n')
    147      _append('\n</body>\n</html>\n')
    148      return _utf8('').join(_buffer)
[E 150421 18:55:52 dm.py:start:61] Uncaught exception GET /comment/comment/list?category=movie&status=0&page_num=3 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list?category=movie&status=0&page_num=3', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list?category=movie&status=0&page_num=1', 'Cache-Control': 'max-age=0', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template comment.html>", line 34, in _execute
    AttributeError: 'str' object has no attribute 'get'
[E 150421 18:55:52 dm.py:start:61] 500 GET /comment/comment/list?category=movie&status=0&page_num=3 (127.0.0.1) 30.22ms
[E 150422 09:21:30 comment.py:list:71] __init__() takes exactly 3 arguments (2 given)
[E 150422 09:21:30 dm.py:start:61] Uncaught exception POST /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='category=movie&status=0&contain=%E6%B5%8B%E8%AF%95', headers={'Content-Length': '50', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Content-Type': 'application/x-www-form-urlencoded'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 71, in list
        contain=contain)
    TypeError: _return_ans() takes exactly 5 arguments (4 given)
[E 150422 09:21:30 dm.py:start:61] 500 POST /comment/comment/list (127.0.0.1) 45316.21ms
[E 150422 09:23:06 comment.py:list:99] __init__() takes exactly 3 arguments (2 given)
[E 150422 09:23:06 dm.py:start:61] Uncaught exception POST /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='category=movie&status=0&contain=%E6%B5%8B%E8%AF%95', headers={'Content-Length': '50', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cache-Control': 'max-age=0', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Content-Type': 'application/x-www-form-urlencoded'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 100, in list
        ans = self._return_ans("error", e, "comment_list")
    TypeError: _return_ans() takes exactly 5 arguments (4 given)
[E 150422 09:23:06 dm.py:start:61] 500 POST /comment/comment/list (127.0.0.1) 37687.74ms
[E 150422 09:27:40 comment.py:list:67] 'ascii' codec can't decode byte 0xe6 in position 0: ordinal not in range(128)
[E 150422 09:27:40 dm.py:start:61] Uncaught exception POST /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='category=movie&status=0&contain=%E6%B5%8B%E8%AF%95', headers={'Content-Length': '50', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Content-Type': 'application/x-www-form-urlencoded'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 67, in list
        ans = {}
    TypeError: _return_ans() takes exactly 5 arguments (4 given)
[E 150422 09:27:40 dm.py:start:61] 500 POST /comment/comment/list (127.0.0.1) 2841.30ms
[E 150422 09:28:28 comment.py:list:99] 'ascii' codec can't decode byte 0xe6 in position 0: ordinal not in range(128)
[E 150422 09:28:28 dm.py:start:61] Uncaught exception POST /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='category=movie&status=0&contain=%E6%B5%8B%E8%AF%95', headers={'Content-Length': '50', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cache-Control': 'max-age=0', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Content-Type': 'application/x-www-form-urlencoded'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 100, in list
        ans = self._return_ans("error", e, "comment_list")
    TypeError: _return_ans() takes exactly 5 arguments (4 given)
[E 150422 09:28:28 dm.py:start:61] 500 POST /comment/comment/list (127.0.0.1) 28661.44ms
[E 150422 09:31:24 comment.py:list:98] global name 'conatin' is not defined
[E 150422 09:31:24 dm.py:start:61] Uncaught exception POST /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='category=movie&status=0&contain=%E6%B5%8B%E8%AF%95', headers={'Content-Length': '50', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cache-Control': 'max-age=0', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Content-Type': 'application/x-www-form-urlencoded'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 99, in list
        ans = self._return_ans("error", e, "comment_list")
    TypeError: _return_ans() takes exactly 5 arguments (4 given)
[E 150422 09:31:24 dm.py:start:61] 500 POST /comment/comment/list (127.0.0.1) 7.89ms
[E 150422 09:31:41 comment.py:list:98] global name 'conatin' is not defined
[E 150422 09:31:41 dm.py:start:61] Uncaught exception POST /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='category=movie&status=0&contain=%E4%BD%A0%E5%9C%A8', headers={'Content-Length': '50', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cache-Control': 'max-age=0', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Content-Type': 'application/x-www-form-urlencoded'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 99, in list
        ans = self._return_ans("error", e, "comment_list")
    TypeError: _return_ans() takes exactly 5 arguments (4 given)
[E 150422 09:31:41 dm.py:start:61] 500 POST /comment/comment/list (127.0.0.1) 8.08ms
[E 150422 09:32:18 comment.py:list:98] global name 'conatin' is not defined
[E 150422 09:32:18 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 99, in list
        ans = self._return_ans("error", e, "comment_list","")
      File "api/base.py", line 46, in _return_ans
        for k, v in kwargs.iteritems():
    AttributeError: 'str' object has no attribute 'iteritems'
[E 150422 09:32:18 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 16.94ms
[E 150422 09:33:25 comment.py:list:98] global name 'conatin' is not defined
[E 150422 09:52:46 dm.py:start:61] Uncaught exception GET /comment/comment/list?category=movie&status=0&page_num=1&type=json (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list?category=movie&status=0&page_num=1&type=json', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 101, in list
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: datetime.datetime(2015, 3, 23, 12, 45, 23) is not JSON serializable
[E 150422 09:52:46 dm.py:start:61] 500 GET /comment/comment/list?category=movie&status=0&page_num=1&type=json (127.0.0.1) 31.88ms
[E 150422 10:11:39 comment.py:update_status:114] invalid literal for int() with base 10: ''
[E 150422 10:11:39 dm.py:start:61] Uncaught exception GET /comment/comment/update_status (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 114, in update_status
        r, desc = comment_ctrl.update_status(id=[1,2], status=int(1))
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: ValueError("invalid literal for int() with base 10: ''",) is not JSON serializable
[E 150422 10:11:39 dm.py:start:61] 500 GET /comment/comment/update_status (127.0.0.1) 41360.62ms
[E 150422 10:12:03 comment.py:update_status:114] update_status() got an unexpected keyword argument 'id'
[E 150422 10:12:03 dm.py:start:61] Uncaught exception GET /comment/comment/update_status (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 114, in update_status
        r, desc = comment_ctrl.update_status(ids=[1,2], status=int(1))
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: TypeError("update_status() got an unexpected keyword argument 'id'",) is not JSON serializable
[E 150422 10:12:03 dm.py:start:61] 500 GET /comment/comment/update_status (127.0.0.1) 21024.77ms
[E 150422 10:12:42 comment.py:update_status:121] isinstance expected 2 arguments, got 1
[E 150422 10:12:42 dm.py:start:61] Uncaught exception GET /comment/comment/update_status (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 123, in update_status
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: TypeError('isinstance expected 2 arguments, got 1',) is not JSON serializable
[E 150422 10:12:42 dm.py:start:61] 500 GET /comment/comment/update_status (127.0.0.1) 36533.75ms
[E 150422 10:13:55 comment.py:update_status:121] update() takes at least 2 arguments (1 given)
[E 150422 10:13:55 dm.py:start:61] Uncaught exception GET /comment/comment/update_status (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 123, in update_status
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: TypeError('update() takes at least 2 arguments (1 given)',) is not JSON serializable
[E 150422 10:13:55 dm.py:start:61] 500 GET /comment/comment/update_status (127.0.0.1) 69439.97ms
[E 150422 10:19:18 comment.py:update_status:121] 'int' object is not iterable
[E 150422 10:19:18 dm.py:start:61] Uncaught exception GET /comment/comment/update_status (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0', 'If-None-Match': '"01e961ead05688731f134f8cd73e3ea92b90de86"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 123, in update_status
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: TypeError("'int' object is not iterable",) is not JSON serializable
[E 150422 10:19:18 dm.py:start:61] 500 GET /comment/comment/update_status (127.0.0.1) 90151.40ms
[E 150422 12:34:44 dm.py:start:61] Uncaught exception GET /comment/comment/update_status?id%5B%5D=1001&id%5B%5D=3&status=2 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status?id%5B%5D=1001&id%5B%5D=3&status=2', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 112, in update_status
        ipbd.set_trace()
    NameError: global name 'ipbd' is not defined
[E 150422 12:34:44 dm.py:start:61] 500 GET /comment/comment/update_status?id%5B%5D=1001&id%5B%5D=3&status=2 (127.0.0.1) 432.85ms
[E 150422 12:41:34 dm.py:start:61] Uncaught exception GET /comment/comment/update_status?id=%5B1001%2C3%5D&status=2 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status?id=%5B1001%2C3%5D&status=2', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'If-None-Match': '"01e961ead05688731f134f8cd73e3ea92b90de86"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 113, in update_status
        ids = json.loads(ids)
      File "/usr/lib/python2.7/json/__init__.py", line 338, in loads
        return _default_decoder.decode(s)
      File "/usr/lib/python2.7/json/decoder.py", line 366, in decode
        obj, end = self.raw_decode(s, idx=_w(s, 0).end())
      File "/usr/lib/python2.7/json/decoder.py", line 384, in raw_decode
        raise ValueError("No JSON object could be decoded")
    ValueError: No JSON object could be decoded
[E 150422 12:41:34 dm.py:start:61] 500 GET /comment/comment/update_status?id=%5B1001%2C3%5D&status=2 (127.0.0.1) 25711.09ms
[E 150422 13:01:33 dm.py:start:61] comment.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe8\xaf\x84\xe8\xae\xba')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<!-- sidebar: style can be found in sidebar.less -->\n<section class="sidebar">\n<!-- /.search form -->\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li>\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n<!-- /.sidebar -->\n</aside>')
     11      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     12      _append('\xe8\xaf\x84\xe8\xae\xba')
     13      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     14      _append('\n')
     15      ans = pyobject.get('result')
     16      _append('\n')
     17      query = ans.get('query')
     18      _append('\n')
     19      status = ans.get('r_status', 0)
     20      _append('\n')
     21      category = ans.get('category', 'movie')
     22      _append('\n')
     23      contain = ans.get('contain', '')
     24      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe8\xaf\x84\xe8\xae\xba-')
     25      _tmp = ans.get('category','')
     26      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     27      else: _tmp = _utf8(str(_tmp))
     28      _tmp = _utf8(xhtml_escape(_tmp))
     29      _append(_tmp)
     30      if contain:
     31          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     32          _tmp = contain
     33          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     34          else: _tmp = _utf8(str(_tmp))
     35          _tmp = _utf8(xhtml_escape(_tmp))
     36          _append(_tmp)
     37      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm hidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm remove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm normal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="category" value="')
     38      _tmp = category
     39      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     40      else: _tmp = _utf8(str(_tmp))
     41      _tmp = _utf8(xhtml_escape(_tmp))
     42      _append(_tmp)
     43      _append('" />\n<input type="hidden" name="status" value="')
     44      _tmp = status
     45      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     46      else: _tmp = _utf8(str(_tmp))
     47      _tmp = _utf8(xhtml_escape(_tmp))
     48      _append(_tmp)
     49      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover">\n<thead>\n')
     50      _append('<tr>\n<th></th>\n<th class="nickname">\xe6\x98\xb5\xe7\xa7\xb0</th>\n<th class="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</th>\n<th class="content">\xe5\x86\x85\xe5\xae\xb9</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     51      _append('\n</thead>\n<tbody>\n')
     52      if type(query) == list:
     53          _append('\n')
     54          for q in query:
     55              _append('\n')
     56              _append('<tr>\n<td><input type="checkbox" data-id="')
     57              _tmp = q.get('id',0)
     58              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     59              else: _tmp = _utf8(str(_tmp))
     60              _tmp = _utf8(xhtml_escape(_tmp))
     61              _append(_tmp)
     62              _append('"/></td>\n<td class="nickname">')
     63              _tmp = q.get('name', '')
     64              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     65              else: _tmp = _utf8(str(_tmp))
     66              _tmp = _utf8(xhtml_escape(_tmp))
     67              _append(_tmp)
     68              _append('</td>\n<td class="email">')
     69              _tmp = q.get('email', '')
     70              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     71              else: _tmp = _utf8(str(_tmp))
     72              _tmp = _utf8(xhtml_escape(_tmp))
     73              _append(_tmp)
     74              _append('</td>\n<td class="content">')
     75              _tmp = q.get('contain', '')
     76              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     77              else: _tmp = _utf8(str(_tmp))
     78              _tmp = _utf8(xhtml_escape(_tmp))
     79              _append(_tmp)
     80              _append('</td>\n<td class="status">\n')
     81              r_status == int(q.get('status'))
     82              _append('\n')
     83              _tmp = r_status
     84              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     85              else: _tmp = _utf8(str(_tmp))
     86              _tmp = _utf8(xhtml_escape(_tmp))
     87              _append(_tmp)
     88              _append('\n')
     89              _tmp = type(status)
     90              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     91              else: _tmp = _utf8(str(_tmp))
     92              _tmp = _utf8(xhtml_escape(_tmp))
     93              _append(_tmp)
     94              _append('\n')
     95              if r_status == 1:
     96                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
     97              elif r_status == 2:
     98                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
     99              elif r_status == 3:
    100                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
    101              else:
    102                  _append('\n<span class="label label-info">\xe5\x85\xa8\xe9\x83\xa8</span>\n')
    103              _append('\n</td>\n')
    104              _tmp = q
    105              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    106              else: _tmp = _utf8(str(_tmp))
    107              _tmp = _utf8(xhtml_escape(_tmp))
    108              _append(_tmp)
    109              _append('\n<td class="time">')
    110              _tmp = q.get('time', '')
    111              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    112              else: _tmp = _utf8(str(_tmp))
    113              _tmp = _utf8(xhtml_escape(_tmp))
    114              _append(_tmp)
    115              _append('</td>\n</tr>')
    116              _append('\n')
    117          _append('\n')
    118      _append('\n</tbody>\n</table>\n')
    119      url = '/comment/comment/list?category=%s&status=%s' %(category, status)
    120      _append('\n')
    121      if contain:
    122          _append('\n')
    123          url = url + '&contain=%s' %(contain)
    124          _append('\n')
    125      _append('\n')
    126      url = url + "&page_num=%s"
    127      _append('\n')
    128      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    129      _tmp = ans.get('total_num', 0)
    130      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    131      else: _tmp = _utf8(str(_tmp))
    132      _tmp = _utf8(xhtml_escape(_tmp))
    133      _append(_tmp)
    134      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    135      current = ans.get('page_num', 1)
    136      _append('\n')
    137      total = ans.get('page_total', 1)
    138      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    139      if current != 1:
    140          _append('<li><a href="')
    141          _tmp = url %(current-1)
    142          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    143          else: _tmp = _utf8(str(_tmp))
    144          _tmp = _utf8(xhtml_escape(_tmp))
    145          _append(_tmp)
    146          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    147      _append('\n')
    148      if current-3 > 1:
    149          _append('<li><a href="')
    150          _tmp = url %(1)
    151          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    152          else: _tmp = _utf8(str(_tmp))
    153          _tmp = _utf8(xhtml_escape(_tmp))
    154          _append(_tmp)
    155          _append('">1</a></li>')
    156      _append('\n')
    157      if current-3 > 2:
    158          _append('<li><...</li>')
    159      _append('\n')
    160      for i in [i for i in range(current-3,current) if i > 0]:
    161          _append('\n<li><a href="')
    162          _tmp = url %(i)
    163          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    164          else: _tmp = _utf8(str(_tmp))
    165          _tmp = _utf8(xhtml_escape(_tmp))
    166          _append(_tmp)
    167          _append('">')
    168          _tmp = i
    169          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    170          else: _tmp = _utf8(str(_tmp))
    171          _tmp = _utf8(xhtml_escape(_tmp))
    172          _append(_tmp)
    173          _append('</a></li>\n')
    174      _append('\n<li class="active"><a href="javascript:;">')
    175      _tmp = current
    176      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    177      else: _tmp = _utf8(str(_tmp))
    178      _tmp = _utf8(xhtml_escape(_tmp))
    179      _append(_tmp)
    180      _append('</a></li>\n')
    181      for i in [i for i in range(current+1,current+4) if i <= total ]:
    182          _append('\n<li><a href="')
    183          _tmp = url %(i)
    184          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    185          else: _tmp = _utf8(str(_tmp))
    186          _tmp = _utf8(xhtml_escape(_tmp))
    187          _append(_tmp)
    188          _append('">')
    189          _tmp = i
    190          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    191          else: _tmp = _utf8(str(_tmp))
    192          _tmp = _utf8(xhtml_escape(_tmp))
    193          _append(_tmp)
    194          _append('</a></li>\n')
    195      _append('\n')
    196      if current+3 < total:
    197          _append(' <li>...</li>')
    198      _append('\n')
    199      if current < total:
    200          _append(' <li><a href="')
    201          _tmp = url %(current+1)
    202          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    203          else: _tmp = _utf8(str(_tmp))
    204          _tmp = _utf8(xhtml_escape(_tmp))
    205          _append(_tmp)
    206          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    207      _append('\n</ul>\n</div>\n</div>\n</div>')
    208      _append('\n</div>\n</div>\n</div>\n</div>\n')
    209      _append('\n</section>\n</div>\n')
    210      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    211      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    212      _append('\n<script>\n$(function () {\n$(".remove").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".hidden").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 3;\n})\n$(".normal").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 1;\n})\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nfor(var i=0;i<ids.length;i++){\n}\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n})\nreturn false;\n};\n});\n</script>\n')
    213      _append('\n</body>\n</html>\n')
    214      return _utf8('').join(_buffer)
[E 150422 13:01:33 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0', 'If-None-Match': '"17087e9abcacefb631a56bf8a88b87f7813fd5eb"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template comment.html>", line 81, in _execute
    NameError: global name 'r_status' is not defined
[E 150422 13:01:33 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 86.26ms
[E 150422 13:01:49 dm.py:start:61] comment.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe8\xaf\x84\xe8\xae\xba')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<!-- sidebar: style can be found in sidebar.less -->\n<section class="sidebar">\n<!-- /.search form -->\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li>\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n<!-- /.sidebar -->\n</aside>')
     11      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     12      _append('\xe8\xaf\x84\xe8\xae\xba')
     13      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     14      _append('\n')
     15      ans = pyobject.get('result')
     16      _append('\n')
     17      query = ans.get('query')
     18      _append('\n')
     19      status = ans.get('r_status', 0)
     20      _append('\n')
     21      category = ans.get('category', 'movie')
     22      _append('\n')
     23      contain = ans.get('contain', '')
     24      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe8\xaf\x84\xe8\xae\xba-')
     25      _tmp = ans.get('category','')
     26      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     27      else: _tmp = _utf8(str(_tmp))
     28      _tmp = _utf8(xhtml_escape(_tmp))
     29      _append(_tmp)
     30      if contain:
     31          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     32          _tmp = contain
     33          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     34          else: _tmp = _utf8(str(_tmp))
     35          _tmp = _utf8(xhtml_escape(_tmp))
     36          _append(_tmp)
     37      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm hidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm remove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm normal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="category" value="')
     38      _tmp = category
     39      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     40      else: _tmp = _utf8(str(_tmp))
     41      _tmp = _utf8(xhtml_escape(_tmp))
     42      _append(_tmp)
     43      _append('" />\n<input type="hidden" name="status" value="')
     44      _tmp = status
     45      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     46      else: _tmp = _utf8(str(_tmp))
     47      _tmp = _utf8(xhtml_escape(_tmp))
     48      _append(_tmp)
     49      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover">\n<thead>\n')
     50      _append('<tr>\n<th></th>\n<th class="nickname">\xe6\x98\xb5\xe7\xa7\xb0</th>\n<th class="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</th>\n<th class="content">\xe5\x86\x85\xe5\xae\xb9</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     51      _append('\n</thead>\n<tbody>\n')
     52      if type(query) == list:
     53          _append('\n')
     54          for q in query:
     55              _append('\n')
     56              _append('<tr>\n<td><input type="checkbox" data-id="')
     57              _tmp = q.get('id',0)
     58              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     59              else: _tmp = _utf8(str(_tmp))
     60              _tmp = _utf8(xhtml_escape(_tmp))
     61              _append(_tmp)
     62              _append('"/></td>\n<td class="nickname">')
     63              _tmp = q.get('name', '')
     64              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     65              else: _tmp = _utf8(str(_tmp))
     66              _tmp = _utf8(xhtml_escape(_tmp))
     67              _append(_tmp)
     68              _append('</td>\n<td class="email">')
     69              _tmp = q.get('email', '')
     70              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     71              else: _tmp = _utf8(str(_tmp))
     72              _tmp = _utf8(xhtml_escape(_tmp))
     73              _append(_tmp)
     74              _append('</td>\n<td class="content">')
     75              _tmp = q.get('contain', '')
     76              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     77              else: _tmp = _utf8(str(_tmp))
     78              _tmp = _utf8(xhtml_escape(_tmp))
     79              _append(_tmp)
     80              _append('</td>\n<td class="status">\n')
     81              r_status == int(q.get('status'))
     82              _append('\n')
     83              _tmp = r_status
     84              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     85              else: _tmp = _utf8(str(_tmp))
     86              _tmp = _utf8(xhtml_escape(_tmp))
     87              _append(_tmp)
     88              _append('\n')
     89              _tmp = type(r_status)
     90              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     91              else: _tmp = _utf8(str(_tmp))
     92              _tmp = _utf8(xhtml_escape(_tmp))
     93              _append(_tmp)
     94              _append('\n')
     95              if r_status == 1:
     96                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
     97              elif r_status == 2:
     98                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
     99              elif r_status == 3:
    100                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
    101              else:
    102                  _append('\n<span class="label label-info">\xe5\x85\xa8\xe9\x83\xa8</span>\n')
    103              _append('\n</td>\n')
    104              _tmp = q
    105              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    106              else: _tmp = _utf8(str(_tmp))
    107              _tmp = _utf8(xhtml_escape(_tmp))
    108              _append(_tmp)
    109              _append('\n<td class="time">')
    110              _tmp = q.get('time', '')
    111              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    112              else: _tmp = _utf8(str(_tmp))
    113              _tmp = _utf8(xhtml_escape(_tmp))
    114              _append(_tmp)
    115              _append('</td>\n</tr>')
    116              _append('\n')
    117          _append('\n')
    118      _append('\n</tbody>\n</table>\n')
    119      url = '/comment/comment/list?category=%s&status=%s' %(category, status)
    120      _append('\n')
    121      if contain:
    122          _append('\n')
    123          url = url + '&contain=%s' %(contain)
    124          _append('\n')
    125      _append('\n')
    126      url = url + "&page_num=%s"
    127      _append('\n')
    128      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    129      _tmp = ans.get('total_num', 0)
    130      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    131      else: _tmp = _utf8(str(_tmp))
    132      _tmp = _utf8(xhtml_escape(_tmp))
    133      _append(_tmp)
    134      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    135      current = ans.get('page_num', 1)
    136      _append('\n')
    137      total = ans.get('page_total', 1)
    138      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    139      if current != 1:
    140          _append('<li><a href="')
    141          _tmp = url %(current-1)
    142          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    143          else: _tmp = _utf8(str(_tmp))
    144          _tmp = _utf8(xhtml_escape(_tmp))
    145          _append(_tmp)
    146          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    147      _append('\n')
    148      if current-3 > 1:
    149          _append('<li><a href="')
    150          _tmp = url %(1)
    151          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    152          else: _tmp = _utf8(str(_tmp))
    153          _tmp = _utf8(xhtml_escape(_tmp))
    154          _append(_tmp)
    155          _append('">1</a></li>')
    156      _append('\n')
    157      if current-3 > 2:
    158          _append('<li><...</li>')
    159      _append('\n')
    160      for i in [i for i in range(current-3,current) if i > 0]:
    161          _append('\n<li><a href="')
    162          _tmp = url %(i)
    163          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    164          else: _tmp = _utf8(str(_tmp))
    165          _tmp = _utf8(xhtml_escape(_tmp))
    166          _append(_tmp)
    167          _append('">')
    168          _tmp = i
    169          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    170          else: _tmp = _utf8(str(_tmp))
    171          _tmp = _utf8(xhtml_escape(_tmp))
    172          _append(_tmp)
    173          _append('</a></li>\n')
    174      _append('\n<li class="active"><a href="javascript:;">')
    175      _tmp = current
    176      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    177      else: _tmp = _utf8(str(_tmp))
    178      _tmp = _utf8(xhtml_escape(_tmp))
    179      _append(_tmp)
    180      _append('</a></li>\n')
    181      for i in [i for i in range(current+1,current+4) if i <= total ]:
    182          _append('\n<li><a href="')
    183          _tmp = url %(i)
    184          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    185          else: _tmp = _utf8(str(_tmp))
    186          _tmp = _utf8(xhtml_escape(_tmp))
    187          _append(_tmp)
    188          _append('">')
    189          _tmp = i
    190          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    191          else: _tmp = _utf8(str(_tmp))
    192          _tmp = _utf8(xhtml_escape(_tmp))
    193          _append(_tmp)
    194          _append('</a></li>\n')
    195      _append('\n')
    196      if current+3 < total:
    197          _append(' <li>...</li>')
    198      _append('\n')
    199      if current < total:
    200          _append(' <li><a href="')
    201          _tmp = url %(current+1)
    202          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    203          else: _tmp = _utf8(str(_tmp))
    204          _tmp = _utf8(xhtml_escape(_tmp))
    205          _append(_tmp)
    206          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    207      _append('\n</ul>\n</div>\n</div>\n</div>')
    208      _append('\n</div>\n</div>\n</div>\n</div>\n')
    209      _append('\n</section>\n</div>\n')
    210      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    211      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    212      _append('\n<script>\n$(function () {\n$(".remove").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".hidden").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 3;\n})\n$(".normal").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 1;\n})\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nfor(var i=0;i<ids.length;i++){\n}\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n})\nreturn false;\n};\n});\n</script>\n')
    213      _append('\n</body>\n</html>\n')
    214      return _utf8('').join(_buffer)
[E 150422 13:01:49 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template comment.html>", line 81, in _execute
    NameError: global name 'r_status' is not defined
[E 150422 13:01:49 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 63.14ms
[E 150422 13:26:52 dm.py:start:61] comment.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe8\xaf\x84\xe8\xae\xba')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<!-- sidebar: style can be found in sidebar.less -->\n<section class="sidebar">\n<!-- /.search form -->\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li>\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n<!-- /.sidebar -->\n</aside>')
     11      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     12      _append('\xe8\xaf\x84\xe8\xae\xba')
     13      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     14      _append('\n')
     15      ans = pyobject.get('result')
     16      _append('\n')
     17      query = ans.get('query')
     18      _append('\n')
     19      r_status = ans.get('r_status', 0)
     20      _append('\n')
     21      category = ans.get('category', 'movie')
     22      _append('\n')
     23      contain = ans.get('contain', '')
     24      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe8\xaf\x84\xe8\xae\xba-')
     25      _tmp = ans.get('category','')
     26      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     27      else: _tmp = _utf8(str(_tmp))
     28      _tmp = _utf8(xhtml_escape(_tmp))
     29      _append(_tmp)
     30      if contain:
     31          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     32          _tmp = contain
     33          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     34          else: _tmp = _utf8(str(_tmp))
     35          _tmp = _utf8(xhtml_escape(_tmp))
     36          _append(_tmp)
     37      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm hidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm remove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm normal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="category" value="')
     38      _tmp = category
     39      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     40      else: _tmp = _utf8(str(_tmp))
     41      _tmp = _utf8(xhtml_escape(_tmp))
     42      _append(_tmp)
     43      _append('" />\n<input type="hidden" name="status" value="')
     44      _tmp = status
     45      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     46      else: _tmp = _utf8(str(_tmp))
     47      _tmp = _utf8(xhtml_escape(_tmp))
     48      _append(_tmp)
     49      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover">\n<thead>\n')
     50      _append('<tr>\n<th></th>\n<th class="nickname">\xe6\x98\xb5\xe7\xa7\xb0</th>\n<th class="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</th>\n<th class="content">\xe5\x86\x85\xe5\xae\xb9</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     51      _append('\n</thead>\n<tbody>\n')
     52      if type(query) == list:
     53          _append('\n')
     54          for q in query:
     55              _append('\n')
     56              _append('<tr>\n<td><input type="checkbox" data-id="')
     57              _tmp = q.get('id',0)
     58              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     59              else: _tmp = _utf8(str(_tmp))
     60              _tmp = _utf8(xhtml_escape(_tmp))
     61              _append(_tmp)
     62              _append('"/></td>\n<td class="nickname">')
     63              _tmp = q.get('name', '')
     64              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     65              else: _tmp = _utf8(str(_tmp))
     66              _tmp = _utf8(xhtml_escape(_tmp))
     67              _append(_tmp)
     68              _append('</td>\n<td class="email">')
     69              _tmp = q.get('email', '')
     70              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     71              else: _tmp = _utf8(str(_tmp))
     72              _tmp = _utf8(xhtml_escape(_tmp))
     73              _append(_tmp)
     74              _append('</td>\n<td class="content">')
     75              _tmp = q.get('contain', '')
     76              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     77              else: _tmp = _utf8(str(_tmp))
     78              _tmp = _utf8(xhtml_escape(_tmp))
     79              _append(_tmp)
     80              _append('</td>\n<td class="status">\n')
     81              status = int(q.get('status', 0))
     82              _append('\n')
     83              if status == 1:
     84                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
     85              elif status == 2:
     86                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
     87              elif status == 3:
     88                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
     89              _append('\n</td>\n<td class="time">')
     90              _tmp = q.get('time', '')
     91              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     92              else: _tmp = _utf8(str(_tmp))
     93              _tmp = _utf8(xhtml_escape(_tmp))
     94              _append(_tmp)
     95              _append('</td>\n</tr>')
     96              _append('\n')
     97          _append('\n')
     98      _append('\n</tbody>\n</table>\n')
     99      url = '/comment/comment/list?category=%s&status=%s' %(category, r_status)
    100      _append('\n')
    101      if contain:
    102          _append('\n')
    103          url = url + '&contain=%s' %(contain)
    104          _append('\n')
    105      _append('\n')
    106      url = url + "&page_num=%s"
    107      _append('\n')
    108      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    109      _tmp = ans.get('total_num', 0)
    110      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    111      else: _tmp = _utf8(str(_tmp))
    112      _tmp = _utf8(xhtml_escape(_tmp))
    113      _append(_tmp)
    114      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    115      current = ans.get('page_num', 1)
    116      _append('\n')
    117      total = ans.get('page_total', 1)
    118      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    119      if current != 1:
    120          _append('<li><a href="')
    121          _tmp = url %(current-1)
    122          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    123          else: _tmp = _utf8(str(_tmp))
    124          _tmp = _utf8(xhtml_escape(_tmp))
    125          _append(_tmp)
    126          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    127      _append('\n')
    128      if current-3 > 1:
    129          _append('<li><a href="')
    130          _tmp = url %(1)
    131          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    132          else: _tmp = _utf8(str(_tmp))
    133          _tmp = _utf8(xhtml_escape(_tmp))
    134          _append(_tmp)
    135          _append('">1</a></li>')
    136      _append('\n')
    137      if current-3 > 2:
    138          _append('<li><...</li>')
    139      _append('\n')
    140      for i in [i for i in range(current-3,current) if i > 0]:
    141          _append('\n<li><a href="')
    142          _tmp = url %(i)
    143          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    144          else: _tmp = _utf8(str(_tmp))
    145          _tmp = _utf8(xhtml_escape(_tmp))
    146          _append(_tmp)
    147          _append('">')
    148          _tmp = i
    149          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    150          else: _tmp = _utf8(str(_tmp))
    151          _tmp = _utf8(xhtml_escape(_tmp))
    152          _append(_tmp)
    153          _append('</a></li>\n')
    154      _append('\n<li class="active"><a href="javascript:;">')
    155      _tmp = current
    156      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    157      else: _tmp = _utf8(str(_tmp))
    158      _tmp = _utf8(xhtml_escape(_tmp))
    159      _append(_tmp)
    160      _append('</a></li>\n')
    161      for i in [i for i in range(current+1,current+4) if i <= total ]:
    162          _append('\n<li><a href="')
    163          _tmp = url %(i)
    164          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    165          else: _tmp = _utf8(str(_tmp))
    166          _tmp = _utf8(xhtml_escape(_tmp))
    167          _append(_tmp)
    168          _append('">')
    169          _tmp = i
    170          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    171          else: _tmp = _utf8(str(_tmp))
    172          _tmp = _utf8(xhtml_escape(_tmp))
    173          _append(_tmp)
    174          _append('</a></li>\n')
    175      _append('\n')
    176      if current+3 < total:
    177          _append(' <li>...</li>')
    178      _append('\n')
    179      if current < total:
    180          _append(' <li><a href="')
    181          _tmp = url %(current+1)
    182          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    183          else: _tmp = _utf8(str(_tmp))
    184          _tmp = _utf8(xhtml_escape(_tmp))
    185          _append(_tmp)
    186          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    187      _append('\n</ul>\n</div>\n</div>\n</div>')
    188      _append('\n</div>\n</div>\n</div>\n</div>\n')
    189      _append('\n</section>\n</div>\n')
    190      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    191      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    192      _append('\n<script>\n$(function () {\n$(".remove").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".hidden").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 3;\najax_status(ids, status);\n})\n$(".normal").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 1;\najax_status(ids, status);\n})\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n})\nreturn false;\n};\n});\n</script>\n')
    193      _append('\n</body>\n</html>\n')
    194      return _utf8('').join(_buffer)
[E 150422 13:26:52 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0', 'If-None-Match': '"1dd0d0ad32d3635a60044244de108084a22ef25c"'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template comment.html>", line 44, in _execute
    UnboundLocalError: local variable 'status' referenced before assignment
[E 150422 13:26:52 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 26.06ms
[E 150422 13:28:26 dm.py:start:61] comment.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe8\xaf\x84\xe8\xae\xba')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<!-- sidebar: style can be found in sidebar.less -->\n<section class="sidebar">\n<!-- /.search form -->\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li>\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n<!-- /.sidebar -->\n</aside>')
     11      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     12      _append('\xe8\xaf\x84\xe8\xae\xba')
     13      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     14      _append('\n')
     15      ans = pyobject.get('result')
     16      _append('\n')
     17      query = ans.get('query')
     18      _append('\n')
     19      r_status = ans.get('r_status', 0)
     20      _append('\n')
     21      category = ans.get('category', 'movie')
     22      _append('\n')
     23      contain = ans.get('contain', '')
     24      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe8\xaf\x84\xe8\xae\xba-')
     25      _tmp = ans.get('category','')
     26      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     27      else: _tmp = _utf8(str(_tmp))
     28      _tmp = _utf8(xhtml_escape(_tmp))
     29      _append(_tmp)
     30      if contain:
     31          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     32          _tmp = contain
     33          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     34          else: _tmp = _utf8(str(_tmp))
     35          _tmp = _utf8(xhtml_escape(_tmp))
     36          _append(_tmp)
     37      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm hidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm remove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm normal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="category" value="')
     38      _tmp = category
     39      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     40      else: _tmp = _utf8(str(_tmp))
     41      _tmp = _utf8(xhtml_escape(_tmp))
     42      _append(_tmp)
     43      _append('" />\n<input type="hidden" name="status" value="')
     44      _tmp = status
     45      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     46      else: _tmp = _utf8(str(_tmp))
     47      _tmp = _utf8(xhtml_escape(_tmp))
     48      _append(_tmp)
     49      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover">\n<thead>\n')
     50      _append('<tr>\n<th></th>\n<th class="nickname">\xe6\x98\xb5\xe7\xa7\xb0</th>\n<th class="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</th>\n<th class="content">\xe5\x86\x85\xe5\xae\xb9</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     51      _append('\n</thead>\n<tbody>\n')
     52      if type(query) == list:
     53          _append('\n')
     54          for q in query:
     55              _append('\n')
     56              _append('<tr>\n<td><input type="checkbox" data-id="')
     57              _tmp = q.get('id',0)
     58              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     59              else: _tmp = _utf8(str(_tmp))
     60              _tmp = _utf8(xhtml_escape(_tmp))
     61              _append(_tmp)
     62              _append('"/></td>\n<td class="nickname">')
     63              _tmp = q.get('name', '')
     64              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     65              else: _tmp = _utf8(str(_tmp))
     66              _tmp = _utf8(xhtml_escape(_tmp))
     67              _append(_tmp)
     68              _append('</td>\n<td class="email">')
     69              _tmp = q.get('email', '')
     70              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     71              else: _tmp = _utf8(str(_tmp))
     72              _tmp = _utf8(xhtml_escape(_tmp))
     73              _append(_tmp)
     74              _append('</td>\n<td class="content">')
     75              _tmp = q.get('contain', '')
     76              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     77              else: _tmp = _utf8(str(_tmp))
     78              _tmp = _utf8(xhtml_escape(_tmp))
     79              _append(_tmp)
     80              _append('</td>\n<td class="status">\n')
     81              _tmp = q.get('status')
     82              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     83              else: _tmp = _utf8(str(_tmp))
     84              _tmp = _utf8(xhtml_escape(_tmp))
     85              _append(_tmp)
     86              _append("\n{#% set status = int(q.get('status', 0)) %#}\n")
     87              if status == 1:
     88                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
     89              elif status == 2:
     90                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
     91              elif status == 3:
     92                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
     93              _append('\n</td>\n<td class="time">')
     94              _tmp = q.get('time', '')
     95              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     96              else: _tmp = _utf8(str(_tmp))
     97              _tmp = _utf8(xhtml_escape(_tmp))
     98              _append(_tmp)
     99              _append('</td>\n</tr>')
    100              _append('\n')
    101          _append('\n')
    102      _append('\n</tbody>\n</table>\n')
    103      url = '/comment/comment/list?category=%s&status=%s' %(category, r_status)
    104      _append('\n')
    105      if contain:
    106          _append('\n')
    107          url = url + '&contain=%s' %(contain)
    108          _append('\n')
    109      _append('\n')
    110      url = url + "&page_num=%s"
    111      _append('\n')
    112      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    113      _tmp = ans.get('total_num', 0)
    114      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    115      else: _tmp = _utf8(str(_tmp))
    116      _tmp = _utf8(xhtml_escape(_tmp))
    117      _append(_tmp)
    118      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    119      current = ans.get('page_num', 1)
    120      _append('\n')
    121      total = ans.get('page_total', 1)
    122      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    123      if current != 1:
    124          _append('<li><a href="')
    125          _tmp = url %(current-1)
    126          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    127          else: _tmp = _utf8(str(_tmp))
    128          _tmp = _utf8(xhtml_escape(_tmp))
    129          _append(_tmp)
    130          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    131      _append('\n')
    132      if current-3 > 1:
    133          _append('<li><a href="')
    134          _tmp = url %(1)
    135          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    136          else: _tmp = _utf8(str(_tmp))
    137          _tmp = _utf8(xhtml_escape(_tmp))
    138          _append(_tmp)
    139          _append('">1</a></li>')
    140      _append('\n')
    141      if current-3 > 2:
    142          _append('<li><...</li>')
    143      _append('\n')
    144      for i in [i for i in range(current-3,current) if i > 0]:
    145          _append('\n<li><a href="')
    146          _tmp = url %(i)
    147          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    148          else: _tmp = _utf8(str(_tmp))
    149          _tmp = _utf8(xhtml_escape(_tmp))
    150          _append(_tmp)
    151          _append('">')
    152          _tmp = i
    153          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    154          else: _tmp = _utf8(str(_tmp))
    155          _tmp = _utf8(xhtml_escape(_tmp))
    156          _append(_tmp)
    157          _append('</a></li>\n')
    158      _append('\n<li class="active"><a href="javascript:;">')
    159      _tmp = current
    160      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    161      else: _tmp = _utf8(str(_tmp))
    162      _tmp = _utf8(xhtml_escape(_tmp))
    163      _append(_tmp)
    164      _append('</a></li>\n')
    165      for i in [i for i in range(current+1,current+4) if i <= total ]:
    166          _append('\n<li><a href="')
    167          _tmp = url %(i)
    168          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    169          else: _tmp = _utf8(str(_tmp))
    170          _tmp = _utf8(xhtml_escape(_tmp))
    171          _append(_tmp)
    172          _append('">')
    173          _tmp = i
    174          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    175          else: _tmp = _utf8(str(_tmp))
    176          _tmp = _utf8(xhtml_escape(_tmp))
    177          _append(_tmp)
    178          _append('</a></li>\n')
    179      _append('\n')
    180      if current+3 < total:
    181          _append(' <li>...</li>')
    182      _append('\n')
    183      if current < total:
    184          _append(' <li><a href="')
    185          _tmp = url %(current+1)
    186          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    187          else: _tmp = _utf8(str(_tmp))
    188          _tmp = _utf8(xhtml_escape(_tmp))
    189          _append(_tmp)
    190          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    191      _append('\n</ul>\n</div>\n</div>\n</div>')
    192      _append('\n</div>\n</div>\n</div>\n</div>\n')
    193      _append('\n</section>\n</div>\n')
    194      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    195      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    196      _append('\n<script>\n$(function () {\n$(".remove").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".hidden").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 3;\najax_status(ids, status);\n})\n$(".normal").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 1;\najax_status(ids, status);\n})\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n})\nreturn false;\n};\n});\n</script>\n')
    197      _append('\n</body>\n</html>\n')
    198      return _utf8('').join(_buffer)
[E 150422 13:28:26 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Cache-Control': 'max-age=0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template comment.html>", line 44, in _execute
    NameError: global name 'status' is not defined
[E 150422 13:28:26 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 22.09ms
[E 150422 14:09:01 dm.py:start:61] comment.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe8\xaf\x84\xe8\xae\xba')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<!-- sidebar: style can be found in sidebar.less -->\n<section class="sidebar">\n<!-- /.search form -->\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li>\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n<!-- /.sidebar -->\n</aside>')
     11      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     12      _append('\xe8\xaf\x84\xe8\xae\xba')
     13      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     14      _append('\n')
     15      ans = pyobject.get('result')
     16      _append('\n')
     17      query = ans.get('query')
     18      _append('\n')
     19      r_status = ans.get('r_status', 0)
     20      _append('\n')
     21      category = ans.get('category', 'movie')
     22      _append('\n')
     23      contain = ans.get('contain', '')
     24      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe8\xaf\x84\xe8\xae\xba-')
     25      _tmp = ans.get('category','')
     26      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     27      else: _tmp = _utf8(str(_tmp))
     28      _tmp = _utf8(xhtml_escape(_tmp))
     29      _append(_tmp)
     30      if contain:
     31          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     32          _tmp = contain
     33          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     34          else: _tmp = _utf8(str(_tmp))
     35          _tmp = _utf8(xhtml_escape(_tmp))
     36          _append(_tmp)
     37      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm ihidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm iremove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm inormal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="category" value="')
     38      _tmp = category
     39      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     40      else: _tmp = _utf8(str(_tmp))
     41      _tmp = _utf8(xhtml_escape(_tmp))
     42      _append(_tmp)
     43      _append('" />\n<input type="hidden" name="status" value="')
     44      _tmp = r_status
     45      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     46      else: _tmp = _utf8(str(_tmp))
     47      _tmp = _utf8(xhtml_escape(_tmp))
     48      _append(_tmp)
     49      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover">\n<thead>\n')
     50      _append('<tr>\n<th></th>\n<th class="nickname">\xe6\x98\xb5\xe7\xa7\xb0</th>\n<th class="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</th>\n<th class="content">\xe5\x86\x85\xe5\xae\xb9</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     51      _append('\n</thead>\n<tbody>\n')
     52      if type(query) == list:
     53          _append('\n')
     54          for q in query:
     55              _append('\n')
     56              _append('<tr>\n<td><input type="checkbox" data-id="')
     57              _tmp = q.get('id',0)
     58              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     59              else: _tmp = _utf8(str(_tmp))
     60              _tmp = _utf8(xhtml_escape(_tmp))
     61              _append(_tmp)
     62              _append('"/></td>\n<td class="nickname">')
     63              _tmp = q.get('name', '')
     64              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     65              else: _tmp = _utf8(str(_tmp))
     66              _tmp = _utf8(xhtml_escape(_tmp))
     67              _append(_tmp)
     68              _append('</td>\n<td class="email">')
     69              _tmp = q.get('email', '')
     70              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     71              else: _tmp = _utf8(str(_tmp))
     72              _tmp = _utf8(xhtml_escape(_tmp))
     73              _append(_tmp)
     74              _append('</td>\n<td class="content">')
     75              _tmp = q.get('contain', '')
     76              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     77              else: _tmp = _utf8(str(_tmp))
     78              _tmp = _utf8(xhtml_escape(_tmp))
     79              _append(_tmp)
     80              _append('</td>\n<td class="status">\n')
     81              status = int(q.get('status', 0))
     82              _append('\n')
     83              if status == 1:
     84                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
     85              elif status == 2:
     86                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
     87              elif status == 3:
     88                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
     89              _append('\n</td>\n<td class="time">')
     90              _tmp = q.get('time', '')
     91              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     92              else: _tmp = _utf8(str(_tmp))
     93              _tmp = _utf8(xhtml_escape(_tmp))
     94              _append(_tmp)
     95              _append('</td>\n</tr>')
     96              _append('\n')
     97          _append('\n')
     98      _append('\n</tbody>\n</table>\n')
     99      url = '/comment/comment/list?category=%s&status=%s' %(category, r_status)
    100      _append('\n')
    101      if contain:
    102          _append('\n')
    103          url = url + '&contain=%s' %(contain)
    104          _append('\n')
    105      _append('\n')
    106      url = url + "&page_num=%s"
    107      _append('\n')
    108      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    109      _tmp = ans.get('total_num', 0)
    110      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    111      else: _tmp = _utf8(str(_tmp))
    112      _tmp = _utf8(xhtml_escape(_tmp))
    113      _append(_tmp)
    114      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    115      current = ans.get('page_num', 1)
    116      _append('\n')
    117      total = ans.get('page_total', 1)
    118      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    119      if current != 1:
    120          _append('<li><a href="')
    121          _tmp = url %(current-1)
    122          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    123          else: _tmp = _utf8(str(_tmp))
    124          _tmp = _utf8(xhtml_escape(_tmp))
    125          _append(_tmp)
    126          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    127      _append('\n')
    128      if current-3 > 1:
    129          _append('<li><a href="')
    130          _tmp = url %(1)
    131          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    132          else: _tmp = _utf8(str(_tmp))
    133          _tmp = _utf8(xhtml_escape(_tmp))
    134          _append(_tmp)
    135          _append('">1</a></li>')
    136      _append('\n')
    137      if current-3 > 2:
    138          _append('<li><...</li>')
    139      _append('\n')
    140      for i in [i for i in range(current-3,current) if i > 0]:
    141          _append('\n<li><a href="')
    142          _tmp = url %(i)
    143          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    144          else: _tmp = _utf8(str(_tmp))
    145          _tmp = _utf8(xhtml_escape(_tmp))
    146          _append(_tmp)
    147          _append('">')
    148          _tmp = i
    149          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    150          else: _tmp = _utf8(str(_tmp))
    151          _tmp = _utf8(xhtml_escape(_tmp))
    152          _append(_tmp)
    153          _append('</a></li>\n')
    154      _append('\n<li class="active"><a href="javascript:;">')
    155      _tmp = current
    156      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    157      else: _tmp = _utf8(str(_tmp))
    158      _tmp = _utf8(xhtml_escape(_tmp))
    159      _append(_tmp)
    160      _append('</a></li>\n')
    161      for i in [i for i in range(current+1,current+4) if i <= total ]:
    162          _append('\n<li><a href="')
    163          _tmp = url %(i)
    164          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    165          else: _tmp = _utf8(str(_tmp))
    166          _tmp = _utf8(xhtml_escape(_tmp))
    167          _append(_tmp)
    168          _append('">')
    169          _tmp = i
    170          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    171          else: _tmp = _utf8(str(_tmp))
    172          _tmp = _utf8(xhtml_escape(_tmp))
    173          _append(_tmp)
    174          _append('</a></li>\n')
    175      _append('\n')
    176      if current+3 < total:
    177          _append(' <li>...</li>')
    178      _append('\n')
    179      if current < total:
    180          _append(' <li><a href="')
    181          _tmp = url %(current+1)
    182          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    183          else: _tmp = _utf8(str(_tmp))
    184          _tmp = _utf8(xhtml_escape(_tmp))
    185          _append(_tmp)
    186          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    187      _append('\n</ul>\n</div>\n</div>\n</div>')
    188      _append('\n</div>\n</div>\n</div>\n</div>\n')
    189      _append('<form role="form" method="post" action="/comment/comment/add" >\n<input type="hidden" name="q" value="csrf_123ABCDF"/>\n<input type="hidden" name="category" value="')
    190      _tmp = vategory
    191      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    192      else: _tmp = _utf8(str(_tmp))
    193      _tmp = _utf8(xhtml_escape(_tmp))
    194      _append(_tmp)
    195      _append('"/>\n<input type="hidden" name="_id" value="')
    196      _tmp = ans.get('_id', 0)
    197      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    198      else: _tmp = _utf8(str(_tmp))
    199      _tmp = _utf8(xhtml_escape(_tmp))
    200      _append(_tmp)
    201      _append('"/>\n<div class="box-body">\n<div class="form-group">\n<label for="name">\xe6\x98\xb5\xe7\xa7\xb0</label>\n<input name="name" type="text" class="form-control" id="name" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</label>\n<input name="email" type="email" class="form-control" id="email" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="contain">\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9</label>\n<input name="contain" type="text" class="form-control" id="contain" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9">\n</div>\n</div>\n<div class="box-footer">\n<button type="submit" class="btn btn-primary">\xe6\x8f\x90\xe4\xba\xa4\xe8\xaf\x84\xe8\xae\xba</button>\n</div>\n</form>')
    202      _append('\n')
    203      _append('\n</section>\n</div>\n')
    204      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    205      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    206      _append('\n<script>\n$(function () {\n$(".inormal").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 1;\najax_status(ids, status);\n});\n$(".iremove").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".ihidden").click(function(){\nvar ids = icheck_function($(".table"));\nvar status = 3;\najax_status(ids, status);\n});\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n})\nreturn false;\n};\n});\n</script>\n')
    207      _append('\n</body>\n</html>\n')
    208      return _utf8('').join(_buffer)
[E 150422 14:09:01 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cache-Control': 'max-age=0', 'If-None-Match': '"27458565a61fa01ed10b2eae97ff21d86d8946ec"', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template comment.html>", line 190, in _execute
    NameError: global name 'vategory' is not defined
[E 150422 14:09:01 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 28.30ms
[E 150422 14:33:59 comment.py:add:51] global name 'tile' is not defined
[E 150422 14:33:59 dm.py:start:61] Uncaught exception POST /comment/comment/add (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/comment/comment/add', version='HTTP/1.1', remote_ip='127.0.0.1', body='q=csrf_123ABCDF&category=movie&_id=1&name=jwfy&email=jwfy0902%40foxmail.com&contain=', headers={'Content-Length': '84', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Content-Type': 'application/x-www-form-urlencoded'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 53, in add
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: NameError("global name 'tile' is not defined",) is not JSON serializable
[E 150422 14:33:59 dm.py:start:61] 500 POST /comment/comment/add (127.0.0.1) 7.17ms
[E 150422 16:18:54 comment.py:add:45] global name 'tile' is not defined
[E 150422 16:18:54 dm.py:start:61] Uncaught exception POST /comment/comment/add (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/comment/comment/add', version='HTTP/1.1', remote_ip='127.0.0.1', body='iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=fdgdfg', headers={'Content-Length': '92', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Content-Type': 'application/x-www-form-urlencoded'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 45, in add
        r, desc = comment_ctrl.add(name=name, email=email, title=title,
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: NameError("global name 'tile' is not defined",) is not JSON serializable
[E 150422 16:18:54 dm.py:start:61] 500 POST /comment/comment/add (127.0.0.1) 82424.00ms
[E 150422 16:19:06 comment.py:add:42] global name 'comment' is not defined
[E 150422 16:19:06 dm.py:start:61] Uncaught exception GET /comment/comment/add (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Connection': 'keep-alive', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 42, in add
        ip = self._remote_ip()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: NameError("global name 'comment' is not defined",) is not JSON serializable
[E 150422 16:19:06 dm.py:start:61] 500 GET /comment/comment/add (127.0.0.1) 8898.58ms
[E 150422 16:20:45 comment.py:add:53] global name 'comment' is not defined
[E 150422 16:20:45 dm.py:start:61] Uncaught exception POST /comment/comment/add (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='POST', uri='/comment/comment/add', version='HTTP/1.1', remote_ip='127.0.0.1', body='iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=fdgdfg', headers={'Content-Length': '92', 'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0', 'Content-Type': 'application/x-www-form-urlencoded'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 567, in post
        r = self.process_debug('Post', args)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 55, in add
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: NameError("global name 'comment' is not defined",) is not JSON serializable
[E 150422 16:20:45 dm.py:start:61] 500 POST /comment/comment/add (127.0.0.1) 87736.16ms
[E 150422 17:10:39 dm.py:start:61] Uncaught exception GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%B3%95%E5%9B%BD%E5%92%8C%E6%B3%95%E5%9B%BD%E5%92%8C55666767657 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%B3%95%E5%9B%BD%E5%92%8C%E6%B3%95%E5%9B%BD%E5%92%8C55666767657', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 55, in add
        query["email"] = desc.email
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: <SpuDBObject> is not JSON serializable
[E 150422 17:10:39 dm.py:start:61] 500 GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%B3%95%E5%9B%BD%E5%92%8C%E6%B3%95%E5%9B%BD%E5%92%8C55666767657 (127.0.0.1) 212059.09ms
[E 150422 17:25:25 dm.py:start:61] Uncaught exception GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 65, in add
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: <SpuDBObject> is not JSON serializable
[E 150422 17:25:25 dm.py:start:61] 500 GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA (127.0.0.1) 179.34ms
[E 150422 17:25:54 dm.py:start:61] Uncaught exception GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 65, in add
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: datetime.datetime(2015, 4, 22, 17, 25, 53, 815821) is not JSON serializable
[E 150422 17:25:54 dm.py:start:61] 500 GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA (127.0.0.1) 200.79ms
[E 150422 17:28:11 comment.py:add:63] strptime() takes exactly 2 arguments (1 given)
[E 150422 17:28:11 dm.py:start:61] Uncaught exception GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 65, in add
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: TypeError('strptime() takes exactly 2 arguments (1 given)',) is not JSON serializable
[E 150422 17:28:11 dm.py:start:61] 500 GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA (127.0.0.1) 188.08ms
[E 150422 17:29:37 comment.py:add:63] expected string or buffer
[E 150422 17:29:37 dm.py:start:61] Uncaught exception GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 65, in add
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: TypeError('expected string or buffer',) is not JSON serializable
[E 150422 17:29:37 dm.py:start:61] 500 GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA (127.0.0.1) 164.57ms
[E 150422 17:32:38 comment.py:add:63] expected string or buffer
[E 150422 17:32:38 dm.py:start:61] Uncaught exception GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA456 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA456', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 65, in add
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: TypeError('expected string or buffer',) is not JSON serializable
[E 150422 17:32:38 dm.py:start:61] 500 GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E7%AC%AC%E4%B8%80%E6%9D%A1ajax%E8%AF%84%E8%AE%BA456 (127.0.0.1) 183.36ms
[E 150422 17:39:22 comment.py:add:65] expected string or buffer
[E 150422 17:39:31 dm.py:start:61] Uncaught exception GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 67, in add
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: TypeError('expected string or buffer',) is not JSON serializable
[E 150422 17:39:31 dm.py:start:61] 500 GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B (127.0.0.1) 150726.16ms
[E 150422 17:40:45 comment.py:add:55] expected string or buffer
[E 150422 17:40:45 dm.py:start:61] Uncaught exception GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 55, in add
        query["time"] = time.strptime("%Y-%m-%d %HH:%M:%S", desc.time)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: TypeError('expected string or buffer',) is not JSON serializable
[E 150422 17:40:45 dm.py:start:61] 500 GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B (127.0.0.1) 72282.20ms
[E 150422 17:43:29 comment.py:add:55] expected string or buffer
[E 150422 17:43:29 dm.py:start:61] Uncaught exception GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 55, in add
        query["time"] = desc.time.strftime("%Y-%m-%d %H:%M:%S")
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: TypeError('expected string or buffer',) is not JSON serializable
[E 150422 17:43:29 dm.py:start:61] 500 GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B (127.0.0.1) 98937.79ms
[E 150422 17:44:00 dm.py:start:61] Uncaught exception GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/comment.py", line 67, in add
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: <built-in function id> is not JSON serializable
[E 150422 17:44:00 dm.py:start:61] 500 GET /comment/comment/add?iq=csrf_123ABCDF&icategory=movie&_id=3&name=jwfy&email=jwfy0902%40foxmail.com&contain=%E6%88%91%E5%86%8D%E5%9B%9E%E5%A4%8D%E4%B8%80%E4%B8%8B (127.0.0.1) 27427.13ms
[E 150422 18:19:52 comment_ctrl.py:update_status:37] Error Info And Frames: [ErrorSql]Sql: (select * from comment where comment.id in (29/)) Exception: ((1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1"))
    	SpuLogging.py:432:error_dump_frame
    	SpuDB.py:296:print_error_sql
    	SpuDB.py:304:query
    	SpuDBObject.py:168:db_query
    	SpuDBObject.py:2161:_find
    	SpuDBObject.py:2194:find
    	comment_ctrl.py:37:update_status
    	comment.py:127:update_status
    	base.py:58:f
    	SpuUOM.py:187:caller
    	SpuRequest.py:261:process_debug
    	SpuRequest.py:544:get
    	SpuRequest.py:44:request_process
    	web.py:954:_execute
    	web.py:1328:__call__
    	httpserver.py:248:_on_headers
    	iostream.py:301:wrapper
    	ioloop.py:396:_run_callback
    	ioloop.py:253:start
    	dm.py:61:start
    	dm.py:83:main
    	dm.py:89:<module>
    
[E 150422 18:19:52 comment.py:update_status:127] (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1")
[E 150422 18:19:52 dm.py:start:61] Uncaught exception GET /comment/comment/update_status?ids=%5B%2229%2F%22%5D&status=3 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status?ids=%5B%2229%2F%22%5D&status=3', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 127, in update_status
        try:
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: ProgrammingError(1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1") is not JSON serializable
[E 150422 18:19:52 dm.py:start:61] 500 GET /comment/comment/update_status?ids=%5B%2229%2F%22%5D&status=3 (127.0.0.1) 24638.20ms
[E 150422 19:03:27 comment_ctrl.py:update_status:37] Error Info And Frames: [ErrorSql]Sql: (select * from comment where comment.id in (31/, 30)) Exception: ((1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' 30)' at line 1"))
    	SpuLogging.py:432:error_dump_frame
    	SpuDB.py:296:print_error_sql
    	SpuDB.py:304:query
    	SpuDBObject.py:168:db_query
    	SpuDBObject.py:2161:_find
    	SpuDBObject.py:2194:find
    	comment_ctrl.py:37:update_status
    	comment.py:126:update_status
    	base.py:58:f
    	SpuUOM.py:187:caller
    	SpuRequest.py:261:process_debug
    	SpuRequest.py:544:get
    	SpuRequest.py:44:request_process
    	web.py:954:_execute
    	web.py:1328:__call__
    	httpserver.py:248:_on_headers
    	iostream.py:301:wrapper
    	ioloop.py:396:_run_callback
    	ioloop.py:253:start
    	dm.py:61:start
    	dm.py:83:main
    	dm.py:89:<module>
    
[E 150422 19:03:27 comment.py:update_status:133] (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' 30)' at line 1")
[E 150422 19:03:27 dm.py:start:61] Uncaught exception GET /comment/comment/update_status?ids=%5B%2231%2F%22%2C30%5D&status=3 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status?ids=%5B%2231%2F%22%2C30%5D&status=3', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 135, in update_status
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: ProgrammingError(1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' 30)' at line 1") is not JSON serializable
[E 150422 19:03:27 dm.py:start:61] 500 GET /comment/comment/update_status?ids=%5B%2231%2F%22%2C30%5D&status=3 (127.0.0.1) 14.00ms
[E 150422 21:29:37 dm.py:start:61] comment/add.html code:
     1  def _execute():
     2      _buffer = []
     3      _append = _buffer.append
     4      _append('<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba</h3>\n<button type="button" class="comment-close close" data-dismiss="alert" aria-hidden="true" title="\xe5\x85\xb3\xe9\x97\xad">\xc3\x97</button>\n</div>\n<form role="form" method="post" action="/comment/comment/add" class="comment-form">\n<div class="box-body">\n<input type="hidden" name="iq" value="csrf_123ABCDF"/>\n<input type="hidden" name="icategory" value="')
     5      _tmp = category
     6      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     7      else: _tmp = _utf8(str(_tmp))
     8      _tmp = _utf8(xhtml_escape(_tmp))
     9      _append(_tmp)
    10      _append('"/>\n<input type="hidden" id="i_id" name="_id" value="')
    11      _tmp = ans.get('_id', 0)
    12      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    13      else: _tmp = _utf8(str(_tmp))
    14      _tmp = _utf8(xhtml_escape(_tmp))
    15      _append(_tmp)
    16      _append('"/>\n<input type="hidden" name="ititle" value="')
    17      _tmp = ans.get('title'
    18      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    19      else: _tmp = _utf8(str(_tmp))
    20      _tmp = _utf8(xhtml_escape(_tmp))
    21      _append(_tmp)
    22      _append('"/>\n<div class="form-group">\n<label for="iname">\xe6\x98\xb5\xe7\xa7\xb0</label>\n<input name="name" type="text" class="form-control" id="iname" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe6\x98\xb5\xe7\xa7\xb0">\n</div>\n<div class="form-group">\n<label for="iemail">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</label>\n<input name="email" type="email" class="form-control" id="iemail" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="icontain">\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9</label>\n<textarea name="contain" type="text" class="form-control" id="icontain" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9"></textarea>\n</div>\n')
    23      if ans.get('len',-1) == -1:
    24          _append('\n<div class="form-group">\n<label for="icaptcha">\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81</label>\n<input name="captcha" type="text" class="form-control" id="icaptcha" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81">\n<img src="#" title="\xe7\x82\xb9\xe5\x87\xbb\xe5\x88\xb7\xe6\x96\xb0\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81" class="captcha-image"/>\n</div>\n')
    25      _append('\n</div>\n<div class="box-footer">\n<button type="submit" class="btn btn-primary comment-add">\xe6\x8f\x90\xe4\xba\xa4\xe8\xaf\x84\xe8\xae\xba</button>\n</div>\n</form>\n</div>')
    26      return _utf8('').join(_buffer)
[E 150422 21:29:37 dm.py:start:61] Uncaught exception GET /comment/comment/list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cache-Control': 'max-age=0', 'If-None-Match': '"3d36c4e555bc63654ed81904e0be47678f7385d8"', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 545, in render_string
        t = RequestHandler._templates[template_path].load(template_name)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 298, in load
        self.templates[name] = self._create_template(name)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 329, in _create_template
        template = Template(f.read(), name=name, loader=self)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 208, in __init__
        self.code = self._generate_python(loader, compress_whitespace)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 250, in _generate_python
        ancestor.find_named_blocks(loader, named_blocks)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 361, in find_named_blocks
        child.find_named_blocks(loader, named_blocks)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 361, in find_named_blocks
        child.find_named_blocks(loader, named_blocks)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 411, in find_named_blocks
        _Node.find_named_blocks(self, loader, named_blocks)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 361, in find_named_blocks
        child.find_named_blocks(loader, named_blocks)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 361, in find_named_blocks
        child.find_named_blocks(loader, named_blocks)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 425, in find_named_blocks
        included = loader.load(self.name, self.template_name)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 298, in load
        self.templates[name] = self._create_template(name)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 329, in _create_template
        template = Template(f.read(), name=name, loader=self)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 212, in __init__
        "exec")
      File "<template comment/add.html>", line 18
        if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
                                          ^
    SyntaxError: invalid syntax
[E 150422 21:29:37 dm.py:start:61] 500 GET /comment/comment/list (127.0.0.1) 49.07ms
[E 150422 21:52:02 comment.py:list:110] local variable 'cond1' referenced before assignment
[E 150422 21:52:02 comment.py:list:110] local variable 'cond1' referenced before assignment
[E 150422 21:52:08 comment.py:list:110] local variable 'cond1' referenced before assignment
[E 150422 21:52:08 comment.py:list:110] local variable 'cond1' referenced before assignment
[E 150422 21:52:12 comment.py:list:110] local variable 'cond1' referenced before assignment
[E 150422 21:52:12 comment.py:list:110] local variable 'cond1' referenced before assignment
[E 150422 21:52:14 comment.py:list:110] local variable 'cond1' referenced before assignment
[E 150422 21:52:14 comment.py:list:110] local variable 'cond1' referenced before assignment
[E 150422 21:52:16 comment.py:list:110] local variable 'cond1' referenced before assignment
[E 150422 21:52:16 comment.py:list:110] local variable 'cond1' referenced before assignment
[E 150422 22:09:24 comment_ctrl.py:update_status:37] Error Info And Frames: [ErrorSql]Sql: (select * from comment where comment.id in ()) Exception: ((1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1"))
    	SpuLogging.py:432:error_dump_frame
    	SpuDB.py:296:print_error_sql
    	SpuDB.py:304:query
    	SpuDBObject.py:168:db_query
    	SpuDBObject.py:2161:_find
    	SpuDBObject.py:2194:find
    	comment_ctrl.py:37:update_status
    	comment.py:125:update_status
    	base.py:58:f
    	SpuUOM.py:187:caller
    	SpuRequest.py:261:process_debug
    	SpuRequest.py:544:get
    	SpuRequest.py:44:request_process
    	web.py:954:_execute
    	web.py:1328:__call__
    	httpserver.py:248:_on_headers
    	iostream.py:301:wrapper
    	ioloop.py:396:_run_callback
    	ioloop.py:253:start
    	dm.py:61:start
    	dm.py:83:main
    	dm.py:89:<module>
    
[E 150422 22:09:24 comment.py:update_status:132] (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1")
[E 150422 22:09:24 dm.py:start:61] Uncaught exception GET /comment/comment/update_status?ids=%5B%5D&status=1 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status?ids=%5B%5D&status=1', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-cn,en-us;q=0.7,en;q=0.3', 'Accept-Encoding': 'gzip, deflate', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0', 'Connection': 'keep-alive', 'X-Requested-With': 'XMLHttpRequest', 'Referer': 'http://127.0.0.1:8910/comment/comment/list', 'Cookie': 'sessionid=000041925478895fd534e12ce7d291d295327e; jwfy_dm_website_session=5730f47e5653cbea5213f9c6febda5c0'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 134, in update_status
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: ProgrammingError(1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1") is not JSON serializable
[E 150422 22:09:24 dm.py:start:61] 500 GET /comment/comment/update_status?ids=%5B%5D&status=1 (127.0.0.1) 29.30ms
[E 150423 14:23:13 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:23:13 dm.py:start:61] removie.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<section class="sidebar">\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li class="')
     11      _append('">\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview ')
     12      _append('">\n<a href="javascript:;">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     13      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li class="')
     14      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li class="')
     15      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview ')
     16      _append('active')
     17      _append('">\n<a href="javascript:;">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     18      _append('active')
     19      _append('"><a href="/comment/comment/list?category=movie"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li class="')
     20      _append('"><a href="/comment/comment/list?category=blog"><i class="fa fa-circle-o"></i>\xe5\x8d\x9a\xe5\xae\xa2</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n</aside>')
     21      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     22      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5')
     23      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     24      _append('\n')
     25      ans = pyobject.get('result')
     26      _append('\n')
     27      query = ans.get('query')
     28      _append('\n')
     29      r_status = ans.get('r_status', 0)
     30      _append('\n')
     31      contain = ans.get('contain', '')
     32      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
     33      if contain:
     34          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     35          _tmp = contain
     36          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     37          else: _tmp = _utf8(str(_tmp))
     38          _tmp = _utf8(xhtml_escape(_tmp))
     39          _append(_tmp)
     40      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm ihidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm iremove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm inormal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n<!--\n<button class="btn btn-default btn-sm iadd" title="\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba"><i class="fa fa-plus"></i></button>\n-->\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="category" value="')
     41      _tmp = category
     42      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     43      else: _tmp = _utf8(str(_tmp))
     44      _tmp = _utf8(xhtml_escape(_tmp))
     45      _append(_tmp)
     46      _append('" />\n<input type="hidden" name="status" value="')
     47      _tmp = r_status
     48      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     49      else: _tmp = _utf8(str(_tmp))
     50      _tmp = _utf8(xhtml_escape(_tmp))
     51      _append(_tmp)
     52      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover comment-table">\n<thead>\n')
     53      _append('<tr>\n<th></th>\n<th class="image">\xe5\x9b\xbe\xe7\x89\x87</th>\n<th class="title">\xe6\xa0\x87\xe9\xa2\x98</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe5\x88\x9b\xe5\xbb\xba\xe6\x97\xb6\xe9\x97\xb4</th>\n<th class="update_time">\xe6\x9b\xb4\xe6\x96\xb0\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     54      _append('\n</thead>\n<tbody>\n')
     55      if type(query) == list:
     56          _append('\n')
     57          for q in query:
     58              _append('\n')
     59              _append('<tr>\n<td><input type="checkbox" data-id="')
     60              _tmp = q.get('id',0)
     61              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     62              else: _tmp = _utf8(str(_tmp))
     63              _tmp = _utf8(xhtml_escape(_tmp))
     64              _append(_tmp)
     65              _append('"></td>\n<td class="nickname" data-_id="')
     66              _tmp = q.get('_id', 0)
     67              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     68              else: _tmp = _utf8(str(_tmp))
     69              _tmp = _utf8(xhtml_escape(_tmp))
     70              _append(_tmp)
     71              _append('" data-title="')
     72              _tmp = q.get('title', '')
     73              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     74              else: _tmp = _utf8(str(_tmp))
     75              _tmp = _utf8(xhtml_escape(_tmp))
     76              _append(_tmp)
     77              _append('" >')
     78              _tmp = q.get('name', '')
     79              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     80              else: _tmp = _utf8(str(_tmp))
     81              _tmp = _utf8(xhtml_escape(_tmp))
     82              _append(_tmp)
     83              _append('</td>\n<td class="email">')
     84              _tmp = q.get('email', '')
     85              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     86              else: _tmp = _utf8(str(_tmp))
     87              _tmp = _utf8(xhtml_escape(_tmp))
     88              _append(_tmp)
     89              _append('</td>\n<td class="title">')
     90              _tmp = q.get('title', '')
     91              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     92              else: _tmp = _utf8(str(_tmp))
     93              _tmp = _utf8(xhtml_escape(_tmp))
     94              _append(_tmp)
     95              _append('</td>\n<td class="content">')
     96              _tmp = q.get('contain', '')
     97              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     98              else: _tmp = _utf8(str(_tmp))
     99              _tmp = _utf8(xhtml_escape(_tmp))
    100              _append(_tmp)
    101              _append('</td>\n<td class="status">\n')
    102              status = int(q.get('status', 0))
    103              _append('\n')
    104              if status == 1:
    105                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
    106              elif status == 2:
    107                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
    108              elif status == 3:
    109                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
    110              _append('\n</td>\n<td class="time">')
    111              _tmp = q.get('time', '')
    112              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    113              else: _tmp = _utf8(str(_tmp))
    114              _tmp = _utf8(xhtml_escape(_tmp))
    115              _append(_tmp)
    116              _append('</td>\n</tr>')
    117              _append('\n')
    118          _append('\n')
    119      _append('\n</tbody>\n</table>\n')
    120      url = '/comment/comment/list?category=%s&status=%s' %(category, r_status)
    121      _append('\n')
    122      if contain:
    123          _append('\n')
    124          url = url + '&contain=%s' %(contain)
    125          _append('\n')
    126      _append('\n')
    127      url = url + "&page_num=%s"
    128      _append('\n')
    129      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    130      _tmp = ans.get('total_num', 0)
    131      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    132      else: _tmp = _utf8(str(_tmp))
    133      _tmp = _utf8(xhtml_escape(_tmp))
    134      _append(_tmp)
    135      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    136      current = ans.get('page_num', 1)
    137      _append('\n')
    138      total = ans.get('page_total', 1)
    139      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    140      if current != 1:
    141          _append('<li><a href="')
    142          _tmp = url %(current-1)
    143          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    144          else: _tmp = _utf8(str(_tmp))
    145          _tmp = _utf8(xhtml_escape(_tmp))
    146          _append(_tmp)
    147          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    148      _append('\n')
    149      if current-3 > 1:
    150          _append('<li><a href="')
    151          _tmp = url %(1)
    152          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    153          else: _tmp = _utf8(str(_tmp))
    154          _tmp = _utf8(xhtml_escape(_tmp))
    155          _append(_tmp)
    156          _append('">1</a></li>')
    157      _append('\n')
    158      if current-3 > 2:
    159          _append('<li><...</li>')
    160      _append('\n')
    161      for i in [i for i in range(current-3,current) if i > 0]:
    162          _append('\n<li><a href="')
    163          _tmp = url %(i)
    164          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    165          else: _tmp = _utf8(str(_tmp))
    166          _tmp = _utf8(xhtml_escape(_tmp))
    167          _append(_tmp)
    168          _append('">')
    169          _tmp = i
    170          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    171          else: _tmp = _utf8(str(_tmp))
    172          _tmp = _utf8(xhtml_escape(_tmp))
    173          _append(_tmp)
    174          _append('</a></li>\n')
    175      _append('\n<li class="active"><a href="javascript:;">')
    176      _tmp = current
    177      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    178      else: _tmp = _utf8(str(_tmp))
    179      _tmp = _utf8(xhtml_escape(_tmp))
    180      _append(_tmp)
    181      _append('</a></li>\n')
    182      for i in [i for i in range(current+1,current+4) if i <= total ]:
    183          _append('\n<li><a href="')
    184          _tmp = url %(i)
    185          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    186          else: _tmp = _utf8(str(_tmp))
    187          _tmp = _utf8(xhtml_escape(_tmp))
    188          _append(_tmp)
    189          _append('">')
    190          _tmp = i
    191          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    192          else: _tmp = _utf8(str(_tmp))
    193          _tmp = _utf8(xhtml_escape(_tmp))
    194          _append(_tmp)
    195          _append('</a></li>\n')
    196      _append('\n')
    197      if current+3 < total:
    198          _append(' <li>...</li>')
    199      _append('\n')
    200      if current < total:
    201          _append(' <li><a href="')
    202          _tmp = url %(current+1)
    203          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    204          else: _tmp = _utf8(str(_tmp))
    205          _tmp = _utf8(xhtml_escape(_tmp))
    206          _append(_tmp)
    207          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    208      _append('\n</ul>\n</div>\n</div>\n</div>')
    209      _append('\n</div>\n</div>\n</div>\n<div class="col-md-6 comment-box hidden">\n')
    210      _append('<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba</h3>\n<button type="button" class="comment-close close" data-dismiss="alert" aria-hidden="true" title="\xe5\x85\xb3\xe9\x97\xad">\xc3\x97</button>\n</div>\n<form role="form" method="post" action="/comment/comment/add" class="comment-form">\n<div class="box-body">\n<input type="hidden" name="q" value="csrf_123ABCDF"/>\n<input type="hidden" name="category" value="')
    211      _tmp = category
    212      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    213      else: _tmp = _utf8(str(_tmp))
    214      _tmp = _utf8(xhtml_escape(_tmp))
    215      _append(_tmp)
    216      _append('"/>\n<input type="hidden" name="_id" value="')
    217      _tmp = ans.get('_id', 0)
    218      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    219      else: _tmp = _utf8(str(_tmp))
    220      _tmp = _utf8(xhtml_escape(_tmp))
    221      _append(_tmp)
    222      _append('"/>\n<input type="hidden" name="title" value="')
    223      _tmp = ans.get('title', '')
    224      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    225      else: _tmp = _utf8(str(_tmp))
    226      _tmp = _utf8(xhtml_escape(_tmp))
    227      _append(_tmp)
    228      _append('"/>\n<div class="form-group">\n<label for="name">\xe6\x98\xb5\xe7\xa7\xb0</label>\n<input name="name" type="text" class="form-control" id="name" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe6\x98\xb5\xe7\xa7\xb0">\n</div>\n<div class="form-group">\n<label for="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</label>\n<input name="email" type="email" class="form-control" id="email" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="contain">\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9</label>\n<textarea name="contain" type="text" class="form-control" id="contain" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9"></textarea>\n</div>\n')
    229      if ans.get('len',-1) == -1:
    230          _append('\n<div class="form-group">\n<label for="captcha">\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81</label>\n<input name="captcha" type="text" class="form-control" id="captcha" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81">\n<img src="#" title="\xe7\x82\xb9\xe5\x87\xbb\xe5\x88\xb7\xe6\x96\xb0\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81" class="captcha-image"/>\n</div>\n')
    231      _append('\n</div>\n<div class="box-footer">\n<button type="submit" class="btn btn-primary comment-add">\xe6\x8f\x90\xe4\xba\xa4\xe8\xaf\x84\xe8\xae\xba</button>\n</div>\n</form>\n</div>')
    232      _append('\n</div>\n</div>\n')
    233      _append('\n</section>\n</div>\n')
    234      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    235      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    236      _append('\n<script>\n$(function () {\n$(".inormal").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 1;\najax_status(ids, status);\n});\n$(".iremove").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".ihidden").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 3;\najax_status(ids, status);\n});\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n});\nreturn false;\n}\n/*\n$(".iadd").click(function(){\n$(".comment-box").removeClass("hidden");\n})\n*/\n$(".nickname").click(function(){\nvar id = $(this).data("_id");\nvar title = $(this).data("title");\n//console.log(id);\n$(".comment-box").removeClass("hidden");\nvar _this = $(".comment-form", ".comment-box");\n$(_this).find("input[name=\'_id\']").val(id);\n$(_this).find("input[name=\'title\']").val(title);\n$(_this).find("input[name=\'name\']").val("jwfy");\n$(_this).find("input[name=\'email\']").val("jwfy0902@foxmail.com");\n});\n$(".comment-close").click(function(){\n$(".comment-box").addClass("hidden");\n})\n});\n</script>\n')
    237      _append('\n</body>\n</html>\n')
    238      return _utf8('').join(_buffer)
[E 150423 14:23:13 dm.py:start:61] Uncaught exception GET /movie/movie/re_list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/re_list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate, sdch', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041982a735d10150ff78b9e6147b617e3ea; jwfy_dm_website_session=e0ac85d060fa9a8e46d15b58a73ce2a7', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template removie.html>", line 41, in _execute
    NameError: global name 'category' is not defined
[E 150423 14:23:13 dm.py:start:61] 500 GET /movie/movie/re_list (127.0.0.1) 118.32ms
[E 150423 14:24:06 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:24:06 dm.py:start:61] removie.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<section class="sidebar">\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li class="')
     11      _append('">\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview ')
     12      _append('">\n<a href="javascript:;">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     13      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li class="')
     14      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li class="')
     15      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview ')
     16      _append('active')
     17      _append('">\n<a href="javascript:;">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     18      _append('active')
     19      _append('"><a href="/comment/comment/list?category=movie"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li class="')
     20      _append('"><a href="/comment/comment/list?category=blog"><i class="fa fa-circle-o"></i>\xe5\x8d\x9a\xe5\xae\xa2</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n</aside>')
     21      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     22      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5')
     23      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     24      _append('\n')
     25      ans = pyobject.get('result')
     26      _append('\n')
     27      query = ans.get('query')
     28      _append('\n')
     29      r_status = ans.get('r_status', 0)
     30      _append('\n')
     31      contain = ans.get('contain', '')
     32      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
     33      if contain:
     34          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     35          _tmp = contain
     36          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     37          else: _tmp = _utf8(str(_tmp))
     38          _tmp = _utf8(xhtml_escape(_tmp))
     39          _append(_tmp)
     40      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm ihidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm iremove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm inormal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n<!--\n<button class="btn btn-default btn-sm iadd" title="\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba"><i class="fa fa-plus"></i></button>\n-->\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="category" value="')
     41      _tmp = category
     42      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     43      else: _tmp = _utf8(str(_tmp))
     44      _tmp = _utf8(xhtml_escape(_tmp))
     45      _append(_tmp)
     46      _append('" />\n<input type="hidden" name="status" value="')
     47      _tmp = r_status
     48      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     49      else: _tmp = _utf8(str(_tmp))
     50      _tmp = _utf8(xhtml_escape(_tmp))
     51      _append(_tmp)
     52      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover comment-table">\n<thead>\n')
     53      _append('<tr>\n<th></th>\n<th class="image">\xe5\x9b\xbe\xe7\x89\x87</th>\n<th class="title">\xe6\xa0\x87\xe9\xa2\x98</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe5\x88\x9b\xe5\xbb\xba\xe6\x97\xb6\xe9\x97\xb4</th>\n<th class="update_time">\xe6\x9b\xb4\xe6\x96\xb0\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     54      _append('\n</thead>\n<tbody>\n')
     55      if type(query) == list:
     56          _append('\n')
     57          for q in query:
     58              _append('\n')
     59              _append('<tr>\n<td><input type="checkbox" data-id="')
     60              _tmp = q.get('id',0)
     61              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     62              else: _tmp = _utf8(str(_tmp))
     63              _tmp = _utf8(xhtml_escape(_tmp))
     64              _append(_tmp)
     65              _append('"></td>\n<td class="nickname" data-_id="')
     66              _tmp = q.get('_id', 0)
     67              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     68              else: _tmp = _utf8(str(_tmp))
     69              _tmp = _utf8(xhtml_escape(_tmp))
     70              _append(_tmp)
     71              _append('" data-title="')
     72              _tmp = q.get('title', '')
     73              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     74              else: _tmp = _utf8(str(_tmp))
     75              _tmp = _utf8(xhtml_escape(_tmp))
     76              _append(_tmp)
     77              _append('" >')
     78              _tmp = q.get('name', '')
     79              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     80              else: _tmp = _utf8(str(_tmp))
     81              _tmp = _utf8(xhtml_escape(_tmp))
     82              _append(_tmp)
     83              _append('</td>\n<td class="email">')
     84              _tmp = q.get('email', '')
     85              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     86              else: _tmp = _utf8(str(_tmp))
     87              _tmp = _utf8(xhtml_escape(_tmp))
     88              _append(_tmp)
     89              _append('</td>\n<td class="title">')
     90              _tmp = q.get('title', '')
     91              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     92              else: _tmp = _utf8(str(_tmp))
     93              _tmp = _utf8(xhtml_escape(_tmp))
     94              _append(_tmp)
     95              _append('</td>\n<td class="content">')
     96              _tmp = q.get('contain', '')
     97              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     98              else: _tmp = _utf8(str(_tmp))
     99              _tmp = _utf8(xhtml_escape(_tmp))
    100              _append(_tmp)
    101              _append('</td>\n<td class="status">\n')
    102              status = int(q.get('status', 0))
    103              _append('\n')
    104              if status == 1:
    105                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
    106              elif status == 2:
    107                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
    108              elif status == 3:
    109                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
    110              _append('\n</td>\n<td class="time">')
    111              _tmp = q.get('time', '')
    112              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    113              else: _tmp = _utf8(str(_tmp))
    114              _tmp = _utf8(xhtml_escape(_tmp))
    115              _append(_tmp)
    116              _append('</td>\n</tr>')
    117              _append('\n')
    118          _append('\n')
    119      _append('\n</tbody>\n</table>\n')
    120      url = '/comment/comment/list?&status=%s' %(r_status)
    121      _append('\n')
    122      if contain:
    123          _append('\n')
    124          url = url + '&contain=%s' %(contain)
    125          _append('\n')
    126      _append('\n')
    127      url = url + "&page_num=%s"
    128      _append('\n')
    129      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    130      _tmp = ans.get('total_num', 0)
    131      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    132      else: _tmp = _utf8(str(_tmp))
    133      _tmp = _utf8(xhtml_escape(_tmp))
    134      _append(_tmp)
    135      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    136      current = ans.get('page_num', 1)
    137      _append('\n')
    138      total = ans.get('page_total', 1)
    139      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    140      if current != 1:
    141          _append('<li><a href="')
    142          _tmp = url %(current-1)
    143          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    144          else: _tmp = _utf8(str(_tmp))
    145          _tmp = _utf8(xhtml_escape(_tmp))
    146          _append(_tmp)
    147          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    148      _append('\n')
    149      if current-3 > 1:
    150          _append('<li><a href="')
    151          _tmp = url %(1)
    152          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    153          else: _tmp = _utf8(str(_tmp))
    154          _tmp = _utf8(xhtml_escape(_tmp))
    155          _append(_tmp)
    156          _append('">1</a></li>')
    157      _append('\n')
    158      if current-3 > 2:
    159          _append('<li><...</li>')
    160      _append('\n')
    161      for i in [i for i in range(current-3,current) if i > 0]:
    162          _append('\n<li><a href="')
    163          _tmp = url %(i)
    164          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    165          else: _tmp = _utf8(str(_tmp))
    166          _tmp = _utf8(xhtml_escape(_tmp))
    167          _append(_tmp)
    168          _append('">')
    169          _tmp = i
    170          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    171          else: _tmp = _utf8(str(_tmp))
    172          _tmp = _utf8(xhtml_escape(_tmp))
    173          _append(_tmp)
    174          _append('</a></li>\n')
    175      _append('\n<li class="active"><a href="javascript:;">')
    176      _tmp = current
    177      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    178      else: _tmp = _utf8(str(_tmp))
    179      _tmp = _utf8(xhtml_escape(_tmp))
    180      _append(_tmp)
    181      _append('</a></li>\n')
    182      for i in [i for i in range(current+1,current+4) if i <= total ]:
    183          _append('\n<li><a href="')
    184          _tmp = url %(i)
    185          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    186          else: _tmp = _utf8(str(_tmp))
    187          _tmp = _utf8(xhtml_escape(_tmp))
    188          _append(_tmp)
    189          _append('">')
    190          _tmp = i
    191          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    192          else: _tmp = _utf8(str(_tmp))
    193          _tmp = _utf8(xhtml_escape(_tmp))
    194          _append(_tmp)
    195          _append('</a></li>\n')
    196      _append('\n')
    197      if current+3 < total:
    198          _append(' <li>...</li>')
    199      _append('\n')
    200      if current < total:
    201          _append(' <li><a href="')
    202          _tmp = url %(current+1)
    203          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    204          else: _tmp = _utf8(str(_tmp))
    205          _tmp = _utf8(xhtml_escape(_tmp))
    206          _append(_tmp)
    207          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    208      _append('\n</ul>\n</div>\n</div>\n</div>')
    209      _append('\n</div>\n</div>\n</div>\n<div class="col-md-6 comment-box hidden">\n')
    210      _append('<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba</h3>\n<button type="button" class="comment-close close" data-dismiss="alert" aria-hidden="true" title="\xe5\x85\xb3\xe9\x97\xad">\xc3\x97</button>\n</div>\n<form role="form" method="post" action="/comment/comment/add" class="comment-form">\n<div class="box-body">\n<input type="hidden" name="q" value="csrf_123ABCDF"/>\n<input type="hidden" name="category" value="')
    211      _tmp = category
    212      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    213      else: _tmp = _utf8(str(_tmp))
    214      _tmp = _utf8(xhtml_escape(_tmp))
    215      _append(_tmp)
    216      _append('"/>\n<input type="hidden" name="_id" value="')
    217      _tmp = ans.get('_id', 0)
    218      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    219      else: _tmp = _utf8(str(_tmp))
    220      _tmp = _utf8(xhtml_escape(_tmp))
    221      _append(_tmp)
    222      _append('"/>\n<input type="hidden" name="title" value="')
    223      _tmp = ans.get('title', '')
    224      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    225      else: _tmp = _utf8(str(_tmp))
    226      _tmp = _utf8(xhtml_escape(_tmp))
    227      _append(_tmp)
    228      _append('"/>\n<div class="form-group">\n<label for="name">\xe6\x98\xb5\xe7\xa7\xb0</label>\n<input name="name" type="text" class="form-control" id="name" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe6\x98\xb5\xe7\xa7\xb0">\n</div>\n<div class="form-group">\n<label for="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</label>\n<input name="email" type="email" class="form-control" id="email" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="contain">\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9</label>\n<textarea name="contain" type="text" class="form-control" id="contain" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9"></textarea>\n</div>\n')
    229      if ans.get('len',-1) == -1:
    230          _append('\n<div class="form-group">\n<label for="captcha">\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81</label>\n<input name="captcha" type="text" class="form-control" id="captcha" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81">\n<img src="#" title="\xe7\x82\xb9\xe5\x87\xbb\xe5\x88\xb7\xe6\x96\xb0\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81" class="captcha-image"/>\n</div>\n')
    231      _append('\n</div>\n<div class="box-footer">\n<button type="submit" class="btn btn-primary comment-add">\xe6\x8f\x90\xe4\xba\xa4\xe8\xaf\x84\xe8\xae\xba</button>\n</div>\n</form>\n</div>')
    232      _append('\n</div>\n</div>\n')
    233      _append('\n</section>\n</div>\n')
    234      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    235      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    236      _append('\n<script>\n$(function () {\n$(".inormal").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 1;\najax_status(ids, status);\n});\n$(".iremove").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".ihidden").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 3;\najax_status(ids, status);\n});\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n});\nreturn false;\n}\n/*\n$(".iadd").click(function(){\n$(".comment-box").removeClass("hidden");\n})\n*/\n$(".nickname").click(function(){\nvar id = $(this).data("_id");\nvar title = $(this).data("title");\n//console.log(id);\n$(".comment-box").removeClass("hidden");\nvar _this = $(".comment-form", ".comment-box");\n$(_this).find("input[name=\'_id\']").val(id);\n$(_this).find("input[name=\'title\']").val(title);\n$(_this).find("input[name=\'name\']").val("jwfy");\n$(_this).find("input[name=\'email\']").val("jwfy0902@foxmail.com");\n});\n$(".comment-close").click(function(){\n$(".comment-box").addClass("hidden");\n})\n});\n</script>\n')
    237      _append('\n</body>\n</html>\n')
    238      return _utf8('').join(_buffer)
[E 150423 14:24:06 dm.py:start:61] Uncaught exception GET /movie/movie/re_list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/re_list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate, sdch', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041982a735d10150ff78b9e6147b617e3ea; jwfy_dm_website_session=e0ac85d060fa9a8e46d15b58a73ce2a7', 'Cache-Control': 'max-age=0', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template removie.html>", line 41, in _execute
    NameError: global name 'category' is not defined
[E 150423 14:24:06 dm.py:start:61] 500 GET /movie/movie/re_list (127.0.0.1) 31.00ms
[E 150423 14:24:07 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:24:07 dm.py:start:61] removie.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<section class="sidebar">\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li class="')
     11      _append('">\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview ')
     12      _append('">\n<a href="javascript:;">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     13      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li class="')
     14      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li class="')
     15      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview ')
     16      _append('active')
     17      _append('">\n<a href="javascript:;">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     18      _append('active')
     19      _append('"><a href="/comment/comment/list?category=movie"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li class="')
     20      _append('"><a href="/comment/comment/list?category=blog"><i class="fa fa-circle-o"></i>\xe5\x8d\x9a\xe5\xae\xa2</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n</aside>')
     21      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     22      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5')
     23      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     24      _append('\n')
     25      ans = pyobject.get('result')
     26      _append('\n')
     27      query = ans.get('query')
     28      _append('\n')
     29      r_status = ans.get('r_status', 0)
     30      _append('\n')
     31      contain = ans.get('contain', '')
     32      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
     33      if contain:
     34          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     35          _tmp = contain
     36          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     37          else: _tmp = _utf8(str(_tmp))
     38          _tmp = _utf8(xhtml_escape(_tmp))
     39          _append(_tmp)
     40      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm ihidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm iremove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm inormal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n<!--\n<button class="btn btn-default btn-sm iadd" title="\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba"><i class="fa fa-plus"></i></button>\n-->\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="category" value="')
     41      _tmp = category
     42      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     43      else: _tmp = _utf8(str(_tmp))
     44      _tmp = _utf8(xhtml_escape(_tmp))
     45      _append(_tmp)
     46      _append('" />\n<input type="hidden" name="status" value="')
     47      _tmp = r_status
     48      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     49      else: _tmp = _utf8(str(_tmp))
     50      _tmp = _utf8(xhtml_escape(_tmp))
     51      _append(_tmp)
     52      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover comment-table">\n<thead>\n')
     53      _append('<tr>\n<th></th>\n<th class="image">\xe5\x9b\xbe\xe7\x89\x87</th>\n<th class="title">\xe6\xa0\x87\xe9\xa2\x98</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe5\x88\x9b\xe5\xbb\xba\xe6\x97\xb6\xe9\x97\xb4</th>\n<th class="update_time">\xe6\x9b\xb4\xe6\x96\xb0\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     54      _append('\n</thead>\n<tbody>\n')
     55      if type(query) == list:
     56          _append('\n')
     57          for q in query:
     58              _append('\n')
     59              _append('<tr>\n<td><input type="checkbox" data-id="')
     60              _tmp = q.get('id',0)
     61              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     62              else: _tmp = _utf8(str(_tmp))
     63              _tmp = _utf8(xhtml_escape(_tmp))
     64              _append(_tmp)
     65              _append('"></td>\n<td class="nickname" data-_id="')
     66              _tmp = q.get('_id', 0)
     67              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     68              else: _tmp = _utf8(str(_tmp))
     69              _tmp = _utf8(xhtml_escape(_tmp))
     70              _append(_tmp)
     71              _append('" data-title="')
     72              _tmp = q.get('title', '')
     73              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     74              else: _tmp = _utf8(str(_tmp))
     75              _tmp = _utf8(xhtml_escape(_tmp))
     76              _append(_tmp)
     77              _append('" >')
     78              _tmp = q.get('name', '')
     79              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     80              else: _tmp = _utf8(str(_tmp))
     81              _tmp = _utf8(xhtml_escape(_tmp))
     82              _append(_tmp)
     83              _append('</td>\n<td class="email">')
     84              _tmp = q.get('email', '')
     85              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     86              else: _tmp = _utf8(str(_tmp))
     87              _tmp = _utf8(xhtml_escape(_tmp))
     88              _append(_tmp)
     89              _append('</td>\n<td class="title">')
     90              _tmp = q.get('title', '')
     91              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     92              else: _tmp = _utf8(str(_tmp))
     93              _tmp = _utf8(xhtml_escape(_tmp))
     94              _append(_tmp)
     95              _append('</td>\n<td class="content">')
     96              _tmp = q.get('contain', '')
     97              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     98              else: _tmp = _utf8(str(_tmp))
     99              _tmp = _utf8(xhtml_escape(_tmp))
    100              _append(_tmp)
    101              _append('</td>\n<td class="status">\n')
    102              status = int(q.get('status', 0))
    103              _append('\n')
    104              if status == 1:
    105                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
    106              elif status == 2:
    107                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
    108              elif status == 3:
    109                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
    110              _append('\n</td>\n<td class="time">')
    111              _tmp = q.get('time', '')
    112              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    113              else: _tmp = _utf8(str(_tmp))
    114              _tmp = _utf8(xhtml_escape(_tmp))
    115              _append(_tmp)
    116              _append('</td>\n</tr>')
    117              _append('\n')
    118          _append('\n')
    119      _append('\n</tbody>\n</table>\n')
    120      url = '/comment/comment/list?&status=%s' %(r_status)
    121      _append('\n')
    122      if contain:
    123          _append('\n')
    124          url = url + '&contain=%s' %(contain)
    125          _append('\n')
    126      _append('\n')
    127      url = url + "&page_num=%s"
    128      _append('\n')
    129      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    130      _tmp = ans.get('total_num', 0)
    131      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    132      else: _tmp = _utf8(str(_tmp))
    133      _tmp = _utf8(xhtml_escape(_tmp))
    134      _append(_tmp)
    135      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    136      current = ans.get('page_num', 1)
    137      _append('\n')
    138      total = ans.get('page_total', 1)
    139      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    140      if current != 1:
    141          _append('<li><a href="')
    142          _tmp = url %(current-1)
    143          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    144          else: _tmp = _utf8(str(_tmp))
    145          _tmp = _utf8(xhtml_escape(_tmp))
    146          _append(_tmp)
    147          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    148      _append('\n')
    149      if current-3 > 1:
    150          _append('<li><a href="')
    151          _tmp = url %(1)
    152          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    153          else: _tmp = _utf8(str(_tmp))
    154          _tmp = _utf8(xhtml_escape(_tmp))
    155          _append(_tmp)
    156          _append('">1</a></li>')
    157      _append('\n')
    158      if current-3 > 2:
    159          _append('<li><...</li>')
    160      _append('\n')
    161      for i in [i for i in range(current-3,current) if i > 0]:
    162          _append('\n<li><a href="')
    163          _tmp = url %(i)
    164          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    165          else: _tmp = _utf8(str(_tmp))
    166          _tmp = _utf8(xhtml_escape(_tmp))
    167          _append(_tmp)
    168          _append('">')
    169          _tmp = i
    170          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    171          else: _tmp = _utf8(str(_tmp))
    172          _tmp = _utf8(xhtml_escape(_tmp))
    173          _append(_tmp)
    174          _append('</a></li>\n')
    175      _append('\n<li class="active"><a href="javascript:;">')
    176      _tmp = current
    177      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    178      else: _tmp = _utf8(str(_tmp))
    179      _tmp = _utf8(xhtml_escape(_tmp))
    180      _append(_tmp)
    181      _append('</a></li>\n')
    182      for i in [i for i in range(current+1,current+4) if i <= total ]:
    183          _append('\n<li><a href="')
    184          _tmp = url %(i)
    185          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    186          else: _tmp = _utf8(str(_tmp))
    187          _tmp = _utf8(xhtml_escape(_tmp))
    188          _append(_tmp)
    189          _append('">')
    190          _tmp = i
    191          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    192          else: _tmp = _utf8(str(_tmp))
    193          _tmp = _utf8(xhtml_escape(_tmp))
    194          _append(_tmp)
    195          _append('</a></li>\n')
    196      _append('\n')
    197      if current+3 < total:
    198          _append(' <li>...</li>')
    199      _append('\n')
    200      if current < total:
    201          _append(' <li><a href="')
    202          _tmp = url %(current+1)
    203          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    204          else: _tmp = _utf8(str(_tmp))
    205          _tmp = _utf8(xhtml_escape(_tmp))
    206          _append(_tmp)
    207          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    208      _append('\n</ul>\n</div>\n</div>\n</div>')
    209      _append('\n</div>\n</div>\n</div>\n<div class="col-md-6 comment-box hidden">\n')
    210      _append('<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba</h3>\n<button type="button" class="comment-close close" data-dismiss="alert" aria-hidden="true" title="\xe5\x85\xb3\xe9\x97\xad">\xc3\x97</button>\n</div>\n<form role="form" method="post" action="/comment/comment/add" class="comment-form">\n<div class="box-body">\n<input type="hidden" name="q" value="csrf_123ABCDF"/>\n<input type="hidden" name="category" value="')
    211      _tmp = category
    212      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    213      else: _tmp = _utf8(str(_tmp))
    214      _tmp = _utf8(xhtml_escape(_tmp))
    215      _append(_tmp)
    216      _append('"/>\n<input type="hidden" name="_id" value="')
    217      _tmp = ans.get('_id', 0)
    218      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    219      else: _tmp = _utf8(str(_tmp))
    220      _tmp = _utf8(xhtml_escape(_tmp))
    221      _append(_tmp)
    222      _append('"/>\n<input type="hidden" name="title" value="')
    223      _tmp = ans.get('title', '')
    224      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    225      else: _tmp = _utf8(str(_tmp))
    226      _tmp = _utf8(xhtml_escape(_tmp))
    227      _append(_tmp)
    228      _append('"/>\n<div class="form-group">\n<label for="name">\xe6\x98\xb5\xe7\xa7\xb0</label>\n<input name="name" type="text" class="form-control" id="name" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe6\x98\xb5\xe7\xa7\xb0">\n</div>\n<div class="form-group">\n<label for="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</label>\n<input name="email" type="email" class="form-control" id="email" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="contain">\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9</label>\n<textarea name="contain" type="text" class="form-control" id="contain" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9"></textarea>\n</div>\n')
    229      if ans.get('len',-1) == -1:
    230          _append('\n<div class="form-group">\n<label for="captcha">\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81</label>\n<input name="captcha" type="text" class="form-control" id="captcha" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81">\n<img src="#" title="\xe7\x82\xb9\xe5\x87\xbb\xe5\x88\xb7\xe6\x96\xb0\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81" class="captcha-image"/>\n</div>\n')
    231      _append('\n</div>\n<div class="box-footer">\n<button type="submit" class="btn btn-primary comment-add">\xe6\x8f\x90\xe4\xba\xa4\xe8\xaf\x84\xe8\xae\xba</button>\n</div>\n</form>\n</div>')
    232      _append('\n</div>\n</div>\n')
    233      _append('\n</section>\n</div>\n')
    234      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    235      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    236      _append('\n<script>\n$(function () {\n$(".inormal").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 1;\najax_status(ids, status);\n});\n$(".iremove").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".ihidden").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 3;\najax_status(ids, status);\n});\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n});\nreturn false;\n}\n/*\n$(".iadd").click(function(){\n$(".comment-box").removeClass("hidden");\n})\n*/\n$(".nickname").click(function(){\nvar id = $(this).data("_id");\nvar title = $(this).data("title");\n//console.log(id);\n$(".comment-box").removeClass("hidden");\nvar _this = $(".comment-form", ".comment-box");\n$(_this).find("input[name=\'_id\']").val(id);\n$(_this).find("input[name=\'title\']").val(title);\n$(_this).find("input[name=\'name\']").val("jwfy");\n$(_this).find("input[name=\'email\']").val("jwfy0902@foxmail.com");\n});\n$(".comment-close").click(function(){\n$(".comment-box").addClass("hidden");\n})\n});\n</script>\n')
    237      _append('\n</body>\n</html>\n')
    238      return _utf8('').join(_buffer)
[E 150423 14:24:07 dm.py:start:61] Uncaught exception GET /movie/movie/re_list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/re_list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate, sdch', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041982a735d10150ff78b9e6147b617e3ea; jwfy_dm_website_session=e0ac85d060fa9a8e46d15b58a73ce2a7', 'Cache-Control': 'max-age=0', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template removie.html>", line 41, in _execute
    NameError: global name 'category' is not defined
[E 150423 14:24:07 dm.py:start:61] 500 GET /movie/movie/re_list (127.0.0.1) 27.17ms
[E 150423 14:24:27 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:24:27 dm.py:start:61] removie.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<section class="sidebar">\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li class="')
     11      _append('">\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview ')
     12      _append('">\n<a href="javascript:;">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     13      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li class="')
     14      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li class="')
     15      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview ')
     16      _append('active')
     17      _append('">\n<a href="javascript:;">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     18      _append('active')
     19      _append('"><a href="/comment/comment/list?category=movie"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li class="')
     20      _append('"><a href="/comment/comment/list?category=blog"><i class="fa fa-circle-o"></i>\xe5\x8d\x9a\xe5\xae\xa2</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n</aside>')
     21      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     22      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5')
     23      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     24      _append('\n')
     25      ans = pyobject.get('result')
     26      _append('\n')
     27      query = ans.get('query')
     28      _append('\n')
     29      r_status = ans.get('r_status', 0)
     30      _append('\n')
     31      contain = ans.get('contain', '')
     32      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
     33      if contain:
     34          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     35          _tmp = contain
     36          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     37          else: _tmp = _utf8(str(_tmp))
     38          _tmp = _utf8(xhtml_escape(_tmp))
     39          _append(_tmp)
     40      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm ihidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm iremove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm inormal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n<!--\n<button class="btn btn-default btn-sm iadd" title="\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba"><i class="fa fa-plus"></i></button>\n-->\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="status" value="')
     41      _tmp = r_status
     42      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     43      else: _tmp = _utf8(str(_tmp))
     44      _tmp = _utf8(xhtml_escape(_tmp))
     45      _append(_tmp)
     46      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover comment-table">\n<thead>\n')
     47      _append('<tr>\n<th></th>\n<th class="image">\xe5\x9b\xbe\xe7\x89\x87</th>\n<th class="title">\xe6\xa0\x87\xe9\xa2\x98</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe5\x88\x9b\xe5\xbb\xba\xe6\x97\xb6\xe9\x97\xb4</th>\n<th class="update_time">\xe6\x9b\xb4\xe6\x96\xb0\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     48      _append('\n</thead>\n<tbody>\n')
     49      if type(query) == list:
     50          _append('\n')
     51          for q in query:
     52              _append('\n')
     53              _append('<tr>\n<td><input type="checkbox" data-id="')
     54              _tmp = q.get('id',0)
     55              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     56              else: _tmp = _utf8(str(_tmp))
     57              _tmp = _utf8(xhtml_escape(_tmp))
     58              _append(_tmp)
     59              _append('"></td>\n<td class="nickname" data-_id="')
     60              _tmp = q.get('_id', 0)
     61              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     62              else: _tmp = _utf8(str(_tmp))
     63              _tmp = _utf8(xhtml_escape(_tmp))
     64              _append(_tmp)
     65              _append('" data-title="')
     66              _tmp = q.get('title', '')
     67              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     68              else: _tmp = _utf8(str(_tmp))
     69              _tmp = _utf8(xhtml_escape(_tmp))
     70              _append(_tmp)
     71              _append('" >')
     72              _tmp = q.get('name', '')
     73              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     74              else: _tmp = _utf8(str(_tmp))
     75              _tmp = _utf8(xhtml_escape(_tmp))
     76              _append(_tmp)
     77              _append('</td>\n<td class="email">')
     78              _tmp = q.get('email', '')
     79              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     80              else: _tmp = _utf8(str(_tmp))
     81              _tmp = _utf8(xhtml_escape(_tmp))
     82              _append(_tmp)
     83              _append('</td>\n<td class="title">')
     84              _tmp = q.get('title', '')
     85              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     86              else: _tmp = _utf8(str(_tmp))
     87              _tmp = _utf8(xhtml_escape(_tmp))
     88              _append(_tmp)
     89              _append('</td>\n<td class="content">')
     90              _tmp = q.get('contain', '')
     91              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     92              else: _tmp = _utf8(str(_tmp))
     93              _tmp = _utf8(xhtml_escape(_tmp))
     94              _append(_tmp)
     95              _append('</td>\n<td class="status">\n')
     96              status = int(q.get('status', 0))
     97              _append('\n')
     98              if status == 1:
     99                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
    100              elif status == 2:
    101                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
    102              elif status == 3:
    103                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
    104              _append('\n</td>\n<td class="time">')
    105              _tmp = q.get('time', '')
    106              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    107              else: _tmp = _utf8(str(_tmp))
    108              _tmp = _utf8(xhtml_escape(_tmp))
    109              _append(_tmp)
    110              _append('</td>\n</tr>')
    111              _append('\n')
    112          _append('\n')
    113      _append('\n</tbody>\n</table>\n')
    114      url = '/comment/comment/list?&status=%s' %(r_status)
    115      _append('\n')
    116      if contain:
    117          _append('\n')
    118          url = url + '&contain=%s' %(contain)
    119          _append('\n')
    120      _append('\n')
    121      url = url + "&page_num=%s"
    122      _append('\n')
    123      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    124      _tmp = ans.get('total_num', 0)
    125      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    126      else: _tmp = _utf8(str(_tmp))
    127      _tmp = _utf8(xhtml_escape(_tmp))
    128      _append(_tmp)
    129      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    130      current = ans.get('page_num', 1)
    131      _append('\n')
    132      total = ans.get('page_total', 1)
    133      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    134      if current != 1:
    135          _append('<li><a href="')
    136          _tmp = url %(current-1)
    137          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    138          else: _tmp = _utf8(str(_tmp))
    139          _tmp = _utf8(xhtml_escape(_tmp))
    140          _append(_tmp)
    141          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    142      _append('\n')
    143      if current-3 > 1:
    144          _append('<li><a href="')
    145          _tmp = url %(1)
    146          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    147          else: _tmp = _utf8(str(_tmp))
    148          _tmp = _utf8(xhtml_escape(_tmp))
    149          _append(_tmp)
    150          _append('">1</a></li>')
    151      _append('\n')
    152      if current-3 > 2:
    153          _append('<li><...</li>')
    154      _append('\n')
    155      for i in [i for i in range(current-3,current) if i > 0]:
    156          _append('\n<li><a href="')
    157          _tmp = url %(i)
    158          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    159          else: _tmp = _utf8(str(_tmp))
    160          _tmp = _utf8(xhtml_escape(_tmp))
    161          _append(_tmp)
    162          _append('">')
    163          _tmp = i
    164          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    165          else: _tmp = _utf8(str(_tmp))
    166          _tmp = _utf8(xhtml_escape(_tmp))
    167          _append(_tmp)
    168          _append('</a></li>\n')
    169      _append('\n<li class="active"><a href="javascript:;">')
    170      _tmp = current
    171      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    172      else: _tmp = _utf8(str(_tmp))
    173      _tmp = _utf8(xhtml_escape(_tmp))
    174      _append(_tmp)
    175      _append('</a></li>\n')
    176      for i in [i for i in range(current+1,current+4) if i <= total ]:
    177          _append('\n<li><a href="')
    178          _tmp = url %(i)
    179          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    180          else: _tmp = _utf8(str(_tmp))
    181          _tmp = _utf8(xhtml_escape(_tmp))
    182          _append(_tmp)
    183          _append('">')
    184          _tmp = i
    185          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    186          else: _tmp = _utf8(str(_tmp))
    187          _tmp = _utf8(xhtml_escape(_tmp))
    188          _append(_tmp)
    189          _append('</a></li>\n')
    190      _append('\n')
    191      if current+3 < total:
    192          _append(' <li>...</li>')
    193      _append('\n')
    194      if current < total:
    195          _append(' <li><a href="')
    196          _tmp = url %(current+1)
    197          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    198          else: _tmp = _utf8(str(_tmp))
    199          _tmp = _utf8(xhtml_escape(_tmp))
    200          _append(_tmp)
    201          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    202      _append('\n</ul>\n</div>\n</div>\n</div>')
    203      _append('\n</div>\n</div>\n</div>\n<div class="col-md-6 comment-box hidden">\n')
    204      _append('<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba</h3>\n<button type="button" class="comment-close close" data-dismiss="alert" aria-hidden="true" title="\xe5\x85\xb3\xe9\x97\xad">\xc3\x97</button>\n</div>\n<form role="form" method="post" action="/comment/comment/add" class="comment-form">\n<div class="box-body">\n<input type="hidden" name="q" value="csrf_123ABCDF"/>\n<input type="hidden" name="category" value="')
    205      _tmp = category
    206      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    207      else: _tmp = _utf8(str(_tmp))
    208      _tmp = _utf8(xhtml_escape(_tmp))
    209      _append(_tmp)
    210      _append('"/>\n<input type="hidden" name="_id" value="')
    211      _tmp = ans.get('_id', 0)
    212      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    213      else: _tmp = _utf8(str(_tmp))
    214      _tmp = _utf8(xhtml_escape(_tmp))
    215      _append(_tmp)
    216      _append('"/>\n<input type="hidden" name="title" value="')
    217      _tmp = ans.get('title', '')
    218      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    219      else: _tmp = _utf8(str(_tmp))
    220      _tmp = _utf8(xhtml_escape(_tmp))
    221      _append(_tmp)
    222      _append('"/>\n<div class="form-group">\n<label for="name">\xe6\x98\xb5\xe7\xa7\xb0</label>\n<input name="name" type="text" class="form-control" id="name" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe6\x98\xb5\xe7\xa7\xb0">\n</div>\n<div class="form-group">\n<label for="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</label>\n<input name="email" type="email" class="form-control" id="email" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="contain">\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9</label>\n<textarea name="contain" type="text" class="form-control" id="contain" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9"></textarea>\n</div>\n')
    223      if ans.get('len',-1) == -1:
    224          _append('\n<div class="form-group">\n<label for="captcha">\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81</label>\n<input name="captcha" type="text" class="form-control" id="captcha" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81">\n<img src="#" title="\xe7\x82\xb9\xe5\x87\xbb\xe5\x88\xb7\xe6\x96\xb0\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81" class="captcha-image"/>\n</div>\n')
    225      _append('\n</div>\n<div class="box-footer">\n<button type="submit" class="btn btn-primary comment-add">\xe6\x8f\x90\xe4\xba\xa4\xe8\xaf\x84\xe8\xae\xba</button>\n</div>\n</form>\n</div>')
    226      _append('\n</div>\n</div>\n')
    227      _append('\n</section>\n</div>\n')
    228      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    229      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    230      _append('\n<script>\n$(function () {\n$(".inormal").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 1;\najax_status(ids, status);\n});\n$(".iremove").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".ihidden").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 3;\najax_status(ids, status);\n});\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n});\nreturn false;\n}\n/*\n$(".iadd").click(function(){\n$(".comment-box").removeClass("hidden");\n})\n*/\n$(".nickname").click(function(){\nvar id = $(this).data("_id");\nvar title = $(this).data("title");\n//console.log(id);\n$(".comment-box").removeClass("hidden");\nvar _this = $(".comment-form", ".comment-box");\n$(_this).find("input[name=\'_id\']").val(id);\n$(_this).find("input[name=\'title\']").val(title);\n$(_this).find("input[name=\'name\']").val("jwfy");\n$(_this).find("input[name=\'email\']").val("jwfy0902@foxmail.com");\n});\n$(".comment-close").click(function(){\n$(".comment-box").addClass("hidden");\n})\n});\n</script>\n')
    231      _append('\n</body>\n</html>\n')
    232      return _utf8('').join(_buffer)
[E 150423 14:24:27 dm.py:start:61] Uncaught exception GET /movie/movie/re_list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/re_list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate, sdch', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041982a735d10150ff78b9e6147b617e3ea; jwfy_dm_website_session=e0ac85d060fa9a8e46d15b58a73ce2a7', 'Cache-Control': 'max-age=0', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template removie.html>", line 205, in _execute
    NameError: global name 'category' is not defined
[E 150423 14:24:27 dm.py:start:61] 500 GET /movie/movie/re_list (127.0.0.1) 18.99ms
[E 150423 14:24:28 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:24:28 dm.py:start:61] removie.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<section class="sidebar">\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li class="')
     11      _append('">\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview ')
     12      _append('">\n<a href="javascript:;">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     13      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li class="')
     14      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li class="')
     15      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview ')
     16      _append('active')
     17      _append('">\n<a href="javascript:;">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     18      _append('active')
     19      _append('"><a href="/comment/comment/list?category=movie"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li class="')
     20      _append('"><a href="/comment/comment/list?category=blog"><i class="fa fa-circle-o"></i>\xe5\x8d\x9a\xe5\xae\xa2</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n</aside>')
     21      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     22      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5')
     23      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     24      _append('\n')
     25      ans = pyobject.get('result')
     26      _append('\n')
     27      query = ans.get('query')
     28      _append('\n')
     29      r_status = ans.get('r_status', 0)
     30      _append('\n')
     31      contain = ans.get('contain', '')
     32      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
     33      if contain:
     34          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     35          _tmp = contain
     36          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     37          else: _tmp = _utf8(str(_tmp))
     38          _tmp = _utf8(xhtml_escape(_tmp))
     39          _append(_tmp)
     40      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm ihidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm iremove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm inormal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n<!--\n<button class="btn btn-default btn-sm iadd" title="\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba"><i class="fa fa-plus"></i></button>\n-->\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="status" value="')
     41      _tmp = r_status
     42      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     43      else: _tmp = _utf8(str(_tmp))
     44      _tmp = _utf8(xhtml_escape(_tmp))
     45      _append(_tmp)
     46      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover comment-table">\n<thead>\n')
     47      _append('<tr>\n<th></th>\n<th class="image">\xe5\x9b\xbe\xe7\x89\x87</th>\n<th class="title">\xe6\xa0\x87\xe9\xa2\x98</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe5\x88\x9b\xe5\xbb\xba\xe6\x97\xb6\xe9\x97\xb4</th>\n<th class="update_time">\xe6\x9b\xb4\xe6\x96\xb0\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     48      _append('\n</thead>\n<tbody>\n')
     49      if type(query) == list:
     50          _append('\n')
     51          for q in query:
     52              _append('\n')
     53              _append('<tr>\n<td><input type="checkbox" data-id="')
     54              _tmp = q.get('id',0)
     55              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     56              else: _tmp = _utf8(str(_tmp))
     57              _tmp = _utf8(xhtml_escape(_tmp))
     58              _append(_tmp)
     59              _append('"></td>\n<td class="nickname" data-_id="')
     60              _tmp = q.get('_id', 0)
     61              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     62              else: _tmp = _utf8(str(_tmp))
     63              _tmp = _utf8(xhtml_escape(_tmp))
     64              _append(_tmp)
     65              _append('" data-title="')
     66              _tmp = q.get('title', '')
     67              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     68              else: _tmp = _utf8(str(_tmp))
     69              _tmp = _utf8(xhtml_escape(_tmp))
     70              _append(_tmp)
     71              _append('" >')
     72              _tmp = q.get('name', '')
     73              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     74              else: _tmp = _utf8(str(_tmp))
     75              _tmp = _utf8(xhtml_escape(_tmp))
     76              _append(_tmp)
     77              _append('</td>\n<td class="email">')
     78              _tmp = q.get('email', '')
     79              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     80              else: _tmp = _utf8(str(_tmp))
     81              _tmp = _utf8(xhtml_escape(_tmp))
     82              _append(_tmp)
     83              _append('</td>\n<td class="title">')
     84              _tmp = q.get('title', '')
     85              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     86              else: _tmp = _utf8(str(_tmp))
     87              _tmp = _utf8(xhtml_escape(_tmp))
     88              _append(_tmp)
     89              _append('</td>\n<td class="content">')
     90              _tmp = q.get('contain', '')
     91              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     92              else: _tmp = _utf8(str(_tmp))
     93              _tmp = _utf8(xhtml_escape(_tmp))
     94              _append(_tmp)
     95              _append('</td>\n<td class="status">\n')
     96              status = int(q.get('status', 0))
     97              _append('\n')
     98              if status == 1:
     99                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
    100              elif status == 2:
    101                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
    102              elif status == 3:
    103                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
    104              _append('\n</td>\n<td class="time">')
    105              _tmp = q.get('time', '')
    106              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    107              else: _tmp = _utf8(str(_tmp))
    108              _tmp = _utf8(xhtml_escape(_tmp))
    109              _append(_tmp)
    110              _append('</td>\n</tr>')
    111              _append('\n')
    112          _append('\n')
    113      _append('\n</tbody>\n</table>\n')
    114      url = '/comment/comment/list?&status=%s' %(r_status)
    115      _append('\n')
    116      if contain:
    117          _append('\n')
    118          url = url + '&contain=%s' %(contain)
    119          _append('\n')
    120      _append('\n')
    121      url = url + "&page_num=%s"
    122      _append('\n')
    123      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    124      _tmp = ans.get('total_num', 0)
    125      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    126      else: _tmp = _utf8(str(_tmp))
    127      _tmp = _utf8(xhtml_escape(_tmp))
    128      _append(_tmp)
    129      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    130      current = ans.get('page_num', 1)
    131      _append('\n')
    132      total = ans.get('page_total', 1)
    133      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    134      if current != 1:
    135          _append('<li><a href="')
    136          _tmp = url %(current-1)
    137          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    138          else: _tmp = _utf8(str(_tmp))
    139          _tmp = _utf8(xhtml_escape(_tmp))
    140          _append(_tmp)
    141          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    142      _append('\n')
    143      if current-3 > 1:
    144          _append('<li><a href="')
    145          _tmp = url %(1)
    146          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    147          else: _tmp = _utf8(str(_tmp))
    148          _tmp = _utf8(xhtml_escape(_tmp))
    149          _append(_tmp)
    150          _append('">1</a></li>')
    151      _append('\n')
    152      if current-3 > 2:
    153          _append('<li><...</li>')
    154      _append('\n')
    155      for i in [i for i in range(current-3,current) if i > 0]:
    156          _append('\n<li><a href="')
    157          _tmp = url %(i)
    158          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    159          else: _tmp = _utf8(str(_tmp))
    160          _tmp = _utf8(xhtml_escape(_tmp))
    161          _append(_tmp)
    162          _append('">')
    163          _tmp = i
    164          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    165          else: _tmp = _utf8(str(_tmp))
    166          _tmp = _utf8(xhtml_escape(_tmp))
    167          _append(_tmp)
    168          _append('</a></li>\n')
    169      _append('\n<li class="active"><a href="javascript:;">')
    170      _tmp = current
    171      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    172      else: _tmp = _utf8(str(_tmp))
    173      _tmp = _utf8(xhtml_escape(_tmp))
    174      _append(_tmp)
    175      _append('</a></li>\n')
    176      for i in [i for i in range(current+1,current+4) if i <= total ]:
    177          _append('\n<li><a href="')
    178          _tmp = url %(i)
    179          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    180          else: _tmp = _utf8(str(_tmp))
    181          _tmp = _utf8(xhtml_escape(_tmp))
    182          _append(_tmp)
    183          _append('">')
    184          _tmp = i
    185          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    186          else: _tmp = _utf8(str(_tmp))
    187          _tmp = _utf8(xhtml_escape(_tmp))
    188          _append(_tmp)
    189          _append('</a></li>\n')
    190      _append('\n')
    191      if current+3 < total:
    192          _append(' <li>...</li>')
    193      _append('\n')
    194      if current < total:
    195          _append(' <li><a href="')
    196          _tmp = url %(current+1)
    197          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    198          else: _tmp = _utf8(str(_tmp))
    199          _tmp = _utf8(xhtml_escape(_tmp))
    200          _append(_tmp)
    201          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    202      _append('\n</ul>\n</div>\n</div>\n</div>')
    203      _append('\n</div>\n</div>\n</div>\n<div class="col-md-6 comment-box hidden">\n')
    204      _append('<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba</h3>\n<button type="button" class="comment-close close" data-dismiss="alert" aria-hidden="true" title="\xe5\x85\xb3\xe9\x97\xad">\xc3\x97</button>\n</div>\n<form role="form" method="post" action="/comment/comment/add" class="comment-form">\n<div class="box-body">\n<input type="hidden" name="q" value="csrf_123ABCDF"/>\n<input type="hidden" name="category" value="')
    205      _tmp = category
    206      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    207      else: _tmp = _utf8(str(_tmp))
    208      _tmp = _utf8(xhtml_escape(_tmp))
    209      _append(_tmp)
    210      _append('"/>\n<input type="hidden" name="_id" value="')
    211      _tmp = ans.get('_id', 0)
    212      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    213      else: _tmp = _utf8(str(_tmp))
    214      _tmp = _utf8(xhtml_escape(_tmp))
    215      _append(_tmp)
    216      _append('"/>\n<input type="hidden" name="title" value="')
    217      _tmp = ans.get('title', '')
    218      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    219      else: _tmp = _utf8(str(_tmp))
    220      _tmp = _utf8(xhtml_escape(_tmp))
    221      _append(_tmp)
    222      _append('"/>\n<div class="form-group">\n<label for="name">\xe6\x98\xb5\xe7\xa7\xb0</label>\n<input name="name" type="text" class="form-control" id="name" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe6\x98\xb5\xe7\xa7\xb0">\n</div>\n<div class="form-group">\n<label for="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</label>\n<input name="email" type="email" class="form-control" id="email" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="contain">\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9</label>\n<textarea name="contain" type="text" class="form-control" id="contain" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9"></textarea>\n</div>\n')
    223      if ans.get('len',-1) == -1:
    224          _append('\n<div class="form-group">\n<label for="captcha">\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81</label>\n<input name="captcha" type="text" class="form-control" id="captcha" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81">\n<img src="#" title="\xe7\x82\xb9\xe5\x87\xbb\xe5\x88\xb7\xe6\x96\xb0\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81" class="captcha-image"/>\n</div>\n')
    225      _append('\n</div>\n<div class="box-footer">\n<button type="submit" class="btn btn-primary comment-add">\xe6\x8f\x90\xe4\xba\xa4\xe8\xaf\x84\xe8\xae\xba</button>\n</div>\n</form>\n</div>')
    226      _append('\n</div>\n</div>\n')
    227      _append('\n</section>\n</div>\n')
    228      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    229      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    230      _append('\n<script>\n$(function () {\n$(".inormal").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 1;\najax_status(ids, status);\n});\n$(".iremove").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".ihidden").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 3;\najax_status(ids, status);\n});\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n});\nreturn false;\n}\n/*\n$(".iadd").click(function(){\n$(".comment-box").removeClass("hidden");\n})\n*/\n$(".nickname").click(function(){\nvar id = $(this).data("_id");\nvar title = $(this).data("title");\n//console.log(id);\n$(".comment-box").removeClass("hidden");\nvar _this = $(".comment-form", ".comment-box");\n$(_this).find("input[name=\'_id\']").val(id);\n$(_this).find("input[name=\'title\']").val(title);\n$(_this).find("input[name=\'name\']").val("jwfy");\n$(_this).find("input[name=\'email\']").val("jwfy0902@foxmail.com");\n});\n$(".comment-close").click(function(){\n$(".comment-box").addClass("hidden");\n})\n});\n</script>\n')
    231      _append('\n</body>\n</html>\n')
    232      return _utf8('').join(_buffer)
[E 150423 14:24:28 dm.py:start:61] Uncaught exception GET /movie/movie/re_list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/re_list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate, sdch', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041982a735d10150ff78b9e6147b617e3ea; jwfy_dm_website_session=e0ac85d060fa9a8e46d15b58a73ce2a7', 'Cache-Control': 'max-age=0', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template removie.html>", line 205, in _execute
    NameError: global name 'category' is not defined
[E 150423 14:24:28 dm.py:start:61] 500 GET /movie/movie/re_list (127.0.0.1) 21.75ms
[E 150423 14:24:28 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:24:28 dm.py:start:61] removie.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<section class="sidebar">\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li class="')
     11      _append('">\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview ')
     12      _append('">\n<a href="javascript:;">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     13      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li class="')
     14      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li class="')
     15      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview ')
     16      _append('active')
     17      _append('">\n<a href="javascript:;">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     18      _append('active')
     19      _append('"><a href="/comment/comment/list?category=movie"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li class="')
     20      _append('"><a href="/comment/comment/list?category=blog"><i class="fa fa-circle-o"></i>\xe5\x8d\x9a\xe5\xae\xa2</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n</aside>')
     21      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     22      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5')
     23      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     24      _append('\n')
     25      ans = pyobject.get('result')
     26      _append('\n')
     27      query = ans.get('query')
     28      _append('\n')
     29      r_status = ans.get('r_status', 0)
     30      _append('\n')
     31      contain = ans.get('contain', '')
     32      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
     33      if contain:
     34          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     35          _tmp = contain
     36          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     37          else: _tmp = _utf8(str(_tmp))
     38          _tmp = _utf8(xhtml_escape(_tmp))
     39          _append(_tmp)
     40      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm ihidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm iremove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm inormal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n<!--\n<button class="btn btn-default btn-sm iadd" title="\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba"><i class="fa fa-plus"></i></button>\n-->\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="status" value="')
     41      _tmp = r_status
     42      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     43      else: _tmp = _utf8(str(_tmp))
     44      _tmp = _utf8(xhtml_escape(_tmp))
     45      _append(_tmp)
     46      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover comment-table">\n<thead>\n')
     47      _append('<tr>\n<th></th>\n<th class="image">\xe5\x9b\xbe\xe7\x89\x87</th>\n<th class="title">\xe6\xa0\x87\xe9\xa2\x98</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe5\x88\x9b\xe5\xbb\xba\xe6\x97\xb6\xe9\x97\xb4</th>\n<th class="update_time">\xe6\x9b\xb4\xe6\x96\xb0\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     48      _append('\n</thead>\n<tbody>\n')
     49      if type(query) == list:
     50          _append('\n')
     51          for q in query:
     52              _append('\n')
     53              _append('<tr>\n<td><input type="checkbox" data-id="')
     54              _tmp = q.get('id',0)
     55              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     56              else: _tmp = _utf8(str(_tmp))
     57              _tmp = _utf8(xhtml_escape(_tmp))
     58              _append(_tmp)
     59              _append('"></td>\n<td class="nickname" data-_id="')
     60              _tmp = q.get('_id', 0)
     61              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     62              else: _tmp = _utf8(str(_tmp))
     63              _tmp = _utf8(xhtml_escape(_tmp))
     64              _append(_tmp)
     65              _append('" data-title="')
     66              _tmp = q.get('title', '')
     67              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     68              else: _tmp = _utf8(str(_tmp))
     69              _tmp = _utf8(xhtml_escape(_tmp))
     70              _append(_tmp)
     71              _append('" >')
     72              _tmp = q.get('name', '')
     73              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     74              else: _tmp = _utf8(str(_tmp))
     75              _tmp = _utf8(xhtml_escape(_tmp))
     76              _append(_tmp)
     77              _append('</td>\n<td class="email">')
     78              _tmp = q.get('email', '')
     79              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     80              else: _tmp = _utf8(str(_tmp))
     81              _tmp = _utf8(xhtml_escape(_tmp))
     82              _append(_tmp)
     83              _append('</td>\n<td class="title">')
     84              _tmp = q.get('title', '')
     85              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     86              else: _tmp = _utf8(str(_tmp))
     87              _tmp = _utf8(xhtml_escape(_tmp))
     88              _append(_tmp)
     89              _append('</td>\n<td class="content">')
     90              _tmp = q.get('contain', '')
     91              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     92              else: _tmp = _utf8(str(_tmp))
     93              _tmp = _utf8(xhtml_escape(_tmp))
     94              _append(_tmp)
     95              _append('</td>\n<td class="status">\n')
     96              status = int(q.get('status', 0))
     97              _append('\n')
     98              if status == 1:
     99                  _append('\n<span class="label label-success">\xe6\xad\xa3\xe5\xb8\xb8</span>\n')
    100              elif status == 2:
    101                  _append('\n<span class="label label-danger">\xe5\x88\xa0\xe9\x99\xa4</span>\n')
    102              elif status == 3:
    103                  _append('\n<span class="label label-primary">\xe9\x9a\x90\xe8\x97\x8f</span>\n')
    104              _append('\n</td>\n<td class="time">')
    105              _tmp = q.get('time', '')
    106              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    107              else: _tmp = _utf8(str(_tmp))
    108              _tmp = _utf8(xhtml_escape(_tmp))
    109              _append(_tmp)
    110              _append('</td>\n</tr>')
    111              _append('\n')
    112          _append('\n')
    113      _append('\n</tbody>\n</table>\n')
    114      url = '/comment/comment/list?&status=%s' %(r_status)
    115      _append('\n')
    116      if contain:
    117          _append('\n')
    118          url = url + '&contain=%s' %(contain)
    119          _append('\n')
    120      _append('\n')
    121      url = url + "&page_num=%s"
    122      _append('\n')
    123      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
    124      _tmp = ans.get('total_num', 0)
    125      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    126      else: _tmp = _utf8(str(_tmp))
    127      _tmp = _utf8(xhtml_escape(_tmp))
    128      _append(_tmp)
    129      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
    130      current = ans.get('page_num', 1)
    131      _append('\n')
    132      total = ans.get('page_total', 1)
    133      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    134      if current != 1:
    135          _append('<li><a href="')
    136          _tmp = url %(current-1)
    137          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    138          else: _tmp = _utf8(str(_tmp))
    139          _tmp = _utf8(xhtml_escape(_tmp))
    140          _append(_tmp)
    141          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    142      _append('\n')
    143      if current-3 > 1:
    144          _append('<li><a href="')
    145          _tmp = url %(1)
    146          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    147          else: _tmp = _utf8(str(_tmp))
    148          _tmp = _utf8(xhtml_escape(_tmp))
    149          _append(_tmp)
    150          _append('">1</a></li>')
    151      _append('\n')
    152      if current-3 > 2:
    153          _append('<li><...</li>')
    154      _append('\n')
    155      for i in [i for i in range(current-3,current) if i > 0]:
    156          _append('\n<li><a href="')
    157          _tmp = url %(i)
    158          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    159          else: _tmp = _utf8(str(_tmp))
    160          _tmp = _utf8(xhtml_escape(_tmp))
    161          _append(_tmp)
    162          _append('">')
    163          _tmp = i
    164          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    165          else: _tmp = _utf8(str(_tmp))
    166          _tmp = _utf8(xhtml_escape(_tmp))
    167          _append(_tmp)
    168          _append('</a></li>\n')
    169      _append('\n<li class="active"><a href="javascript:;">')
    170      _tmp = current
    171      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    172      else: _tmp = _utf8(str(_tmp))
    173      _tmp = _utf8(xhtml_escape(_tmp))
    174      _append(_tmp)
    175      _append('</a></li>\n')
    176      for i in [i for i in range(current+1,current+4) if i <= total ]:
    177          _append('\n<li><a href="')
    178          _tmp = url %(i)
    179          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    180          else: _tmp = _utf8(str(_tmp))
    181          _tmp = _utf8(xhtml_escape(_tmp))
    182          _append(_tmp)
    183          _append('">')
    184          _tmp = i
    185          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    186          else: _tmp = _utf8(str(_tmp))
    187          _tmp = _utf8(xhtml_escape(_tmp))
    188          _append(_tmp)
    189          _append('</a></li>\n')
    190      _append('\n')
    191      if current+3 < total:
    192          _append(' <li>...</li>')
    193      _append('\n')
    194      if current < total:
    195          _append(' <li><a href="')
    196          _tmp = url %(current+1)
    197          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    198          else: _tmp = _utf8(str(_tmp))
    199          _tmp = _utf8(xhtml_escape(_tmp))
    200          _append(_tmp)
    201          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    202      _append('\n</ul>\n</div>\n</div>\n</div>')
    203      _append('\n</div>\n</div>\n</div>\n<div class="col-md-6 comment-box hidden">\n')
    204      _append('<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba</h3>\n<button type="button" class="comment-close close" data-dismiss="alert" aria-hidden="true" title="\xe5\x85\xb3\xe9\x97\xad">\xc3\x97</button>\n</div>\n<form role="form" method="post" action="/comment/comment/add" class="comment-form">\n<div class="box-body">\n<input type="hidden" name="q" value="csrf_123ABCDF"/>\n<input type="hidden" name="category" value="')
    205      _tmp = category
    206      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    207      else: _tmp = _utf8(str(_tmp))
    208      _tmp = _utf8(xhtml_escape(_tmp))
    209      _append(_tmp)
    210      _append('"/>\n<input type="hidden" name="_id" value="')
    211      _tmp = ans.get('_id', 0)
    212      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    213      else: _tmp = _utf8(str(_tmp))
    214      _tmp = _utf8(xhtml_escape(_tmp))
    215      _append(_tmp)
    216      _append('"/>\n<input type="hidden" name="title" value="')
    217      _tmp = ans.get('title', '')
    218      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    219      else: _tmp = _utf8(str(_tmp))
    220      _tmp = _utf8(xhtml_escape(_tmp))
    221      _append(_tmp)
    222      _append('"/>\n<div class="form-group">\n<label for="name">\xe6\x98\xb5\xe7\xa7\xb0</label>\n<input name="name" type="text" class="form-control" id="name" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe6\x98\xb5\xe7\xa7\xb0">\n</div>\n<div class="form-group">\n<label for="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</label>\n<input name="email" type="email" class="form-control" id="email" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="contain">\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9</label>\n<textarea name="contain" type="text" class="form-control" id="contain" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9"></textarea>\n</div>\n')
    223      if ans.get('len',-1) == -1:
    224          _append('\n<div class="form-group">\n<label for="captcha">\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81</label>\n<input name="captcha" type="text" class="form-control" id="captcha" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81">\n<img src="#" title="\xe7\x82\xb9\xe5\x87\xbb\xe5\x88\xb7\xe6\x96\xb0\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81" class="captcha-image"/>\n</div>\n')
    225      _append('\n</div>\n<div class="box-footer">\n<button type="submit" class="btn btn-primary comment-add">\xe6\x8f\x90\xe4\xba\xa4\xe8\xaf\x84\xe8\xae\xba</button>\n</div>\n</form>\n</div>')
    226      _append('\n</div>\n</div>\n')
    227      _append('\n</section>\n</div>\n')
    228      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    229      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    230      _append('\n<script>\n$(function () {\n$(".inormal").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 1;\najax_status(ids, status);\n});\n$(".iremove").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".ihidden").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 3;\najax_status(ids, status);\n});\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n});\nreturn false;\n}\n/*\n$(".iadd").click(function(){\n$(".comment-box").removeClass("hidden");\n})\n*/\n$(".nickname").click(function(){\nvar id = $(this).data("_id");\nvar title = $(this).data("title");\n//console.log(id);\n$(".comment-box").removeClass("hidden");\nvar _this = $(".comment-form", ".comment-box");\n$(_this).find("input[name=\'_id\']").val(id);\n$(_this).find("input[name=\'title\']").val(title);\n$(_this).find("input[name=\'name\']").val("jwfy");\n$(_this).find("input[name=\'email\']").val("jwfy0902@foxmail.com");\n});\n$(".comment-close").click(function(){\n$(".comment-box").addClass("hidden");\n})\n});\n</script>\n')
    231      _append('\n</body>\n</html>\n')
    232      return _utf8('').join(_buffer)
[E 150423 14:24:28 dm.py:start:61] Uncaught exception GET /movie/movie/re_list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/re_list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate, sdch', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041982a735d10150ff78b9e6147b617e3ea; jwfy_dm_website_session=e0ac85d060fa9a8e46d15b58a73ce2a7', 'Cache-Control': 'max-age=0', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template removie.html>", line 205, in _execute
    NameError: global name 'category' is not defined
[E 150423 14:24:28 dm.py:start:61] 500 GET /movie/movie/re_list (127.0.0.1) 25.05ms
[E 150423 14:25:27 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:25:27 dm.py:start:61] removie.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<section class="sidebar">\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li class="')
     11      _append('">\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview ')
     12      _append('">\n<a href="javascript:;">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     13      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li class="')
     14      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li class="')
     15      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview ')
     16      _append('active')
     17      _append('">\n<a href="javascript:;">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     18      _append('active')
     19      _append('"><a href="/comment/comment/list?category=movie"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li class="')
     20      _append('"><a href="/comment/comment/list?category=blog"><i class="fa fa-circle-o"></i>\xe5\x8d\x9a\xe5\xae\xa2</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n</aside>')
     21      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     22      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5')
     23      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     24      _append('\n')
     25      ans = pyobject.get('result')
     26      _append('\n')
     27      query = ans.get('query')
     28      _append('\n')
     29      r_status = ans.get('r_status', 0)
     30      _append('\n')
     31      contain = ans.get('contain', '')
     32      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
     33      if contain:
     34          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     35          _tmp = contain
     36          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     37          else: _tmp = _utf8(str(_tmp))
     38          _tmp = _utf8(xhtml_escape(_tmp))
     39          _append(_tmp)
     40      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm ihidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm iremove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm inormal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n<!--\n<button class="btn btn-default btn-sm iadd" title="\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba"><i class="fa fa-plus"></i></button>\n-->\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="status" value="')
     41      _tmp = r_status
     42      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     43      else: _tmp = _utf8(str(_tmp))
     44      _tmp = _utf8(xhtml_escape(_tmp))
     45      _append(_tmp)
     46      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover comment-table">\n<thead>\n')
     47      _append('<tr>\n<th></th>\n<th class="image">\xe5\x9b\xbe\xe7\x89\x87</th>\n<th class="title">\xe6\xa0\x87\xe9\xa2\x98</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe5\x88\x9b\xe5\xbb\xba\xe6\x97\xb6\xe9\x97\xb4</th>\n<th class="update_time">\xe6\x9b\xb4\xe6\x96\xb0\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     48      _append('\n</thead>\n<tbody>\n')
     49      if type(query) == list:
     50          _append('\n')
     51          for q in query:
     52              _append('\n')
     53              _append('<tr>\n<td><input type="checkbox" data-id="')
     54              _tmp = q.get('id',0)
     55              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     56              else: _tmp = _utf8(str(_tmp))
     57              _tmp = _utf8(xhtml_escape(_tmp))
     58              _append(_tmp)
     59              _append('"></td>\n<td class="title">')
     60              _tmp = q.get('title', '')
     61              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     62              else: _tmp = _utf8(str(_tmp))
     63              _tmp = _utf8(xhtml_escape(_tmp))
     64              _append(_tmp)
     65              _append('</td>\n<td class="status">\n')
     66              status = int(q.get('status', 0))
     67              _append('\n')
     68              if status == 1:
     69                  _append('\n<span class="label label-success">\xe4\xb8\x8a\xe7\xba\xbf</span>\n')
     70              elif status == 2:
     71                  _append('\n<span class="label label-danger">\xe4\xb8\x8b\xe7\xba\xbf</span>\n')
     72              _append('\n</td>\n<td class="time">')
     73              _tmp = q.get('time', '')
     74              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     75              else: _tmp = _utf8(str(_tmp))
     76              _tmp = _utf8(xhtml_escape(_tmp))
     77              _append(_tmp)
     78              _append('</td>\n<td class="update_time"></td>\n</tr>\n<tr>\n<th></th>\n<th class="image">\xe5\x9b\xbe\xe7\x89\x87</th>\n<th class="title">\xe6\xa0\x87\xe9\xa2\x98</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe5\x88\x9b\xe5\xbb\xba\xe6\x97\xb6\xe9\x97\xb4</th>\n<th class="update_time">\xe6\x9b\xb4\xe6\x96\xb0\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>')
     79              _append('\n')
     80          _append('\n')
     81      _append('\n</tbody>\n</table>\n')
     82      url = '/comment/comment/list?&status=%s' %(r_status)
     83      _append('\n')
     84      if contain:
     85          _append('\n')
     86          url = url + '&contain=%s' %(contain)
     87          _append('\n')
     88      _append('\n')
     89      url = url + "&page_num=%s"
     90      _append('\n')
     91      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
     92      _tmp = ans.get('total_num', 0)
     93      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     94      else: _tmp = _utf8(str(_tmp))
     95      _tmp = _utf8(xhtml_escape(_tmp))
     96      _append(_tmp)
     97      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
     98      current = ans.get('page_num', 1)
     99      _append('\n')
    100      total = ans.get('page_total', 1)
    101      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    102      if current != 1:
    103          _append('<li><a href="')
    104          _tmp = url %(current-1)
    105          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    106          else: _tmp = _utf8(str(_tmp))
    107          _tmp = _utf8(xhtml_escape(_tmp))
    108          _append(_tmp)
    109          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    110      _append('\n')
    111      if current-3 > 1:
    112          _append('<li><a href="')
    113          _tmp = url %(1)
    114          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    115          else: _tmp = _utf8(str(_tmp))
    116          _tmp = _utf8(xhtml_escape(_tmp))
    117          _append(_tmp)
    118          _append('">1</a></li>')
    119      _append('\n')
    120      if current-3 > 2:
    121          _append('<li><...</li>')
    122      _append('\n')
    123      for i in [i for i in range(current-3,current) if i > 0]:
    124          _append('\n<li><a href="')
    125          _tmp = url %(i)
    126          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    127          else: _tmp = _utf8(str(_tmp))
    128          _tmp = _utf8(xhtml_escape(_tmp))
    129          _append(_tmp)
    130          _append('">')
    131          _tmp = i
    132          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    133          else: _tmp = _utf8(str(_tmp))
    134          _tmp = _utf8(xhtml_escape(_tmp))
    135          _append(_tmp)
    136          _append('</a></li>\n')
    137      _append('\n<li class="active"><a href="javascript:;">')
    138      _tmp = current
    139      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    140      else: _tmp = _utf8(str(_tmp))
    141      _tmp = _utf8(xhtml_escape(_tmp))
    142      _append(_tmp)
    143      _append('</a></li>\n')
    144      for i in [i for i in range(current+1,current+4) if i <= total ]:
    145          _append('\n<li><a href="')
    146          _tmp = url %(i)
    147          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    148          else: _tmp = _utf8(str(_tmp))
    149          _tmp = _utf8(xhtml_escape(_tmp))
    150          _append(_tmp)
    151          _append('">')
    152          _tmp = i
    153          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    154          else: _tmp = _utf8(str(_tmp))
    155          _tmp = _utf8(xhtml_escape(_tmp))
    156          _append(_tmp)
    157          _append('</a></li>\n')
    158      _append('\n')
    159      if current+3 < total:
    160          _append(' <li>...</li>')
    161      _append('\n')
    162      if current < total:
    163          _append(' <li><a href="')
    164          _tmp = url %(current+1)
    165          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    166          else: _tmp = _utf8(str(_tmp))
    167          _tmp = _utf8(xhtml_escape(_tmp))
    168          _append(_tmp)
    169          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    170      _append('\n</ul>\n</div>\n</div>\n</div>')
    171      _append('\n</div>\n</div>\n</div>\n<div class="col-md-6 comment-box hidden">\n')
    172      _append('<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba</h3>\n<button type="button" class="comment-close close" data-dismiss="alert" aria-hidden="true" title="\xe5\x85\xb3\xe9\x97\xad">\xc3\x97</button>\n</div>\n<form role="form" method="post" action="/comment/comment/add" class="comment-form">\n<div class="box-body">\n<input type="hidden" name="q" value="csrf_123ABCDF"/>\n<input type="hidden" name="category" value="')
    173      _tmp = category
    174      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    175      else: _tmp = _utf8(str(_tmp))
    176      _tmp = _utf8(xhtml_escape(_tmp))
    177      _append(_tmp)
    178      _append('"/>\n<input type="hidden" name="_id" value="')
    179      _tmp = ans.get('_id', 0)
    180      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    181      else: _tmp = _utf8(str(_tmp))
    182      _tmp = _utf8(xhtml_escape(_tmp))
    183      _append(_tmp)
    184      _append('"/>\n<input type="hidden" name="title" value="')
    185      _tmp = ans.get('title', '')
    186      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    187      else: _tmp = _utf8(str(_tmp))
    188      _tmp = _utf8(xhtml_escape(_tmp))
    189      _append(_tmp)
    190      _append('"/>\n<div class="form-group">\n<label for="name">\xe6\x98\xb5\xe7\xa7\xb0</label>\n<input name="name" type="text" class="form-control" id="name" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe6\x98\xb5\xe7\xa7\xb0">\n</div>\n<div class="form-group">\n<label for="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</label>\n<input name="email" type="email" class="form-control" id="email" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="contain">\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9</label>\n<textarea name="contain" type="text" class="form-control" id="contain" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9"></textarea>\n</div>\n')
    191      if ans.get('len',-1) == -1:
    192          _append('\n<div class="form-group">\n<label for="captcha">\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81</label>\n<input name="captcha" type="text" class="form-control" id="captcha" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81">\n<img src="#" title="\xe7\x82\xb9\xe5\x87\xbb\xe5\x88\xb7\xe6\x96\xb0\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81" class="captcha-image"/>\n</div>\n')
    193      _append('\n</div>\n<div class="box-footer">\n<button type="submit" class="btn btn-primary comment-add">\xe6\x8f\x90\xe4\xba\xa4\xe8\xaf\x84\xe8\xae\xba</button>\n</div>\n</form>\n</div>')
    194      _append('\n</div>\n</div>\n')
    195      _append('\n</section>\n</div>\n')
    196      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    197      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    198      _append('\n<script>\n$(function () {\n$(".inormal").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 1;\najax_status(ids, status);\n});\n$(".iremove").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".ihidden").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 3;\najax_status(ids, status);\n});\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n});\nreturn false;\n}\n/*\n$(".iadd").click(function(){\n$(".comment-box").removeClass("hidden");\n})\n*/\n$(".nickname").click(function(){\nvar id = $(this).data("_id");\nvar title = $(this).data("title");\n//console.log(id);\n$(".comment-box").removeClass("hidden");\nvar _this = $(".comment-form", ".comment-box");\n$(_this).find("input[name=\'_id\']").val(id);\n$(_this).find("input[name=\'title\']").val(title);\n$(_this).find("input[name=\'name\']").val("jwfy");\n$(_this).find("input[name=\'email\']").val("jwfy0902@foxmail.com");\n});\n$(".comment-close").click(function(){\n$(".comment-box").addClass("hidden");\n})\n});\n</script>\n')
    199      _append('\n</body>\n</html>\n')
    200      return _utf8('').join(_buffer)
[E 150423 14:25:27 dm.py:start:61] Uncaught exception GET /movie/movie/re_list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/re_list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate, sdch', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041982a735d10150ff78b9e6147b617e3ea; jwfy_dm_website_session=e0ac85d060fa9a8e46d15b58a73ce2a7', 'Cache-Control': 'max-age=0', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template removie.html>", line 173, in _execute
    NameError: global name 'category' is not defined
[E 150423 14:25:27 dm.py:start:61] 500 GET /movie/movie/re_list (127.0.0.1) 20.22ms
[E 150423 14:25:28 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:25:28 dm.py:start:61] removie.html code:
      1  def _execute():
      2      _buffer = []
      3      _append = _buffer.append
      4      _append('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>')
      5      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
      6      _append('-DM\xe5\x90\x8e\xe5\x8f\xb0</title>\n<meta content=\'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\' name=\'viewport\'>\n<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/theme.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/_all-skins.min.css" rel="stylesheet" type="text/css" />\n<link href="/static/css/flat/blue.css" rel="stylesheet" type="text/css"/>\n<link href="/static/css/base.css" rel="stylesheet" type="text/css"/>\n')
      7      _append('\n</head>\n<body class="skin-blue fixed">\n<div class="wrapper">\n<!-- \xe5\xa4\xb4\xe9\x83\xa8\xef\xbc\x8c\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f -->\n')
      8      _append('<header class="main-header">\n<a href="javascript:;" class="logo"><b>DM</b>\xe5\x90\x8e\xe5\x8f\xb0</a>\n<!-- Header Navbar: style can be found in header.less -->\n<nav class="navbar navbar-static-top" role="navigation">\n<!-- Sidebar toggle button-->\n<a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">\n<span class="sr-only">\xe5\xaf\xbc\xe8\x88\xaa\xe6\xa0\x8f\xe5\x88\x87\xe6\x8d\xa2</span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n<span class="icon-bar"></span>\n</a>\n<ul class="nav navbar-nav navbar-right">\n<li class="dropdown">\n<a href="#" class="dropdown-toggle" data-toggle="dropdown">\xe8\xb4\xa6\xe6\x88\xb7 <span class="caret"></span></a>\n<ul class="dropdown-menu" role="menu">\n<li><a href="javascript:;">\xe4\xb8\xaa\xe4\xba\xba\xe4\xbf\xa1\xe6\x81\xaf</a></li>\n<li class="divider"></li>\n<li><a href="javascript:;">\xe9\x80\x80\xe5\x87\xba</a></li>\n</ul>\n</li>\n</ul>\n<form class="navbar-form navbar-right" role="search">\n<div class="form-group">\n<input type="text" class="form-control" id="navbar-search-input" placeholder="\xe6\x90\x9c\xe7\xb4\xa2">\n</div>\n</form>\n</nav>\n</header>')
      9      _append('\n<!-- \xe5\xb7\xa6\xe4\xbe\xa7\xef\xbc\x8c\xe8\x8f\x9c\xe5\x8d\x95\xe6\xa0\x8f -->\n')
     10      _append('<aside class="main-sidebar">\n<section class="sidebar">\n<ul class="sidebar-menu">\n<li class="header">\xe5\xaf\xbc\xe8\x88\xaa</li>\n<li class="')
     11      _append('">\n<a href="javascript:;">\n<i class="fa fa-dashboard"></i> <span>\xe4\xb8\xbb\xe9\xa1\xb5</span>\n</a>\n</li>\n<li class="treeview ')
     12      _append('">\n<a href="javascript:;">\n<i class="fa fa-file-movie-o "></i> <span>\xe7\x94\xb5\xe5\xbd\xb1</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     13      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li class="')
     14      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe6\x8e\xa8\xe8\x8d\x90</a></li>\n<li class="')
     15      _append('"><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1\xe5\xaf\xbc\xe5\x85\xa5</a></li>\n</ul>\n</li>\n<li class="treeview ')
     16      _append('active')
     17      _append('">\n<a href="javascript:;">\n<i class="fa fa-comment-o "></i> <span>\xe8\xaf\x84\xe8\xae\xba</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li class="')
     18      _append('active')
     19      _append('"><a href="/comment/comment/list?category=movie"><i class="fa fa-circle-o"></i>\xe7\x94\xb5\xe5\xbd\xb1</a></li>\n<li class="')
     20      _append('"><a href="/comment/comment/list?category=blog"><i class="fa fa-circle-o"></i>\xe5\x8d\x9a\xe5\xae\xa2</a></li>\n</ul>\n</li>\n<li class="treeview">\n<a href="#">\n<i class="fa fa-send-o"></i><span>\xe9\x82\xae\xe4\xbb\xb6</span>\n<i class="fa fa-angle-left pull-right"></i>\n</a>\n<ul class="treeview-menu">\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8</a></li>\n<li><a href="javascript:;"><i class="fa fa-circle-o"></i>\xe9\x82\xae\xe4\xbb\xb6\xe5\x8f\x91\xe9\x80\x81</a></li>\n</ul>\n</li>\n</ul>\n</section>\n</aside>')
     21      _append('\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9\xe6\xa1\x86 -->\n<div class="content-wrapper">\n<!-- \xe5\x86\x85\xe5\xae\xb9\xe5\xa4\xb4\xe9\x83\xa8 -->\n<section class="content-header">\n')
     22      _append('\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5')
     23      _append('\n</section>\n<!-- \xe4\xb8\xbb\xe8\xa6\x81\xe5\x86\x85\xe5\xae\xb9 -->\n<section class="content">\n')
     24      _append('\n')
     25      ans = pyobject.get('result')
     26      _append('\n')
     27      query = ans.get('query')
     28      _append('\n')
     29      r_status = ans.get('r_status', 0)
     30      _append('\n')
     31      contain = ans.get('contain', '')
     32      _append('\n<div class="row">\n<div class="col-md-12">\n<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe7\x94\xb5\xe5\xbd\xb1\xe9\xa6\x96\xe9\xa1\xb5\xe6\x8e\xa8\xe8\x8d\x90')
     33      if contain:
     34          _append('-\xe6\x90\x9c\xe7\xb4\xa2-')
     35          _tmp = contain
     36          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     37          else: _tmp = _utf8(str(_tmp))
     38          _tmp = _utf8(xhtml_escape(_tmp))
     39          _append(_tmp)
     40      _append('</h3>\n</div>\n<div class="box-body">\n<div class="row" style="margin-bottom: 10px">\n<div class="col-xs-6">\n<button class="btn btn-default btn-sm checkbox-toggle" title="\xe5\x85\xa8\xe9\x80\x89/\xe5\x85\xa8\xe4\xb8\x8d\xe9\x80\x89"><i class="fa fa-square-o"></i></button>\n<div class="btn-group">\n<button class="btn btn-default btn-sm ihidden" title="\xe9\x9a\x90\xe8\x97\x8f"><i class="fa fa-ban"></i></button>\n<button class="btn btn-default btn-sm iremove" title="\xe5\x88\xa0\xe9\x99\xa4"><i class="fa fa-remove"></i></button>\n<button class="btn btn-default btn-sm inormal" title="\xe6\xad\xa3\xe5\xb8\xb8"><i class="fa fa-bars"></i></button>\n<!--\n<button class="btn btn-default btn-sm iadd" title="\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba"><i class="fa fa-plus"></i></button>\n-->\n</div>\n</div>\n<form class="col-xs-3" style="float: right" role="search" method="post" action="/comment/comment/list">\n<div class="has-feedback">\n<input type="hidden" name="status" value="')
     41      _tmp = r_status
     42      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     43      else: _tmp = _utf8(str(_tmp))
     44      _tmp = _utf8(xhtml_escape(_tmp))
     45      _append(_tmp)
     46      _append('"/>\n<input type="text" class="form-control input-sm" name="contain" placeholder="\xe6\x9f\xa5\xe6\x89\xbe\xe8\xaf\x84\xe8\xae\xba"/>\n<span class="fa fa-search form-control-feedback"></span>\n</div>\n</form>\n</div>\n<table class="table table-hover comment-table">\n<thead>\n')
     47      _append('<tr>\n<th></th>\n<th class="image">\xe5\x9b\xbe\xe7\x89\x87</th>\n<th class="title">\xe6\xa0\x87\xe9\xa2\x98</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe5\x88\x9b\xe5\xbb\xba\xe6\x97\xb6\xe9\x97\xb4</th>\n<th class="update_time">\xe6\x9b\xb4\xe6\x96\xb0\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>\n')
     48      _append('\n</thead>\n<tbody>\n')
     49      if type(query) == list:
     50          _append('\n')
     51          for q in query:
     52              _append('\n')
     53              _append('<tr>\n<td><input type="checkbox" data-id="')
     54              _tmp = q.get('id',0)
     55              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     56              else: _tmp = _utf8(str(_tmp))
     57              _tmp = _utf8(xhtml_escape(_tmp))
     58              _append(_tmp)
     59              _append('"></td>\n<td class="title">')
     60              _tmp = q.get('title', '')
     61              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     62              else: _tmp = _utf8(str(_tmp))
     63              _tmp = _utf8(xhtml_escape(_tmp))
     64              _append(_tmp)
     65              _append('</td>\n<td class="status">\n')
     66              status = int(q.get('status', 0))
     67              _append('\n')
     68              if status == 1:
     69                  _append('\n<span class="label label-success">\xe4\xb8\x8a\xe7\xba\xbf</span>\n')
     70              elif status == 2:
     71                  _append('\n<span class="label label-danger">\xe4\xb8\x8b\xe7\xba\xbf</span>\n')
     72              _append('\n</td>\n<td class="time">')
     73              _tmp = q.get('time', '')
     74              if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     75              else: _tmp = _utf8(str(_tmp))
     76              _tmp = _utf8(xhtml_escape(_tmp))
     77              _append(_tmp)
     78              _append('</td>\n<td class="update_time"></td>\n</tr>\n<tr>\n<th></th>\n<th class="image">\xe5\x9b\xbe\xe7\x89\x87</th>\n<th class="title">\xe6\xa0\x87\xe9\xa2\x98</th>\n<th class="status">\xe7\x8a\xb6\xe6\x80\x81</th>\n<th class="time">\xe5\x88\x9b\xe5\xbb\xba\xe6\x97\xb6\xe9\x97\xb4</th>\n<th class="update_time">\xe6\x9b\xb4\xe6\x96\xb0\xe6\x97\xb6\xe9\x97\xb4</th>\n</tr>')
     79              _append('\n')
     80          _append('\n')
     81      _append('\n</tbody>\n</table>\n')
     82      url = '/comment/comment/list?&status=%s' %(r_status)
     83      _append('\n')
     84      if contain:
     85          _append('\n')
     86          url = url + '&contain=%s' %(contain)
     87          _append('\n')
     88      _append('\n')
     89      url = url + "&page_num=%s"
     90      _append('\n')
     91      _append('<div class="row">\n<div class="col-xs-6">\n<div class="self-paginfo">\n\xe5\x85\xb1')
     92      _tmp = ans.get('total_num', 0)
     93      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
     94      else: _tmp = _utf8(str(_tmp))
     95      _tmp = _utf8(xhtml_escape(_tmp))
     96      _append(_tmp)
     97      _append('\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\n</div>\n</div>\n')
     98      current = ans.get('page_num', 1)
     99      _append('\n')
    100      total = ans.get('page_total', 1)
    101      _append('\n<div class="col-xs-6">\n<div class="self-pagination">\n<ul class="pagination">\n')
    102      if current != 1:
    103          _append('<li><a href="')
    104          _tmp = url %(current-1)
    105          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    106          else: _tmp = _utf8(str(_tmp))
    107          _tmp = _utf8(xhtml_escape(_tmp))
    108          _append(_tmp)
    109          _append('">\xe4\xb8\x8a\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    110      _append('\n')
    111      if current-3 > 1:
    112          _append('<li><a href="')
    113          _tmp = url %(1)
    114          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    115          else: _tmp = _utf8(str(_tmp))
    116          _tmp = _utf8(xhtml_escape(_tmp))
    117          _append(_tmp)
    118          _append('">1</a></li>')
    119      _append('\n')
    120      if current-3 > 2:
    121          _append('<li><...</li>')
    122      _append('\n')
    123      for i in [i for i in range(current-3,current) if i > 0]:
    124          _append('\n<li><a href="')
    125          _tmp = url %(i)
    126          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    127          else: _tmp = _utf8(str(_tmp))
    128          _tmp = _utf8(xhtml_escape(_tmp))
    129          _append(_tmp)
    130          _append('">')
    131          _tmp = i
    132          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    133          else: _tmp = _utf8(str(_tmp))
    134          _tmp = _utf8(xhtml_escape(_tmp))
    135          _append(_tmp)
    136          _append('</a></li>\n')
    137      _append('\n<li class="active"><a href="javascript:;">')
    138      _tmp = current
    139      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    140      else: _tmp = _utf8(str(_tmp))
    141      _tmp = _utf8(xhtml_escape(_tmp))
    142      _append(_tmp)
    143      _append('</a></li>\n')
    144      for i in [i for i in range(current+1,current+4) if i <= total ]:
    145          _append('\n<li><a href="')
    146          _tmp = url %(i)
    147          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    148          else: _tmp = _utf8(str(_tmp))
    149          _tmp = _utf8(xhtml_escape(_tmp))
    150          _append(_tmp)
    151          _append('">')
    152          _tmp = i
    153          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    154          else: _tmp = _utf8(str(_tmp))
    155          _tmp = _utf8(xhtml_escape(_tmp))
    156          _append(_tmp)
    157          _append('</a></li>\n')
    158      _append('\n')
    159      if current+3 < total:
    160          _append(' <li>...</li>')
    161      _append('\n')
    162      if current < total:
    163          _append(' <li><a href="')
    164          _tmp = url %(current+1)
    165          if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    166          else: _tmp = _utf8(str(_tmp))
    167          _tmp = _utf8(xhtml_escape(_tmp))
    168          _append(_tmp)
    169          _append('">\xe4\xb8\x8b\xe4\xb8\x80\xe9\xa1\xb5</a></li>')
    170      _append('\n</ul>\n</div>\n</div>\n</div>')
    171      _append('\n</div>\n</div>\n</div>\n<div class="col-md-6 comment-box hidden">\n')
    172      _append('<div class="box box-primary">\n<div class="box-header">\n<h3 class="box-title">\xe6\xb7\xbb\xe5\x8a\xa0\xe8\xaf\x84\xe8\xae\xba</h3>\n<button type="button" class="comment-close close" data-dismiss="alert" aria-hidden="true" title="\xe5\x85\xb3\xe9\x97\xad">\xc3\x97</button>\n</div>\n<form role="form" method="post" action="/comment/comment/add" class="comment-form">\n<div class="box-body">\n<input type="hidden" name="q" value="csrf_123ABCDF"/>\n<input type="hidden" name="category" value="')
    173      _tmp = category
    174      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    175      else: _tmp = _utf8(str(_tmp))
    176      _tmp = _utf8(xhtml_escape(_tmp))
    177      _append(_tmp)
    178      _append('"/>\n<input type="hidden" name="_id" value="')
    179      _tmp = ans.get('_id', 0)
    180      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    181      else: _tmp = _utf8(str(_tmp))
    182      _tmp = _utf8(xhtml_escape(_tmp))
    183      _append(_tmp)
    184      _append('"/>\n<input type="hidden" name="title" value="')
    185      _tmp = ans.get('title', '')
    186      if isinstance(_tmp, _string_types): _tmp = _utf8(_tmp)
    187      else: _tmp = _utf8(str(_tmp))
    188      _tmp = _utf8(xhtml_escape(_tmp))
    189      _append(_tmp)
    190      _append('"/>\n<div class="form-group">\n<label for="name">\xe6\x98\xb5\xe7\xa7\xb0</label>\n<input name="name" type="text" class="form-control" id="name" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe6\x98\xb5\xe7\xa7\xb0">\n</div>\n<div class="form-group">\n<label for="email">\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80</label>\n<input name="email" type="email" class="form-control" id="email" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\x82\xae\xe7\xae\xb1\xe5\x9c\xb0\xe5\x9d\x80">\n</div>\n<div class="form-group">\n<label for="contain">\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9</label>\n<textarea name="contain" type="text" class="form-control" id="contain" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe8\xaf\x84\xe8\xae\xba\xe5\x86\x85\xe5\xae\xb9"></textarea>\n</div>\n')
    191      if ans.get('len',-1) == -1:
    192          _append('\n<div class="form-group">\n<label for="captcha">\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81</label>\n<input name="captcha" type="text" class="form-control" id="captcha" placeholder="\xe8\xbe\x93\xe5\x85\xa5\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81">\n<img src="#" title="\xe7\x82\xb9\xe5\x87\xbb\xe5\x88\xb7\xe6\x96\xb0\xe9\xaa\x8c\xe8\xaf\x81\xe7\xa0\x81" class="captcha-image"/>\n</div>\n')
    193      _append('\n</div>\n<div class="box-footer">\n<button type="submit" class="btn btn-primary comment-add">\xe6\x8f\x90\xe4\xba\xa4\xe8\xaf\x84\xe8\xae\xba</button>\n</div>\n</form>\n</div>')
    194      _append('\n</div>\n</div>\n')
    195      _append('\n</section>\n</div>\n')
    196      _append('<footer class="main-footer">\n<div class="pull-right hidden-xs">\n<b>\xe5\xa3\xb0\xe6\x98\x8e</b> \xe6\x9c\xac\xe7\xab\x99\xe7\x82\xb9\xe9\x81\xb5\xe5\xbe\xaa<a hre="http://zh.wikipedia.org/zh-cn/MIT%E8%A8%B1%E5%8F%AF%E8%AD%89"><strong>MIT license.</strong></a>\n</div>\n<strong>Copyright \xc2\xa9 2015 <a href="javascript:;">DM Admin</a>.</strong> All rights reserved.\n</footer>')
    197      _append('\n</div>\n<script type="text/javascript" src="/static/js/jquery-1.9.1.js"></script>\n<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>\n<script type="text/javascript" src="/static/js/jquery.slimscroll.min.js"></script>\n<script type="text/javascript" src="/static/js/icheck.min.js"></script>\n<script type="text/javascript" src="/static/js/app.min.js"></script>\n<script type="text/javascript" src="/static/js/base.js"></script>\n<!--\n<script type="text/javascript" src="/static/js/demo.js"></script>\n-->\n')
    198      _append('\n<script>\n$(function () {\n$(".inormal").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 1;\najax_status(ids, status);\n});\n$(".iremove").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 2;\najax_status(ids, status);\n});\n$(".ihidden").click(function(){\nvar ids = icheck_function($(".comment-table"));\nvar status = 3;\najax_status(ids, status);\n});\nfunction ajax_status(ids, status){\n$.ajax({\nurl:"/comment/comment/update_status",\ndata:{"ids":JSON.stringify(ids), "status":status},\ndataType: "json" ,\nsuccess: function(data){\nconsole.log(data);\nif(data["status"] == "success"){\nwindow.location.href="/comment/comment/list";\n}\nelse\nalert(data["query"]);\n},\nerror:function(data, status, e){\nalert(e);\n}\n});\nreturn false;\n}\n/*\n$(".iadd").click(function(){\n$(".comment-box").removeClass("hidden");\n})\n*/\n$(".nickname").click(function(){\nvar id = $(this).data("_id");\nvar title = $(this).data("title");\n//console.log(id);\n$(".comment-box").removeClass("hidden");\nvar _this = $(".comment-form", ".comment-box");\n$(_this).find("input[name=\'_id\']").val(id);\n$(_this).find("input[name=\'title\']").val(title);\n$(_this).find("input[name=\'name\']").val("jwfy");\n$(_this).find("input[name=\'email\']").val("jwfy0902@foxmail.com");\n});\n$(".comment-close").click(function(){\n$(".comment-box").addClass("hidden");\n})\n});\n</script>\n')
    199      _append('\n</body>\n</html>\n')
    200      return _utf8('').join(_buffer)
[E 150423 14:25:28 dm.py:start:61] Uncaught exception GET /movie/movie/re_list (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/re_list', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate, sdch', 'Host': '127.0.0.1:8910', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Cookie': 'sessionid=000041982a735d10150ff78b9e6147b617e3ea; jwfy_dm_website_session=e0ac85d060fa9a8e46d15b58a73ce2a7', 'Cache-Control': 'max-age=0', 'Ra-Ver': '2.9.0', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 47, in request_process
        self._process_handler_result()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 487, in _process_handler_result
        self._process_handler_result_debug()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 477, in _process_handler_result_debug
        self.processer_obj._real_html_render()
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 178, in _real_html_render
        session = self.session)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 447, in render
        html = self.render_string(template_name, **kwargs)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 558, in render_string
        return t.generate(**args)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/template.py", line 236, in generate
        return execute()
      File "<template removie.html>", line 173, in _execute
    NameError: global name 'category' is not defined
[E 150423 14:25:28 dm.py:start:61] 500 GET /movie/movie/re_list (127.0.0.1) 25.83ms
[E 150423 14:26:41 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:27:09 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:27:32 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:33:33 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:33:35 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:34:29 movie.py:re_list:91] global name 'recomment_ctrl' is not defined
[E 150423 14:35:14 movie.py:re_list:91] global name 'comment_t' is not defined
[E 150423 14:37:32 movie.py:re_list:93] global name 'comment_t' is not defined
[E 150423 14:38:02 movie.py:re_list:93] 'SpuTableScheme' object has no attribute 'category'
[E 150423 14:38:43 movie.py:re_list:93] global name 'contain' is not defined
[E 150423 14:39:38 movie.py:re_list:93] local variable 'cond' referenced before assignment
[E 150423 14:44:09 comment_ctrl.py:update_status:37] Error Info And Frames: [ErrorSql]Sql: (select * from comment where comment.id in ()) Exception: ((1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1"))
    	SpuLogging.py:432:error_dump_frame
    	SpuDB.py:296:print_error_sql
    	SpuDB.py:304:query
    	SpuDBObject.py:168:db_query
    	SpuDBObject.py:2161:_find
    	SpuDBObject.py:2194:find
    	comment_ctrl.py:37:update_status
    	comment.py:123:update_status
    	base.py:58:f
    	SpuUOM.py:187:caller
    	SpuRequest.py:261:process_debug
    	SpuRequest.py:544:get
    	SpuRequest.py:44:request_process
    	web.py:954:_execute
    	web.py:1328:__call__
    	httpserver.py:248:_on_headers
    	iostream.py:301:wrapper
    	ioloop.py:396:_run_callback
    	ioloop.py:253:start
    	dm.py:61:start
    	dm.py:83:main
    	dm.py:89:<module>
    
[E 150423 14:44:09 comment.py:update_status:130] (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1")
[E 150423 14:44:09 dm.py:start:61] Uncaught exception GET /comment/comment/update_status?ids=%5B%5D&status=3 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/comment/comment/update_status?ids=%5B%5D&status=3', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate, sdch', 'X-Requested-With': 'XMLHttpRequest', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/movie/movie/re_list', 'Ra-Ver': '2.9.0', 'Cookie': 'sessionid=000041982a735d10150ff78b9e6147b617e3ea; jwfy_dm_website_session=e0ac85d060fa9a8e46d15b58a73ce2a7', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/base.py", line 58, in f
        return func(self, *args, **kwargs)
      File "api/comment.py", line 132, in update_status
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: ProgrammingError(1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1") is not JSON serializable
[E 150423 14:44:09 dm.py:start:61] 500 GET /comment/comment/update_status?ids=%5B%5D&status=3 (127.0.0.1) 31.43ms
[E 150423 14:58:48 movie.py:re_update_status:49] global name 'comment_t' is not defined
[E 150423 14:58:48 dm.py:start:61] Uncaught exception GET /movie/movie/re_update_status?ids=%5B3%2C2%2C1%5D&status=2 (127.0.0.1)
    HTTPRequest(protocol='http', host='127.0.0.1:8910', method='GET', uri='/movie/movie/re_update_status?ids=%5B3%2C2%2C1%5D&status=2', version='HTTP/1.1', remote_ip='127.0.0.1', body='', headers={'Accept-Language': 'zh-CN,zh;q=0.8', 'Accept-Encoding': 'gzip, deflate, sdch', 'X-Requested-With': 'XMLHttpRequest', 'Host': '127.0.0.1:8910', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36', 'Connection': 'keep-alive', 'Referer': 'http://127.0.0.1:8910/movie/movie/re_list', 'Ra-Ver': '2.9.0', 'Cookie': 'sessionid=000041982a735d10150ff78b9e6147b617e3ea; jwfy_dm_website_session=e0ac85d060fa9a8e46d15b58a73ce2a7', 'Ra-Sid': 'B781A14D-20150114-072113-476d3a-b673b7'})
    Traceback (most recent call last):
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 954, in _execute
        getattr(self, self.request.method.lower())(*args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 44, in request_process
        r = func(self, *args, **kwargs)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 544, in get
        r = self.process_debug('Get', urlarg)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 261, in process_debug
        return self.processer(**argdict)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuUOM.py", line 187, in caller
        r = method(_clsobj, **kwargs)
      File "api/movie.py", line 51, in re_update_status
        return self._write(ans)
      File "build/bdist.linux-x86_64/egg/sputnik/SpuRequest.py", line 140, in _write
        self.tornado.write(r)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/web.py", line 440, in write
        chunk = escape.json_encode(chunk)
      File "/home/jwfy/.virtualenvs/yinyu/local/lib/python2.7/site-packages/tornado-2.1.1-py2.7.egg/tornado/escape.py", line 84, in json_encode
        return _json_encode(recursive_unicode(value)).replace("</", "<\\/")
      File "/usr/lib/python2.7/json/__init__.py", line 243, in dumps
        return _default_encoder.encode(obj)
      File "/usr/lib/python2.7/json/encoder.py", line 207, in encode
        chunks = self.iterencode(o, _one_shot=True)
      File "/usr/lib/python2.7/json/encoder.py", line 270, in iterencode
        return _iterencode(o, 0)
      File "/usr/lib/python2.7/json/encoder.py", line 184, in default
        raise TypeError(repr(o) + " is not JSON serializable")
    TypeError: NameError("global name 'comment_t' is not defined",) is not JSON serializable
[E 150423 14:58:48 dm.py:start:61] 500 GET /movie/movie/re_update_status?ids=%5B3%2C2%2C1%5D&status=2 (127.0.0.1) 64618.77ms
[E 150423 18:32:05 image_load.py:captcha:111] cannot open resource
